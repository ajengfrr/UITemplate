@using System.Globalization;
@model PreProc.Models.PreProcGeneralInfo2

<head>
    <script src="~/lib/jquery/dist/jquery.min.js"></script>
<style>
    .nav-pills .nav-link.active, .nav-pills .show > .nav-link {
        background: #dc3545;
        border-bottom-color: #dc3545;
        border-bottom-style: solid;
        border-bottom-width: 8px;
    }

    .nav-pills .nav-link {
        background: black;
        color: white;
    }

    .table thead th {
        text-align: center;
        top: 0;
        position: sticky;
        background: darkgreen;
        color: white;
    }
    .checkbox{
        font-size:large;
    }
    .readonly-select {
        pointer-events: none;
        background-color: #e9ecef;
        cursor: not-allowed;
    }
    .modalBackdrop {
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        background-color: rgba(0,0,0,0.2);
    }
</style>
</head>

@{
    ViewData["Title"] = "Edit Item";
    // Layout = "~/Views/Shared/_Layout.cshtml";
}

@{
    string date = DateTime.Now.ToString("dd-MMM-yy");
    string todayyy = DateTime.Now.ToString("yyyy-MM-dd");
    var cultureInfo = new CultureInfo("en-US"); // Change to your desired culture

    string FileNameRFP = null;
    string FileNameBOQ = null;
    string FileNameQuot = null;
    string FileNamePropo = null;
    string FileNameGP = null;
    string FileNameOthers = null;
    string FileNameSPK = null;
    string FileNameNego = null;

    if (ViewBag.attachRFP.Count > 0)
    {
        FileNameRFP = ViewBag.attachRFP[0].FileName;

    }
    if (ViewBag.attachBOQ.Count > 0)
    {
        FileNameBOQ = ViewBag.attachBOQ[0].FileName;

    }
    if (ViewBag.attachQuot.Count > 0)
    {
        FileNameQuot = ViewBag.attachQuot[0].FileName;

    }
    if (ViewBag.attachPropo.Count > 0)
    {
        FileNamePropo = ViewBag.attachPropo[0].FileName;

    }
    if (ViewBag.attachGP.Count > 0)
    {
        FileNameGP = ViewBag.attachGP[0].FileName;

    }
    if (ViewBag.attachOthers.Count > 0)
    {
        FileNameOthers = ViewBag.attachOthers[0].FileName;

    }
     if (ViewBag.attachSPK.Count > 0)
    {
        FileNameSPK = ViewBag.attachSPK[0].FileName;

    }
     if (ViewBag.attachNego.Count > 0)
    {
        FileNameNego = ViewBag.attachNego[0].FileName;

    }
}
<input type="hidden" value="@ViewBag.useraccessam" id="currentEmailAM"/>
<input type="hidden" value="@ViewBag.userammanager" id="currentEmailAMManager"/>
<input type="hidden" value="@ViewBag.useraccessta" id="currentEmailTA"/>
<input type="hidden" value="@ViewBag.useraccessSuperAdmin" id="currentEmailSuperAdmin"/>
<input type="hidden" value="@ViewBag.useraccesspresales" id="currentEmailPresales"/>
<input type="hidden" value="@ViewBag.useraccessprodmgr" id="currentEmailProdMgr"/>
<input type="hidden" value="@ViewBag.useraccesspm" id="currentEmailPM"/>
<input type="hidden" value="@ViewBag.useraccesspc" id="currentEmailPC"/>
<input type="hidden" value="@ViewBag.useraccessps" id="currentEmailPS"/>
<input type="hidden" value="@ViewBag.useraccesspmmgr" id="currentEmailPMMgr"/>
<input type="hidden" value="@ViewBag.useraccesspcmgr" id="currentEmailPCMgr"/>
<input type="hidden" value="@ViewBag.useraccesspsmgr" id="currentEmailPSMgr"/>
<input type="hidden" value="@ViewBag.useraccesspmo" id="currentEmailPMO"/>
<input type="hidden" value="@ViewBag.useraccesspmohead" id="currentEmailPMOHead"/>
<input type="hidden" value="@ViewBag.useraccessproc" id="currentEmailProc"/>
<input type="hidden" value="@ViewBag.useraccesswh" id="currentEmailWH"/>
<input type="hidden" value="@ViewBag.useraccessbod" id="currentEmailBOD"/>

<div class="container">

    <div class="card" style="min-width:fit-content">
        <div class="card-body">
            @* <h5 class="card-title">New Item</h5> *@
            <form asp-action="PostEditItem" id="postEditItem" asp-controller="PreProcs" method="post" enctype="multipart/form-data">
                <div class="row mt-lg-5">
                    <div class="col-8">
                        <input type="submit" value="Save" class="btn btn-outline-success" id="btnSaveHeaderPreProc"/>
                        <a asp-area="" data-toggle="tooltip" asp-controller="PreProcs" asp-action="ViewDetail" asp-route-id="@Model.Id" class="btn btn-outline-secondary">
                            Cancel
                        </a>
                        <a class="btn btn-outline-danger" asp-area="" asp-controller="PreProcs" asp-action="Index">
                            Exit
                        </a>
                        @if ((ViewBag.useraccessta != null || ViewBag.useraccessSuperAdmin != null || ViewBag.useraccesspresales != null) && Model.Stage == "Presales")
                        {
                            <a class="btn btn-outline-secondary" data-bs-toggle="modal" data-bs-target="#uploadExcelItems">
                                Upload
                            </a>
                        }
                        
                    </div>
                    <div class="col-4 text-end">
                        @*  <a class="btn btn-outline-primary" asp-area="" asp-controller="TrTaxes" asp-action="DownloadFile"
                        asp-route-id="@Model.DocumentId">
                        Download File
                        </a> *@
                        @* <a class="btn btn-outline-success" asp-area="" asp-controller="TrTaxes" asp-action="#">
                        Edit
                        </a> *@
                        <p>
                            <b class="text-red">*</b> : Mandatory
                            <br />
                            <b class="text-red">**</b> : Either one is mandatory
                        </p>

                    </div>
                </div>

                <!-- Pills Tabs -->
                <ul class="nav nav-pills mb-3" id="pills-tab" role="tablist">
                    <li class="nav-item" role="presentation">
                        <button class="nav-link active" id="pills-general-tab" data-bs-toggle="pill" data-bs-target="#pills-general" type="button" role="tab" aria-controls="pills-general" aria-selected="false" tabindex="-1">General Info</button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="pills-risk-tab" data-bs-toggle="pill" data-bs-target="#pills-risk" type="button" role="tab" aria-controls="pills-risk" aria-selected="false" tabindex="-1">Risk Factor</button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="pills-details-tab" data-bs-toggle="pill" data-bs-target="#pills-details" type="button" role="tab" aria-controls="pills-details" aria-selected="false" tabindex="-1">Details</button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="pills-attachment-tab" data-bs-toggle="pill" data-bs-target="#pills-attachment" type="button" role="tab" aria-controls="pills-attachment" aria-selected="false" tabindex="-1">Attachments</button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="pills-approval-tab" data-bs-toggle="pill" data-bs-target="#pills-approval" type="button" role="tab" aria-controls="pills-approval" aria-selected="false" tabindex="-1">Approval/Clarification</button>
                    </li>
                    @if (ViewBag.pmocheck == null)
                    {
                        <li class="nav-item" id="pmo-tab" role="presentation" style="display:none">
                            <button class="nav-link" id="pills-pmo-tab" data-bs-toggle="pill" data-bs-target="#pills-pmo" type="button" role="tab" aria-controls="pills-pmo" aria-selected="false" tabindex="-1" >PMO Checklist</button>
                        </li>
                    }
                    else{
                        <li class="nav-item" id="pmo-tab" role="presentation">
                            <button class="nav-link" id="pills-pmo-tab" data-bs-toggle="pill" data-bs-target="#pills-pmo" type="button" role="tab" aria-controls="pills-pmo" aria-selected="false" tabindex="-1" >PMO Checklist</button>
                        </li>
                    }
                    
                    <li class="nav-item" role="presentation">
                        <button class="nav-link " id="pills-report-tab" data-bs-toggle="pill" data-bs-target="#pills-report" type="button" role="tab" aria-controls="pills-report" aria-selected="true">Reports</button>
                    </li>
                </ul>
                <div class="tab-content pt-2" id="myTabContent">
                    <div class="tab-pane fade active show" id="pills-general" role="tabpanel" aria-labelledby="general-tab">
                        <hr />

                        

                        <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                        <input type="hidden" asp-for="Id" value="@Model.Id" />
                        <div class="form-group">
                            <div class="row mt-lg-2">
                                <div class="col-2">
                                    <label class="col-form-label control-label">Stage</label>
                                    <span class="text-danger"></span>
                                </div>
                                <div class="col-3">
                                    <div class="row">
                                        <label class="col-form-label control-label col-1">
                                            :
                                        </label>
                                        <select asp-for="Stage" class="form-select form-control readonly-select" aria-label="Default select example" style="width:250px" id="selectStage" runat="server" name="Stage">
                                            @foreach (var item in @ViewBag.items)
                                            {
                                                @if (@item.Stage == @Model.Stage)
                                                {
                                                    <option selected="@item.Stage">@item.Text</option>
                                                }
                                                else
                                                {
                                                    <option value="@item.Stage">@item.Text</option>
                                                }
                                            }
                                        </select>
                                    </div>

                                    @* <input  class="form-control" style="width:250px" type="text" value="" /> *@
                                </div>
                                <div class="col-2">
                                    <label class="col-form-label control-label">Opp ID/Presales ID <b class="text-red">*</b></label>
                                    <span class="text-danger"></span>
                                </div>
                                <div class="col-3 visiblePID" style="display:none">
                                    <div class="row">
                                        <label class="col-form-label control-label">
                                            : PID
                                        </label>
                                    </div>
                                </div>
                                <div class="col-3 visiblePreID" style="display:block">
                                    <div class="row">
                                        <label class="col-form-label control-label col-1">
                                            :
                                        </label>
                                        <select asp-for="PresalesId" class="form-select form-control" aria-label="Default select example" style="width:250px">
                                            <option selected="">(Please Select)</option>
                                            @foreach (var item in @ViewBag.presales)
                                            {
                                                @if (@item.NewPresalesid == @Model.PresalesId)
                                                {
                                                    <option selected="@item.NewPresalesid">@item.NewPresalesid</option>
                                                }
                                                else
                                                {
                                                    <option value="@item.NewPresalesid">@item.NewPresalesid</option>
                                                }
                                            }
                                        </select>
                                        @* <input class="form-control" style="width:250px" type="text" value="" /> *@
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="row mt-lg-3">
                                <div class="col-2">
                                    <label class="col-form-label control-label">RFP ID	</label>
                                    <span class="text-danger"></span>
                                </div>
                                <div class="col-3">
                                    <div class="row">
                                        <label class="col-form-label control-label col-1">
                                            :
                                        </label>
                                        <input asp-for="RfpId" class="form-control inputAll readonly-select" style="width:250px" type="text" value="@Model.RfpId"  />
                                    </div>
                                </div>
                                <div class="col-2 visiblePID" style="display:none">
                                    <label class="col-form-label control-label">PID <b class="text-red">*</b></label>
                                    <span class="text-danger"></span>
                                </div>
                                <div class="col-3 visiblePID" style="display:none">
                                    <div class="row">
                                        <label class="col-form-label control-label col-1">
                                            :
                                        </label>
                                        <select asp-for="Pid" id="txtPID" class="form-select form-control" aria-label="Default select example" style="width:250px">
                                            <option selected="">(Please Select)</option>
                                            @foreach (var item in @ViewBag.pids)
                                            {
                                                @if (@item.ProjectId == @Model.Pid)
                                                {
                                                    <option selected="@item.ProjectId">@item.ProjectId</option>
                                                }
                                                else
                                                {
                                                    <option value="@item.ProjectId">@item.ProjectId</option>
                                                }
                                            }
                                        </select>
                                        @* <input class="form-control" style=proposal no"width:250px" type="text" value="" /> *@
                                    </div>
                                </div>
                                <div class="col-2 visiblePID" style="display:none">
                                    <a class="btn btn-outline-secondary" href="@ViewBag.urlgenpid.AlphaNumericValue">
                                        Gen PID
                                    </a>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="row mt-lg-2">
                                <div class="col-2" id="divProposalNo">
                                    <label class="col-form-label control-label">Proposal No.	</label>
                                    <span class="text-danger"></span>
                                </div>
                                <div class="col-3">
                                    <div class="row">
                                        <label class="col-form-label control-label col-1">
                                            :
                                        </label>
                                        <input asp-for="ProposalId" class="form-control inputAll readonly-select" style="width:250px" type="text" value="@Model.ProposalId"  />
                                    </div>
                                </div>
                                <div class="col-2">
                                    <label class="col-form-label control-label">Owner Estimate (IDR) <b class="text-red">**</b></label>
                                    <span class="text-danger"></span>
                                </div>
                                <div class="col-3">
                                    <div class="row">
                                        <label class="col-form-label control-label col-1">
                                            :
                                        </label>
                                        @if (Model.ProjectValueIdr.HasValue)
                                        {
                                            <input asp-for="ProjectValueIdr" class="form-control" style="width:250px;text-align:end" type="text" value="@Model.ProjectValueIdr.Value.ToString("N2", cultureInfo)" />
                                        }
                                        else{
                                            <input asp-for="ProjectValueIdr" class="form-control" style="width:250px;text-align:end" type="text" value="" />
                                        }
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="row mt-lg-2">
                                <div class="col-2" id="divQuotationNo">
                                    <label class="col-form-label control-label">Quotation No.</label>
                                    <span class="text-danger"></span>
                                </div>
                                <div class="col-3">
                                    <div class="row">
                                        <label class="col-form-label control-label col-1">
                                            :
                                        </label>
                                        <input asp-for="QuotationId" class="form-control inputAll readonly-select" style="width:250px" type="text" value="@Model.QuotationId" />
                                    </div>
                                </div>
                                <div class="col-2">
                                    <label class="col-form-label control-label">
                                        Owner Estimate (USD)
                                        <b class="text-red">**</b> (Ex: 10000.00)
                                    </label>
                                    <span class="text-danger"></span>
                                </div>
                                <div class="col-3">
                                    <div class="row">
                                        <label class="col-form-label control-label col-1">
                                            :
                                        </label>
                                        @if (Model.ProjectValueUsd.HasValue)
                                        {
                                            <input asp-for="ProjectValueUsd" class="form-control" style="width:250px;text-align:end" type="text" value="@Model.ProjectValueUsd.Value.ToString("N2", cultureInfo)" />
                                        }
                                        else{
                                            <input asp-for="ProjectValueUsd" class="form-control" style="width:250px;text-align:end" type="text" value="" />
                                        }
                                        
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="row mt-lg-2">
                                <div class="col-2">
                                    <label class="col-form-label control-label">Customer <b class="text-red">*</b></label>
                                    <span class="text-danger"></span>
                                </div>
                                <div class="col-3">
                                    <div class="row">
                                        <label class="col-form-label control-label col-1">
                                            :
                                        </label>
                                        <select asp-for="Customer" class="form-select form-control" aria-label="Default select example" style="width:250px">
                                            <option selected="">(Please Select)</option>
                                            @foreach (var item in @ViewBag.customers)
                                            {
                                                @if (@item.InitialCode == @Model.Customer)
                                                {
                                                    <option selected value="@item.InitialCode">@item.AccountName (@item.InitialCode)</option>
                                                }
                                                else
                                                {
                                                    <option value="@item.InitialCode">@item.AccountName (@item.InitialCode)</option>
                                                }
                                               
                                            }
                                        </select>
                                    </div>
                                </div>
                                <div class="col-2" id="divEstGP">
                                    <label class="col-form-label control-label" id="labelEstGP">
                                        Est. % GP <b class="text-red">*</b> (Ex: 8.20)
                                    </label>
                                    <span class="text-danger"></span>
                                </div>
                                <div class="col-3">
                                    <div class="row">
                                        <label class="col-form-label control-label col-1">
                                            :
                                        </label>
                                        @if (Model.EstGpgeneral.HasValue)
                                        {
                                            <input asp-for="EstGpgeneral" class="form-control" style="width:250px;text-align:end" type="text" value="@Model.EstGpgeneral.Value.ToString("N2", cultureInfo)" />
                                        }
                                        else{
                                            <input asp-for="EstGpgeneral" class="form-control" style="width:250px;text-align:end" type="text" value="" />
                                        }
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="row mt-lg-2">
                                <div class="col-2">
                                    <label class="col-form-label control-label">Account Manager <b class="text-red">*</b></label>
                                    <span class="text-danger"></span>
                                </div>
                                <div class="col-3">
                                    <div class="row">
                                        <label class="col-form-label control-label col-1">
                                            :
                                        </label>
                                        <select asp-for="Am" class="form-select form-control" aria-label="Default select example" style="width:250px">
                                            @foreach (var item in @ViewBag.amemployees)
                                            {
                                                @if (@item.DomainName == @Model.Am)
                                                {
                                                    <option selected value="@item.DomainName">@item.EmployeeName</option>
                                                }
                                                else
                                                {
                                                    <option value="@item.DomainName">@item.EmployeeName</option>
                                                }
                                            }
                                        </select>
                                    </div>
                                </div>
                                <div class="col-2">
                                    <label class="col-form-label control-label">
                                        Project Type
                                    </label>
                                    <span class="text-danger"></span>
                                </div>
                                <div class="col-3">
                                    <div class="row">
                                        <label class="col-form-label control-label col-1">
                                            :
                                        </label>
                                        <select asp-for="ProjectType" class="form-select form-control" aria-label="Default select example" style="width:250px">
                                            @foreach (var item in @ViewBag.projecttypes)
                                            {
                                                @if (@item.Type == @Model.ProjectType)
                                                {
                                                    <option selected value="@item.Type">@item.Type</option>
                                                }
                                                else
                                                {
                                                    <option value="@item.Type">@item.Type</option>
                                                }
                                            }
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="row mt-lg-2">
                                <div class="col-2">
                                    <label class="col-form-label control-label">Technical Lead/Presales <b class="text-red">*</b></label>
                                    <span class="text-danger"></span>
                                </div>
                                <div class="col-3">
                                    <div class="row">
                                        <label class="col-form-label control-label col-1">
                                            :
                                        </label>
                                        <select asp-for="PropMgr" class="form-select form-control" aria-label="Default select example" style="width:250px">
                                            <option selected=""></option>
                                            @foreach (var item in @ViewBag.technicalemployees)
                                            {
                                                @if (@item.DomainName == @Model.PropMgr)
                                                {
                                                    <option selected value="@item.DomainName">@item.EmployeeName</option>
                                                }
                                                else
                                                {
                                                    <option value="@item.DomainName">@item.EmployeeName</option>
                                                }
                                            }
                                        </select>
                                    </div>
                                </div>
                                <div class="col-2">
                                    <label class="col-form-label control-label">
                                        Description
                                    </label>
                                    <span class="text-danger"></span>
                                </div>
                                <div class="col-3">
                                    <div class="row">
                                        <label class="col-form-label control-label col-1">
                                            :
                                        </label>
                                        <textarea asp-for="Description" class="form-control" style="width:290px;height:100px">@Model.Description</textarea>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="row mt-lg-2">
                                <div class="col-2">
                                    <label class="col-form-label control-label">Tender Admin</label>
                                    <span class="text-danger"></span>
                                </div>
                                <div class="col-3">
                                    <div class="row">
                                        <label class="col-form-label control-label col-1">
                                            :
                                        </label>
                                        <select asp-for="TenderAdm" class="form-select form-control inputAll readonly-select" aria-label="Default select example" style="width:250px">
                                            <option selected value=""></option>
                                            @foreach (var item in @ViewBag.tenderemployees)
                                            {
                                                @if (@item.DomainName == @Model.TenderAdm)
                                                {
                                                    <option selected value="@item.DomainName">@item.EmployeeName</option>
                                                }
                                                else
                                                {
                                                    <option value="@item.DomainName">@item.EmployeeName</option>
                                                }
                                            }
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="row mt-lg-2">
                                <div class="col-2" id="divProposalDate">
                                    <label class="col-form-label control-label">Proposal Submission Date <b class="text-red">*</b></label>
                                    <span class="text-danger"></span>
                                </div>
                                <div class="col-3">
                                    <div class="row">
                                        <label class="col-form-label control-label col-1">
                                            :
                                        </label>
                                        @if (@Model.ProposalSubmissionDate == null)
                                        {
                                            <input asp-for="ProposalSubmissionDate" class="form-control" style="width:250px" type="date" value="" />
                                        }
                                        else{
                                            <input asp-for="ProposalSubmissionDate" class="form-control" style="width:250px" type="date" value="@Model.ProposalSubmissionDate.Value.ToString("yyyy-MM-dd")" />
                                        }
                                        
                                    </div>
                                </div>
                                <div class="col-2" id="divPICProc">
                                    <label class="col-form-label control-label" id="labelPICProc">
                                        PIC Procurement
                                    </label>
                                    <span class="text-danger"></span>
                                </div>
                                <div class="col-3">
                                    <div class="row">
                                        <label class="col-form-label control-label col-1">
                                            :
                                        </label>
                                        <textarea class="form-control readonly-select" id="resultSelectedPIC" style="width:250px;height:100px">@ViewBag.existpicproc</textarea>
                                    </div>
                                </div>
                                <div class="col-4" hidden id="divresultSelectedPICProcEmail">
                                    <textarea asp-for="PicProc" class="form-control" id="resultSelectedPICProcEmail" >@Model.PicProc
                                    </textarea>
                                </div>
                                <div class="col-2">
                                    <a class="btn btn-outline-secondary modalDelete" data-bs-toggle="modal" data-bs-target="#picProcModal">
                                        Select PIC
                                    </a>
                                    @* <input class="form-control" style="width:250px" type="text" value="" /> *@
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="row mt-lg-2">
                                <div class="col-2">
                                    <label class="col-form-label control-label">Subcon Quotation Deadline	</label>
                                    <span class="text-danger"></span>
                                </div>
                                <div class="col-3">
                                    <div class="row">
                                        <label class="col-form-label control-label col-1">
                                            :
                                        </label>
                                        @if (@Model.QuotationDeadline == null)
                                        {
                                            <input asp-for="QuotationDeadline" class="form-control inputAll readonly-select" style="width:250px" type="date" />
                                        }
                                        else{
                                            <input asp-for="QuotationDeadline" class="form-control inputAll readonly-select" style="width:250px" type="date" value="@Model.QuotationDeadline.Value.ToString("yyyy-MM-dd")" />
                                        }
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="row mt-lg-2">
                                <div class="col-2">
                                    <label class="col-form-label control-label">Hedging</label>
                                    <span class="text-danger"></span>
                                </div>
                                <div class="col-3">
                                    <div class="row">
                                        <label class="col-form-label control-label">
                                            :  
                                            @if (Model.Hedging == true)
                                            {
                                                <input name="Hedging" value="true" type="checkbox" class="form-check-input checkbox inputAll readonly-select"
                                                      style="border: 1px solid;" checked>
                                            }
                                            else{
                                                <input name="Hedging" value="true" type="checkbox" class="form-check-input checkbox inputAll readonly-select"
                                                      style="border: 1px solid;">
                                            }
                                            
                                        </label>
                                    </div>
                                </div>
                                <div class="col-2" id="divBOD">
                                    <label class="col-form-label control-label" id="labelBOD">
                                        BOD
                                    </label>
                                    <span class="text-danger"></span>
                                </div>
                                <div class="col-3">
                                    <div class="row">
                                        <label class="col-form-label control-label col-1">
                                            :
                                        </label>
                                        <textarea class="form-control readonly-select" id="resultSelectedBOD" style="width:250px;height:100px">@ViewBag.bodname</textarea>
                                    </div>
                                </div>
                                <div class="col-4" hidden id="divResultSelectedBODEmail">
                                    <textarea asp-for="EmailCommitteeDefault" class="form-control" id="resultSelectedBODEmail">@Model.EmailCommitteeDefault</textarea>
                                </div>
                                <div class="col-2">
                                    <a class="btn btn-outline-secondary modalDelete" data-bs-toggle="modal" data-bs-target="#bodModal" style="visibility: hidden;" id="btnselectbod">
                                        Select BOD
                                    </a>
                                    @* <input class="form-control" style="width:250px" type="text" value="" /> *@
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="row mt-lg-2">
                                <div class="col-2">
                                    <label class="col-form-label control-label">Status Presales	</label>
                                    <span class="text-danger"></span>
                                </div>
                                <div class="col-3">
                                    <div class="row">
                                        <label class="col-form-label control-label">
                                            : @Model.Type
                                        </label>
                                    </div>
                                </div>
                                <div class="col-2">
                                    <label class="col-form-label control-label">
                                        PM
                                    </label>
                                    <span class="text-danger"></span>
                                </div>
                                <div class="col-3">
                                    <div class="row">
                                        <label class="col-form-label control-label col-1">
                                            :
                                        </label>
                                        <select asp-for="Pm" class="form-select form-control readonly-select" aria-label="Default select example" style="width:250px" id="selectPM">
                                            @foreach (var item in @ViewBag.pm)
                                            {
                                                <option value="@item.EmployeeEmail">@item.EmployeeName</option>
                                            }
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="row mt-lg-2">
                                <div class="col-2">
                                    <label class="col-form-label control-label">Creation Date	</label>
                                </div>
                                <div class="col-3">
                                    <div class="row">
                                        <label class="col-form-label control-label">
                                            : @date
                                        </label>
                                    </div>
                                </div>
                                <div class="col-2">
                                    <label class="col-form-label control-label">
                                        PC
                                    </label>
                                    <span class="text-danger"></span>
                                </div>
                                <div class="col-3">
                                    <div class="row">
                                        <label class="col-form-label control-label col-1">
                                            :
                                        </label>
                                        <select asp-for="Pc" class="form-select form-control readonly-select" aria-label="Default select example" style="width:250px" id="selectPC">
                                            @foreach (var item in @ViewBag.pc)
                                            {
                                                <option value="@item.EmployeeEmail">@item.EmployeeName</option>
                                            }
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="row mt-lg-2">
                                <div class="col-2">
                                    <label class="col-form-label control-label">Warranty Applied</label>
                                    <span class="text-danger"></span>
                                </div>
                                <div class="col-3">
                                    <div class="row">
                                        <label class="col-form-label control-label">
                                            : 
                                            @if (Model.NeedWarranty == true)
                                            {
                                                <input name="NeedWarranty" value="true" type="checkbox" class="form-check-input checkbox inputAll readonly-select"
                                                     style="border: 1px solid;" checked>
                                            }
                                            else{
                                                <input name="NeedWarranty" value="true" type="checkbox" class="form-check-input checkbox inputAll readonly-select"
                                                     style="border: 1px solid;">
                                            }
                                            
                                        </label>
                                    </div>
                                </div>
                                <div class="col-2">
                                    <label class="col-form-label control-label">
                                        Project Support <b class="text-red" id="mandaSelectPS" style="visibility:hidden">*</b>
                                    </label>
                                    <span class="text-danger"></span>
                                </div>
                                <div class="col-3">
                                    <div class="row">
                                        <label class="col-form-label control-label col-1">
                                            :
                                        </label>
                                        <select asp-for="ProjectSupport" class="form-select form-control readonly-select" aria-label="Default select example" style="width:250px" id="selectPS">
                                            <option value="" selected>-pilih-</option>
                                            @foreach (var item in @ViewBag.projectsupp)
                                            {
                                                <option value="@item.EmployeeEmail">@item.EmployeeName</option>
                                            }
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                         
                        <div class="row mt-lg-5">
                            @if (Model.Stage == "Delivery")
                            {
                                <div class="col-8">
                                    @if (ViewBag.useraccesspm != null || ViewBag.useraccesspc != null || ViewBag.useraccesspmohead != null || ViewBag.useraccesspmo != null || ViewBag.useraccessSuperAdmin != null)
                                    {
                                         <a class="btn btn-outline-secondary" id="btn-get-cs" data-bs-toggle="modal" data-bs-target="#modalcsdata">
                                            Get CS Data
                                        </a>
                                    }
                                    @if (ViewBag.pmocheck == null && (ViewBag.useraccessam != null || ViewBag.useraccessSuperAdmin != null))
                                    {
                                        <a class="btn btn-outline-secondary" id="btn-pmo-review" onclick="showPMOChecklist()">
                                            Request PMO
                                        </a>
                                    }
                                     @if (ViewBag.useraccesspm != null || ViewBag.useraccesspc != null || ViewBag.useraccesspmohead != null || ViewBag.useraccesspmo != null || ViewBag.useraccessSuperAdmin != null)
                                    {
                                        <a class="btn btn-outline-secondary" id="btn-remind-procwh" data-bs-toggle="modal" data-bs-target="#modalremindprocwh">
                                            Remind PROC/WH
                                        </a>
                                        <a class="btn btn-outline-secondary" id="btn-purchase-req" data-bs-toggle="modal" data-bs-target="#modalpurchasereq">
                                            Purchase Requisition
                                        </a>
                                    }
                                    @if (ViewBag.useraccesspmmgr != null || ViewBag.useraccesspmohead != null || ViewBag.useraccesspcmgr != null || ViewBag.useraccesspsmgr != null || ViewBag.useraccessSuperAdmin != null)
                                    {
                                        <a class="btn btn-outline-secondary" data-bs-toggle="modal" data-bs-target="#modalassignpmo">
                                            PM/PC Assigned
                                        </a>
                                    }
                                </div>
                            }
                            else if (Model.Stage == "Presales" && (ViewBag.useraccessam != null || ViewBag.useraccessSuperAdmin != null))
                            {
                                
                                <div class="col-8">
                                     <a class="btn btn-outline-secondary" onclick="sendNotifStagePresales('Parameter Email RFQ')" >
                                        RFQ
                                    </a>
                                    @if (ViewBag.pmocheck == null)
                                    {
                                        <a class="btn btn-outline-secondary" id="btn-pmo-review" onclick="showPMOChecklist()">
                                            PMO Review
                                        </a>
                                    }
                                    <a class="btn btn-outline-secondary" id="btn-excpt-finance" data-bs-toggle="modal" data-bs-target="#modalexcpttofinance">
                                        Excpt To Finance
                                    </a>
                                    <a class="btn btn-outline-secondary" onclick="sendNotifStagePresales('Parameter Email Presales Review')">
                                        Presales Review
                                    </a>
                                    <a class="btn btn-outline-secondary" onclick="sendNotifStagePresales('Parameter Email AM Mgr Approval')">
                                        AM Mgr Approval
                                    </a>
                                </div>
                            }
                        </div>
                    </div>
                    @if (Model.Stage == "RiskAssessment" || Model.Stage == "Risk Assessment")
                    {
                        <div class="tab-pane fade" id="pills-risk" role="tabpanel" aria-labelledby="risk-tab">
                            <hr />
                            <b>External Factors</b>
                            <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                            @* <input type="hidden" asp-for="DocumentId" value="@Model.DocumentId" />
                            <input type="hidden" asp-for="Id" value="@Model.Id" /> *@
                            <div class="form-group">
                                <div class="row mt-lg-2">
                                    <div class="col-5">
                                        <div class="custom-control custom-checkbox" id="divCheckNewProduct">
                                            @{var count = 0;}
                                            @foreach (var item in ViewBag.riskdata)
                                            {
                                                @if (item.RiskName == "New Product / 1st Implementation")
                                                {
                                                    <input type="checkbox" class="form-check-input checkbox"
                                                   style="border: 1px solid;" name="checkNewProduct" id="checkNewProduct" checked>
                                                    count++;
                                                }
                                            }
                                            @if (count == 0)
                                            {
                                                <input type="checkbox" class="form-check-input checkbox"
                                                   style="border: 1px solid;" name="checkNewProduct" id="checkNewProduct" >
                                            }
                                            
                                            <label class="custom-control-label" for="customCheck1">New Product / 1st Implementation</label>
                                        </div>
                                    </div>
                                    <div class="col-5">
                                        <div class="custom-control custom-checkbox" id="divCheckTightTimeline">
                                            @{count = 0;}
                                            @foreach (var item in ViewBag.riskdata)
                                            {
                                                @if (item.RiskName == "Tight Timeline")
                                                {
                                                    <input type="checkbox" class="form-check-input checkbox"
                                                   style="border: 1px solid;" name="checkTightTimeline" id="checkTightTimeline" checked>
                                                    count++;
                                                }
                                            }
                                            @if (count == 0)
                                            {
                                                <input type="checkbox" class="form-check-input checkbox"
                                                   style="border: 1px solid;" name="checkTightTimeline" id="checkTightTimeline">
                                            }
                                            
                                            <label class="custom-control-label" for="customCheck1">
                                                Tight Timeline
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="row mt-lg-2">
                                    <div class="col-5">
                                        <div class="custom-control custom-checkbox">
                                            @{count = 0;}
                                            @foreach (var item in ViewBag.riskdata)
                                            {
                                                @if (item.RiskName == "New Customer")
                                                {
                                                    <input type="checkbox" class="form-check-input checkbox"
                                                   style="border: 1px solid;" name="checkNewCustomer" id="checkNewCustomer" checked>
                                                    count++;
                                                }
                                            }
                                            @if (count == 0)
                                            {
                                                <input type="checkbox" class="form-check-input checkbox"
                                                   style="border: 1px solid;" name="checkNewCustomer" id="checkNewCustomer">
                                            }
                                            
                                            <label class="custom-control-label" for="customCheck1">New Customer	</label>
                                        </div>
                                    </div>
                                    <div class="col-5">
                                        <div class="custom-control custom-checkbox">
                                            @{count = 0;}
                                            @foreach (var item in ViewBag.riskdata)
                                            {
                                                @if (item.RiskName == "Harsh Penalty")
                                                {
                                                   <input type="checkbox" class="form-check-input checkbox"
                                                   style="border: 1px solid;" name="checkHarshPenalty" id="checkHarshPenalty" checked>
                                                    count++;
                                                }
                                            }
                                            @if (count == 0)
                                            {
                                                <input type="checkbox" class="form-check-input checkbox"
                                                   style="border: 1px solid;" name="checkHarshPenalty" id="checkHarshPenalty">
                                            }
                                            
                                            <label class="custom-control-label" for="customCheck1">
                                                Harsh Penalty
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="row mt-lg-2">
                                    <div class="col-5">
                                        <div class="custom-control custom-checkbox" id="divCheckNewSubcon">
                                            @{count = 0;}
                                            @foreach (var item in ViewBag.riskdata)
                                            {
                                                @if (item.RiskName == "New Subcon / Vendor")
                                                {
                                                    <input type="checkbox" class="form-check-input checkbox"
                                                   style="border: 1px solid;" name="checkNewSubcon" id="checkNewSubcon" checked>
                                                    count++;
                                                }
                                            }
                                            @if (count == 0)
                                            {
                                                <input type="checkbox" class="form-check-input checkbox"
                                                   style="border: 1px solid;" name="checkNewSubcon" id="checkNewSubcon">
                                            }
                                            
                                            <label class="custom-control-label" for="customCheck1">New Subcon / Vendor	</label>
                                        </div>
                                    </div>
                                    <div class="col-5">
                                        <div class="custom-control custom-checkbox" id="divCheckNonITSOW">
                                            @{count = 0;}
                                            @foreach (var item in ViewBag.riskdata)
                                            {
                                                @if (item.RiskName == "Non IT Scope of Work")
                                                {
                                                    <input type="checkbox" class="form-check-input checkbox"
                                                   style="border: 1px solid;" name="checkNonITSOW" id="checkNonITSOW" checked>
                                                    count++;
                                                }
                                            }
                                            @if (count == 0)
                                            {
                                                <input type="checkbox" class="form-check-input checkbox"
                                                   style="border: 1px solid;" name="checkNonITSOW" id="checkNonITSOW">
                                            }
                                            
                                            <label class="custom-control-label" for="customCheck1">
                                                Non IT Scope of Work
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="row mt-lg-2">
                                    <div class="col-5">
                                        <div class="custom-control custom-checkbox">
                                            @{count = 0;}
                                            @foreach (var item in ViewBag.riskdata)
                                            {
                                                @if (item.RiskName == "Multi Site / Roll Out")
                                                {
                                                    <input type="checkbox" class="form-check-input checkbox"
                                                   style="border: 1px solid;" name="checkMultiSite" id="checkMultiSite" checked>
                                                    count++;
                                                }
                                            }
                                            @if (count == 0)
                                            {
                                                <input type="checkbox" class="form-check-input checkbox"
                                                   style="border: 1px solid;" name="checkMultiSite" id="checkMultiSite">
                                            }
                                            
                                            <label class="custom-control-label" for="customCheck1">Multi Site / Roll Out	</label>
                                        </div>
                                    </div>
                                    <div class="col-5">
                                        <div class="custom-control custom-checkbox">
                                            @{count = 0;}
                                            @foreach (var item in ViewBag.riskdata)
                                            {
                                                @if (item.RiskName == "Customer Behavior (Highly Political/Baby Sitting)")
                                                {
                                                    <input type="checkbox" class="form-check-input checkbox"
                                                   style="border: 1px solid;" name="checkCustomerBehavior" id="checkCustomerBehavior" checked>
                                                    count++;
                                                }
                                            }
                                            @if (count == 0)
                                            {
                                                <input type="checkbox" class="form-check-input checkbox"
                                                   style="border: 1px solid;" name="checkCustomerBehavior" id="checkCustomerBehavior">
                                            }
                                            
                                            <label class="custom-control-label" for="customCheck1">
                                                Customer Behavior (Highly Political/Baby Sitting)
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="row mt-lg-2">
                                    <div class="col-5">
                                        <div class="custom-control custom-checkbox">
                                            @{count = 0;}
                                            @foreach (var item in ViewBag.riskdata)
                                            {
                                                @if (item.RiskName == "Stringent Requirement")
                                                {
                                                    <input type="checkbox" class="form-check-input checkbox"
                                                    style="border: 1px solid;" name="checkStringentReq" id="checkStringentReq" checked>
                                                    count++;
                                                }
                                            }
                                            @if (count == 0)
                                            {
                                                <input type="checkbox" class="form-check-input checkbox"
                                                style="border: 1px solid;" name="checkStringentReq" id="checkStringentReq">
                                            }
                                            <label class="custom-control-label" for="customCheck1">Stringent Requirement	</label>
                                        </div>
                                    </div>
                                    <div class="col-5">
                                        <div class="custom-control custom-checkbox" id="divCheckAppImplementation">
                                            @{count = 0;}
                                            @foreach (var item in ViewBag.riskdata)
                                            {
                                                @if (item.RiskName == "Application Implementation Project")
                                                {
                                                    <input type="checkbox" class="form-check-input checkbox"
                                                   style="border: 1px solid;" name="checkAppImplementation" id="checkAppImplementation" checked>
                                                    count++;
                                                }
                                            }
                                            @if (count == 0)
                                            {
                                                <input type="checkbox" class="form-check-input checkbox"
                                                   style="border: 1px solid;" name="checkAppImplementation" id="checkAppImplementation">
                                            }
                                            
                                            <label class="custom-control-label" for="customCheck1">
                                                Application Implementation Project
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="row mt-lg-2">
                                    <div class="col-5">
                                        <div class="custom-control custom-checkbox" id="divCheckMultiSubcon">
                                            @{count = 0;}
                                            @foreach (var item in ViewBag.riskdata)
                                            {
                                                @if (item.RiskName == "Multi Subcon / Vendor")
                                                {
                                                    <input type="checkbox" class="form-check-input checkbox"
                                                   style="border: 1px solid;" name="checkMultiSubcon" id="checkMultiSubcon" checked>
                                                    count++;
                                                }
                                            }
                                            @if (count == 0)
                                            {
                                                <input type="checkbox" class="form-check-input checkbox"
                                                   style="border: 1px solid;" name="checkMultiSubcon" id="checkMultiSubcon">
                                            }
                                            
                                            <label class="custom-control-label" for="customCheck1">Multi Subcon / Vendor	</label>
                                        </div>
                                    </div>
                                    <div class="col-5">
                                        <div class="custom-control custom-checkbox">
                                            @{count = 0;}
                                            @foreach (var item in ViewBag.riskdata)
                                            {
                                                @if (item.RiskName == "Unclear Scope")
                                                {
                                                    <input type="checkbox" class="form-check-input checkbox"
                                                   style="border: 1px solid;" name="checkUnclearScope" id="checkUnclearScope" checked>
                                                    count++;
                                                }
                                            }
                                            @if (count == 0)
                                            {
                                                <input type="checkbox" class="form-check-input checkbox"
                                                   style="border: 1px solid;" name="checkUnclearScope" id="checkUnclearScope">
                                            }
                                            
                                            <label class="custom-control-label" for="customCheck1">
                                                Unclear Scope
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="row mt-lg-2">
                                    <div class="col-5">
                                        <div class="custom-control custom-checkbox">
                                            @{count = 0;}
                                            @foreach (var item in ViewBag.riskdata)
                                            {
                                                @if (item.RiskName == "Multi Platform")
                                                {
                                                    <input type="checkbox" class="form-check-input checkbox"
                                                   style="border: 1px solid;" name="checkMultiPlatform" id="checkMultiPlatform" checked>
                                                    count++;
                                                }
                                            }
                                            @if (count == 0)
                                            {
                                                <input type="checkbox" class="form-check-input checkbox"
                                                   style="border: 1px solid;" name="checkMultiPlatform" id="checkMultiPlatform">
                                            }
                                            
                                            <label class="custom-control-label" for="customCheck1">Multi Platform	</label>
                                        </div>
                                    </div>
                                    <div class="col-5">
                                        <div class="custom-control custom-checkbox" id="divCheckPayment100">
                                            @{count = 0;}
                                            @foreach (var item in ViewBag.riskdata)
                                            {
                                                @if (item.RiskName == "Payment 100% After Project Completion")
                                                {
                                                    <input type="checkbox" class="form-check-input checkbox"
                                                   style="border: 1px solid;" name="checkPayment100" id="checkPayment100" checked>
                                                    count++;
                                                }
                                            }
                                            @if (count == 0)
                                            {
                                                <input type="checkbox" class="form-check-input checkbox"
                                                   style="border: 1px solid;" name="checkPayment100" id="checkPayment100">
                                            }
                                            
                                            <label class="custom-control-label" for="customCheck1">
                                                Payment 100% After Project Completion
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row mt-lg-4">
                                <b>Internal Factors</b>
                            </div>
                            <div class="form-group">
                                <div class="row mt-lg-2">
                                    <div class="col-5">
                                        <div class="custom-control custom-checkbox">
                                            @{count = 0;}
                                            @foreach (var item in ViewBag.riskdata)
                                            {
                                                @if (item.RiskName == "Lack of Resource Capacity")
                                                {
                                                    <input type="checkbox" class="form-check-input checkbox"
                                                   style="border: 1px solid;" name="checkResourceCapacity" id="checkResourceCapacity" checked>
                                                    count++;
                                                }
                                            }
                                            @if (count == 0)
                                            {
                                                <input type="checkbox" class="form-check-input checkbox"
                                                   style="border: 1px solid;" name="checkResourceCapacity" id="checkResourceCapacity">
                                            }
                                            
                                            <label class="custom-control-label" for="customCheck1">
                                                Lack of Resource Capacity
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="row mt-lg-2">
                                    <div class="col-5">
                                        <div class="custom-control custom-checkbox">
                                            @{count = 0;}
                                            @foreach (var item in ViewBag.riskdata)
                                            {
                                                @if (item.RiskName == "Lack of Resource Capability")
                                                {
                                                   <input type="checkbox" class="form-check-input checkbox"
                                                   style="border: 1px solid;" name="checkResourceCapability" id="checkResourceCapability" checked>
                                                    count++;
                                                }
                                            }
                                            @if (count == 0)
                                            {
                                                <input type="checkbox" class="form-check-input checkbox"
                                                   style="border: 1px solid;" name="checkResourceCapability" id="checkResourceCapability">
                                            }
                                            
                                            <label class="custom-control-label" for="customCheck1">
                                                Lack of Resource Capability
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="row mt-lg-2">
                                    <div class="col-5">
                                        <div class="custom-control custom-checkbox">
                                            @{count = 0;}
                                            @foreach (var item in ViewBag.riskdata)
                                            {
                                                @if (item.RiskName == "TOP does not Comply to MLPT Policy")
                                                {
                                                    <input type="checkbox" class="form-check-input checkbox"
                                                   style="border: 1px solid;" name="checkTOP" id="checkTOP" checked>
                                                    count++;
                                                }
                                            }
                                            @if (count == 0)
                                            {
                                                <input type="checkbox" class="form-check-input checkbox"
                                                   style="border: 1px solid;" name="checkTOP" id="checkTOP">
                                            }
                                            
                                            <label class="custom-control-label" for="customCheck1">
                                                TOP does not Comply to MLPT Policy
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="row mt-lg-2">
                                    <div class="col-5">
                                        <div class="custom-control custom-checkbox">
                                            @{count = 0;}
                                            @foreach (var item in ViewBag.riskdata)
                                            {
                                                @if (item.RiskName == "GP Projection Less than Target")
                                                {
                                                    <input type="checkbox" class="form-check-input checkbox"
                                                   style="border: 1px solid;" name="checkGPProjection" id="checkGPProjection" checked>
                                                    count++;
                                                }
                                            }
                                            @if (count == 0)
                                            {
                                                <input type="checkbox" class="form-check-input checkbox"
                                                   style="border: 1px solid;" name="checkGPProjection" id="checkGPProjection">
                                            }
                                            
                                            <label class="custom-control-label" for="customCheck1">
                                                GP Projection Less than Target
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row mt-lg-4">
                                <div class="col-2">
                                    <label class="col-form-label control-label">
                                        <b style="color:#970000">
                                            Overall Risk
                                        </b>
                                    </label>
                                </div>
                                <div class="col-4">
                                    <div class="row">
                                        <label class="col-form-label control-label col-1">
                                            :
                                        </label>
                                        <select class='form-select form-control' style='width: 250px' id='selectOverallRisk' runat='server' name='OverallRisk'>
                                            @foreach (var item in @ViewBag.risktype)
                                            {
                                                @if (Model.OverallRisk == item.RiskType)
                                                {
                                                    <option selected='@item.RiskType'> @item.RiskType</option>
                                                }
                                                else{
                                                    <option value='@item.RiskType'> @item.RiskType</option>
                                                }
                                            }
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="row mt-lg-4">
                                <b>
                                    Risk Description:
                                </b>
                            </div>
                            <div class="row mt-lg-2">
                                <div class="col-7">
                                    @if (ViewBag.riskassess != null)
                                    {
                                        <textarea class="form-control" style="width:650px;height:100px" id="txtRiskDesc">@ViewBag.riskassess.Description</textarea>
                                    }
                                    else{
                                        <textarea class="form-control" style="width:650px;height:100px" id="txtRiskDesc"></textarea>
                                    }
                                </div>
                            </div>
                            <div class="row mt-lg-4">
                                <b>
                                    Detail Assessment Information:
                                </b>
                            </div>
                            <div class="form-group">
                                <div class="row mt-lg-2">
                                    <div class="col-2">
                                        <label class="col-form-label control-label col-11">
                                            Source of Budget
                                        </label>

                                    </div>
                                    <div class="col-4">
                                        <div class="row">
                                            <label class="col-form-label control-label col-1">
                                                :
                                            </label>
                                            <select class='form-select form-control' style='width: 250px' id='selectSourceBudget' runat='server' name='SourceBudget'>
                                                <option selected=''></option>
                                                @foreach (var item in @ViewBag.sourcebudget)
                                                {
                                                    @if (ViewBag.riskassess != null)
                                                    {
                                                        @if (item.Id.ToString() == ViewBag.riskassess.SourceBudget)
                                                        {
                                                            <option value='@item.Id' selected> @item.Type</option>
                                                        
                                                        }
                                                        else{
                                                            <option value='@item.Id'> @item.Type</option>

                                                        }
                                                        
                                                    }
                                                    else{
                                                        <option value='@item.Id'> @item.Type</option>

                                                    }
                                                }
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-2">
                                        <label class="col-form-label control-label col-11">
                                            Est. Project Start
                                        </label>

                                    </div>
                                    <div class="col-4">
                                        <div class="row">
                                            <label class="col-form-label control-label col-1">
                                                :
                                            </label>
                                            @if (ViewBag.riskassess != null)
                                            {
                                                @if (ViewBag.riskassess.EstProjectStart != null)
                                                {
                                                    <input class="form-control" name="txtEstProjectStart" id="txtEstProjectStart"                                 style="width:250px;" type="date"                                                                      value=@ViewBag.riskassess.EstProjectStart.ToString("yyyy-MM-dd")>
                                                }
                                                else{
                                                    <input class="form-control" name="txtEstProjectStart" id="txtEstProjectStart"                                 style="width:250px;" type="date">
                                                }
                                            }
                                            else{
                                                <input class="form-control" name="txtEstProjectStart" id="txtEstProjectStart"                                 style="width:250px;" type="date">
                                            }
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="row mt-lg-2">
                                    <div class="col-2">
                                        <label class="col-form-label control-label col-11">
                                            Competition
                                        </label>

                                    </div>
                                    <div class="col-4">
                                        <div class="row">
                                            <label class="col-form-label control-label col-1">
                                                :
                                            </label>
                                            <select class='form-select form-control' style='width: 250px' id='selectCompetition' runat='server' name='Competition'>
                                                <option selected=''></option>
                                                @foreach (var item in @ViewBag.competition)
                                                {
                                                    @if (ViewBag.riskassess != null)
                                                    {
                                                        @if (item.Id.ToString() == ViewBag.riskassess.Competition)
                                                        {
                                                            <option value='@item.Id' selected> @item.Type</option>
                                                        
                                                        }
                                                        else{
                                                            <option value='@item.Id'> @item.Type</option>

                                                        }
                                                        
                                                    }
                                                    else{
                                                        <option value='@item.Id'> @item.Type</option>

                                                    }
                                                }
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-2">
                                        <label class="col-form-label control-label col-11">
                                            Est. Project End
                                        </label>

                                    </div>
                                    <div class="col-4">
                                        <div class="row">
                                            <label class="col-form-label control-label col-1">
                                                :
                                            </label>
                                            @if (ViewBag.riskassess != null)
                                            {
                                                @if (ViewBag.riskassess.EstProjectCompletion != null)
                                                {
                                                    <input class="form-control" name="txtEstProjectEnd" id="txtEstProjectEnd" style="width:250px;" type="date" value=@ViewBag.riskassess.EstProjectCompletion.ToString("yyyy-MM-dd")>
                                                }
                                                else{
                                                    <input class="form-control" name="txtEstProjectEnd" id="txtEstProjectEnd" style="width:250px;" type="date">
                                                }
                                            }
                                            else{
                                                <input class="form-control" name="txtEstProjectEnd" id="txtEstProjectEnd" style="width:250px;" type="date">
                                            }
                                            
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="row mt-lg-2">
                                    <div class="col-2">
                                        <label class="col-form-label control-label col-11">
                                            Contigency Cost
                                        </label>

                                    </div>
                                    <div class="col-4">
                                        <div class="row">
                                            <label class="col-form-label control-label col-1">
                                                :
                                            </label>
                                            <select class='form-select form-control' style='width: 250px' id='selectContingency' runat='server' name='Contingency'>
                                                <option selected=''></option>
                                                @foreach (var item in @ViewBag.contingency)
                                                {
                                                    @if (ViewBag.riskassess != null)
                                                    {
                                                        @if (ViewBag.riskassess.ContigencyCost != null && item.Text == "Yes")
                                                        {
                                                            <option value='@item.Type' selected> @item.Text</option>
                                                        }
                                                        else{
                                                            <option value='@item.Type'> @item.Text</option>
                                                        }
                                                    }
                                                    else{
                                                        <option value='@item.Type'> @item.Text</option>
                                                    }
                                                }
                                            </select>
                                        </div>
                                        @if (ViewBag.riskassess != null)
                                        {
                                            @if (ViewBag.riskassess.ContigencyCost != null)
                                            {
                                                <div class="row mt-lg-2" id="visibleContingency">
                                                    <div class="col-1">
                                                    </div>
                                                    <input class="form-control" style="width:250px" type="text" value="@ViewBag.riskassess.ContigencyCost"  id="txtContingencyCost"/>
                                                    <label class="col-form-label control-label col-1">
                                                    %
                                                    </label>
                                                </div>
                                            }
                                            else{
                                                <div class="row mt-lg-2" id="visibleContingency" hidden>
                                                    <div class="col-1">
                                                    </div>
                                                    <input class="form-control" style="width:250px" type="text" value=""  id="txtContingencyCost"/>
                                                    <label class="col-form-label control-label col-1">
                                                    %
                                                    </label>
                                                </div>
                                            }
                                        }
                                        else{
                                            <div class="row mt-lg-2" id="visibleContingency" hidden>
                                                <div class="col-1">
                                                </div>
                                                <input class="form-control" style="width:250px" type="text" value=""  id="txtContingencyCost"/>
                                                <label class="col-form-label control-label col-1">
                                                %
                                                </label>
                                            </div>
                                        }
                                        
                                    </div>
                                    <div class="col-2">
                                        <label class="col-form-label control-label col-11">
                                            Procurement Type
                                        </label>

                                    </div>
                                    <div class="col-4">
                                        <div class="row">
                                            <label class="col-form-label control-label col-1">
                                                :
                                            </label>
                                            <select class='form-select form-control' style='width: 250px' id='selectProcType' runat='server' name='ProcType'>
                                                <option selected=''></option>
                                                @foreach (var item in @ViewBag.proctype)
                                                {
                                                    @if (ViewBag.riskassess != null)
                                                    {
                                                        @if (ViewBag.riskassess.ProcurementType == item.Id.ToString())
                                                        {
                                                            <option value='@item.Id' selected> @item.Type</option>
                                                        }
                                                        else{
                                                            <option value='@item.Id'> @item.Type</option>
                                                        }
                                                    }
                                                    else{
                                                        <option value='@item.Id'> @item.Type</option>
                                                    }
                                                    
                                                }
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="row mt-lg-2">
                                    <div class="col-2">
                                        <label class="col-form-label control-label col-11">
                                            Competitor
                                        </label>

                                    </div>
                                    <div class="col-4">
                                        <div class="row">
                                            <label class="col-form-label control-label col-1">
                                                :
                                            </label>
                                            @if (ViewBag.riskassess != null)
                                            {
                                                <textarea class="form-control" style="width:380px;height:100px" id="txtCompetitor">@ViewBag.riskassess.Competitor</textarea>
                                                
                                            }
                                            else{
                                                <textarea class="form-control" style="width:380px;height:100px" id="txtCompetitor"></textarea>

                                            }
                                        </div>
                                    </div>
                                    <div class="col-2">
                                        <label class="col-form-label control-label col-11">
                                            Procurement Info
                                        </label>

                                    </div>
                                    <div class="col-4">
                                        <div class="row">
                                            <label class="col-form-label control-label col-1">
                                                :
                                            </label>
                                            <select class='form-select form-control' style='width: 250px' id='selectProjectSource' runat='server' name='ProjectSource'>
                                                <option selected=''></option>
                                                @foreach (var item in @ViewBag.projectsource)
                                                {
                                                    @if (ViewBag.riskassess != null)
                                                    {
                                                        @if (ViewBag.riskassess.ProjectSource == item.Id.ToString())
                                                        {
                                                            <option value='@item.Id' selected> @item.Type</option>
                                                        }
                                                        else{
                                                            <option value='@item.Id'> @item.Type</option>
                                                        }
                                                    }
                                                    else{
                                                        <option value='@item.Id'> @item.Type</option>
                                                    }
                                                }
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="row mt-lg-2">
                                    <div class="col-2">
                                        <label class="col-form-label control-label col-11">
                                            Revenue Sharing
                                        </label>

                                    </div>
                                    <div class="col-4">
                                        <div class="row">
                                            <label class="col-form-label control-label col-1">
                                                :
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="row mt-lg-2">
                                    <div class="col-1">
                                    </div>
                                    <div class="col-1">
                                        <label class="col-form-label control-label col-11">
                                            MLPT (Ex: 100)
                                        </label>

                                    </div>
                                    <div class="col-4">
                                        <div class="row">
                                            <label class="col-form-label control-label col-1">
                                                :
                                            </label>
                                            @if (ViewBag.projectrevmlpt != null)
                                            {
                                                <input class="form-control" style="width:250px" type="text" value="@ViewBag.projectrevmlpt.ProjectRevenue"  id="txtRevMLPT"/>
                                                
                                            }
                                            else{
                                                <input class="form-control" style="width:250px" type="text" value=""  id="txtRevMLPT"/>

                                            }
                                            
                                            <label class="col-form-label control-label col-1">
                                            %
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="row mt-lg-2">
                                    <div class="col-1">
                                    </div>
                                    <div class="col-1">
                                        <label class="col-form-label control-label col-11">
                                            # Subcon
                                        </label>

                                    </div>
                                    <div class="col-4">
                                        <div class="row">
                                            <label class="col-form-label control-label col-1">
                                                :
                                            </label>
                                            @if (ViewBag.countsubcon == 0)
                                            {
                                                <input class="form-control" style="width:250px" type="number" min="0" value=""  id="txtTotSubCon"/>
                                                
                                            }
                                            else{
                                                <input class="form-control" style="width:250px" type="number" min="0" value="@ViewBag.countsubcon"  id="txtTotSubCon"/>

                                            }
                                        </div>
                                        
                                    </div>
                                </div>
                                <div class="row mt-lg-4" id="visibleTableRevSharingSubCon">
                                    <div class="col-2">
                                                
                                    </div>
                                    <div class="col-9">
                                        <div class="table-wrapper table-responsive-lg">
                                            <table class="table table-striped" style="font-size:small;vertical-align:middle" id="tableRevSharing">
                                                <thead style="background:darkGreen;color:white">
                                                    <tr>
                                                        <th scope="col">Subcon Name</th>
                                                        <th scope="col">%</th>
                                                        <th scope="col">High Level Scope</th>
                                                        <th scope="col">Preload</th>
                                                    </tr>
                                                </thead>
                                                <tbody id="bodyRevSharingSubCon">
                                                    
                                                    @foreach (var rev in ViewBag.projectrev)
                                                    {
                                                        <tr class="trRowRevSharing">
                                                            <td scope="col" class="tdSubconName">
                                                                <select class='form-select form-control selectSubconName' style='width: 250px' id='selectSubconName' runat='server' name='SubconName'>
                                                                    <option selected=''>(Please Select)</option>
                                                                    @foreach (var item in @ViewBag.principles)
                                                                    {
                                                                        if (item.Vendor == rev.PrincipalName)
                                                                        {
                                                                            <option value='@item.Vendor' selected> @item.Vendor</option>
                                                                        }
                                                                        else{
                                                                            <option value='@item.Vendor'> @item.Vendor</option>
                                                                        }
                                                                        
                                                                    }
                                                                </select>
                                                                <div class="mt-lg-2 divTxtOtherSubconName" hidden>
                                                                    <input class="form-control txtSubconName" style="width:250px" type="text" value="@rev.PrincipalName"/>
                                                                </div>

                                                            </td>
                                                            <td scope="col" class="tdPercent">
                                                                <input class="form-control txtPercent" style="width:80px" type="text" value="@rev.ProjectRevenue"/>
                                                            </td>
                                                            <td scope="col" class="tdHighLvlScope">
                                                                <input class="form-control txtHighLvlScope" style="min-width:400px" type="text" value="@rev.PrincipalScope"/>
                                                            </td>
                                                            <td scope="col" class="tdPreload">
                                                                <select class='form-select form-control txtPreload' style='width: 80px' id='selectPreload' runat='server' name='Preload'>
                                                                    @foreach (var item in @ViewBag.principalpreload)
                                                                    {
                                                                        if (item.Id == rev.Preload)
                                                                        {
                                                                            <option value='@item.Id' selected> @item.Type</option>
                                                                        }
                                                                        else{
                                                                            <option value='@item.Id'> @item.Type</option>
                                                                        }
                                                                    }
                                                                </select>
                                                            </td>
                                                        </tr>
                                                    }
                                                    <tr id="emptyRowRevSharing" hidden>
                                                        <td scope="col" class="tdSubconName">
                                                            <select class='form-select form-control selectSubconName' style='width: 250px' id='selectSubconName' runat='server' name='SubconName'>
                                                                <option selected=''>(Please Select)</option>
                                                                @foreach (var item in @ViewBag.principles)
                                                                {
                                                                    <option value='@item.Vendor'> @item.Vendor</option>
                                                                }
                                                            </select>
                                                            <div class="mt-lg-2 divTxtOtherSubconName" hidden>
                                                                <input class="form-control txtSubconName" style="width:250px" type="text" value=""/>
                                                            </div>

                                                        </td>
                                                        <td scope="col" class="tdPercent">
                                                            <input class="form-control txtPercent" style="width:80px" type="text" value=""/>
                                                        </td>
                                                        <td scope="col" class="tdHighLvlScope">
                                                            <input class="form-control txtHighLvlScope" style="min-width:400px" type="text" value=""/>
                                                        </td>
                                                        <td scope="col" class="tdPreload">
                                                            <select class='form-select form-control txtPreload' style='width: 80px' id='selectPreload' runat='server' name='Preload'>
                                                                @foreach (var item in @ViewBag.principalpreload)
                                                                {
                                                                    <option value='@item.Id'> @item.Type</option>
                                                                }
                                                            </select>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                 </div>
                            </div>
                            <div class="form-group">
                                <div class="row mt-lg-2">
                                    <div class="col-2">
                                        <label class="col-form-label control-label col-11">
                                            Procurement Condition
                                        </label>
                                    </div>
                                    <div class="col-4">
                                        <div class="row">
                                            <label class="col-form-label control-label col-1">
                                                :
                                            </label>
                                            @if (ViewBag.riskassess != null)
                                            {
                                                <textarea class="form-control" style="width:380px;height:100px" id="txtProcCondition">@ViewBag.riskassess.ProjectCondition</textarea>
                                                
                                            }
                                            else{
                                                <textarea class="form-control" style="width:380px;height:100px" id="txtProcCondition"></textarea>

                                            }
                                            
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="row mt-lg-2">
                                    <div class="col-2">
                                        <label class="col-form-label control-label col-11">
                                            Predefined Condition Requested by Principal/Broker
                                        </label>

                                    </div>
                                    <div class="col-4">
                                        <div class="row">
                                            <label class="col-form-label control-label col-1">
                                                :
                                            </label>
                                            @if (ViewBag.riskassess != null)
                                            {
                                                <textarea class="form-control" style="width:380px;height:100px" id="txtPredefinedCondition" >@ViewBag.riskassess.PredefinedConditionReqByPrincipal</textarea>
                                                
                                            }
                                            else{
                                                <textarea class="form-control" style="width:380px;height:100px" id="txtPredefinedCondition" ></textarea>

                                            }
                                            
                                        </div>

                                    </div>
                                </div>
                            </div>
                            <div class="row mt-lg-4">
                                <b>
                                    Risk Assessment Committee:
                                </b>
                            </div>
                            <div class="form-group">
                                <div class="row mt-lg-2">
                                    <div class="col-2">
                                        <label class="col-form-label control-label col-11">
                                            Assigned To
                                        </label>

                                    </div>
                                    <div class="col-4">
                                        <div class="row">
                                            <label class="col-form-label control-label col-1">
                                                :
                                            </label>
                                            <textarea class="form-control readonly-select" id="editresultSelectedCommittee" style="width:380px;height:100px">@ViewBag.riskassignto</textarea>
                                        </div>
                                    </div>
                                    <div class="col-4" hidden id="divResultSelectedCommitteeDomain">
                                        @if (ViewBag.riskassess != null)
                                            {
                                                <textarea class="form-control" id="resultSelectedCommitteeDomain">@ViewBag.riskassess.EmailAssignTo</textarea>
                                                
                                            }
                                            else{
                                                <textarea class="form-control" id="resultSelectedCommitteeDomain"></textarea>

                                            }
                                    </div>
                                    <div class="col-2">
                                        <a class="btn btn-outline-secondary modalDelete" id="selectCommittee" data-bs-toggle="modal" data-bs-target="#assignCommitteeModal" style="display:none">
                                            Select Committee
                                        </a>
                                        @* <input class="form-control" style="width:250px" type="text" value="" /> *@
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="row mt-lg-2">
                                    <div class="col-2">
                                        <label class="col-form-label control-label col-11">
                                            Committee
                                        </label>

                                    </div>
                                    <div class="col-4">
                                        <div class="row">
                                            <label class="col-form-label control-label col-1">
                                                :
                                            </label>
                                            <input class="form-control" style="width:250px" type="text" value=""  hidden/>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="row mt-lg-4">
                                    <div class="col">
                                        @if (ViewBag.riskassess == null)
                                        { 
                                            <a id="btnsubmitassess" onclick="valid()" data-toggle="tooltip" class="btn btn-outline-success">
                                                Assess
                                            </a>
                                        }
                                        @if (ViewBag.useraccesscommittee != null || ViewBag.useraccessSuperAdmin != null)
                                        {
                                            <a id="btnsubmitreviewrisk" data-bs-toggle="modal" data-bs-target="#reviewRisk" data-toggle="tooltip" class="btn btn-outline-success">
                                                Review
                                            </a>
                                        }
                                        @if (ViewBag.useraccessam != null || ViewBag.useraccessSuperAdmin != null || ViewBag.useraccessbod != null)
                                        {
                                            <a id="btnsubmitassign" onclick="assignRiskCommittee()" data-toggle="tooltip" class="btn btn-outline-success">
                                                Assign
                                            </a>
                                        }
                                        @if (ViewBag.useraccessbod != null || ViewBag.useraccessSuperAdmin != null)
                                        {
                                            <a id="btnapproverisk" data-bs-toggle="modal" data-bs-target="#approveRisk" data-toggle="tooltip" class="btn btn-outline-success">
                                                Approve
                                            </a>
                                            <a id="btnrejectrisk" data-bs-toggle="modal" data-bs-target="#rejectRisk" data-toggle="tooltip" class="btn btn-outline-danger">
                                                Reject
                                            </a>
                                        }
                                    </div>
                                </div>
                            </div>
                        </div>
                    }
                    else if (@Model.Type == "Risk Approved" || @Model.Type == "Risk Rejected"){
                        <div class="tab-pane fade" id="pills-risk" role="tabpanel" aria-labelledby="risk-tab">
                            <hr />
                            <b>External Factors</b>
                            <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                            @* <input type="hidden" asp-for="DocumentId" value="@Model.DocumentId" />
                            <input type="hidden" asp-for="Id" value="@Model.Id" /> *@
                            <div class="form-group">
                                <div class="row mt-lg-2">
                                    <div class="col-5">
                                        <div class="custom-control custom-checkbox" id="divCheckNewProduct">
                                            @{var count = 0;}
                                            @foreach (var item in ViewBag.riskdata)
                                            {
                                                @if (item.RiskName == "New Product / 1st Implementation")
                                                {
                                                    <input type="checkbox" class="form-check-input checkbox readonly-select"
                                                   style="border: 1px solid;" name="checkNewProduct" id="checkNewProduct" checked>
                                                    count++;
                                                    break;
                                                }
                                            }
                                            @if (count == 0)
                                            {
                                                <input type="checkbox" class="form-check-input checkbox readonly-select"
                                                   style="border: 1px solid;" name="checkNewProduct" id="checkNewProduct">
                                            }
                                            
                                            <label class="custom-control-label" for="customCheck1">New Product / 1st Implementation</label>
                                        </div>
                                    </div>
                                    <div class="col-5">
                                        <div class="custom-control custom-checkbox" id="divCheckTightTimeline">
                                            @{count = 0;}
                                            @foreach (var item in ViewBag.riskdata)
                                            {
                                                @if (item.RiskName == "Tight Timeline")
                                                {
                                                    <input type="checkbox" class="form-check-input checkbox readonly-select"
                                                   style="border: 1px solid;" name="checkTightTimeline" id="checkTightTimeline" checked>
                                                    count++;
                                                    break;
                                                }
                                            }
                                            @if (count == 0)
                                            {
                                                <input type="checkbox" class="form-check-input checkbox readonly-select"
                                                   style="border: 1px solid;" name="checkTightTimeline" id="checkTightTimeline">
                                            }
                                            
                                            <label class="custom-control-label" for="customCheck1">
                                                Tight Timeline
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="row mt-lg-2">
                                    <div class="col-5">
                                        <div class="custom-control custom-checkbox">
                                            @{count = 0;}
                                            @foreach (var item in ViewBag.riskdata)
                                            {
                                                @if (item.RiskName == "New Customer")
                                                {
                                                    <input type="checkbox" class="form-check-input checkbox readonly-select"
                                                   style="border: 1px solid;" name="checkNewCustomer" id="checkNewCustomer" checked>
                                                    count++;
                                                    break;
                                                }
                                            }
                                            @if (count == 0)
                                            {
                                                <input type="checkbox" class="form-check-input checkbox readonly-select"
                                                   style="border: 1px solid;" name="checkNewCustomer" id="checkNewCustomer">
                                            }
                                            
                                            <label class="custom-control-label" for="customCheck1">New Customer	</label>
                                        </div>
                                    </div>
                                    <div class="col-5">
                                        <div class="custom-control custom-checkbox">
                                            @{count = 0;}
                                            @foreach (var item in ViewBag.riskdata)
                                            {
                                                @if (item.RiskName == "Harsh Penalty")
                                                {
                                                   <input type="checkbox" class="form-check-input checkbox"
                                                   style="border: 1px solid;" name="checkHarshPenalty" id="checkHarshPenalty" checked>
                                                    count++;
                                                    break;
                                                }
                                            }
                                            @if (count == 0)
                                            {
                                                <input type="checkbox" class="form-check-input checkbox readonly-select"
                                                   style="border: 1px solid;" name="checkHarshPenalty" id="checkHarshPenalty">
                                            }
                                            
                                            <label class="custom-control-label" for="customCheck1">
                                                Harsh Penalty
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="row mt-lg-2">
                                    <div class="col-5">
                                        <div class="custom-control custom-checkbox" id="divCheckNewSubcon">
                                            @{count = 0;}
                                            @foreach (var item in ViewBag.riskdata)
                                            {
                                                @if (item.RiskName == "New Subcon / Vendor")
                                                {
                                                    <input type="checkbox" class="form-check-input checkbox readonly-select"
                                                   style="border: 1px solid;" name="checkNewSubcon" id="checkNewSubcon" checked>
                                                    count++;
                                                    break;
                                                }
                                            }
                                            @if (count == 0)
                                            {
                                                <input type="checkbox" class="form-check-input checkbox readonly-select"
                                                   style="border: 1px solid;" name="checkNewSubcon" id="checkNewSubcon">
                                            }
                                            
                                            <label class="custom-control-label" for="customCheck1">New Subcon / Vendor	</label>
                                        </div>
                                    </div>
                                    <div class="col-5">
                                        <div class="custom-control custom-checkbox" id="divCheckNonITSOW">
                                            @{count = 0;}
                                            @foreach (var item in ViewBag.riskdata)
                                            {
                                                @if (item.RiskName == "Non IT Scope of Work")
                                                {
                                                    <input type="checkbox" class="form-check-input checkbox readonly-select"
                                                   style="border: 1px solid;" name="checkNonITSOW" id="checkNonITSOW" checked>
                                                    count++;
                                                    break;
                                                }
                                            }
                                            @if (count == 0)
                                            {
                                                <input type="checkbox" class="form-check-input checkbox readonly-select"
                                                   style="border: 1px solid;" name="checkNonITSOW" id="checkNonITSOW">
                                            }
                                            
                                            <label class="custom-control-label" for="customCheck1">
                                                Non IT Scope of Work
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="row mt-lg-2">
                                    <div class="col-5">
                                        <div class="custom-control custom-checkbox">
                                            @{count = 0;}
                                            @foreach (var item in ViewBag.riskdata)
                                            {
                                                @if (item.RiskName == "Multi Site / Roll Out")
                                                {
                                                    <input type="checkbox" class="form-check-input checkbox readonly-select"
                                                   style="border: 1px solid;" name="checkMultiSite" id="checkMultiSite" checked>
                                                    count++;
                                                    break;
                                                }
                                            }
                                            @if (count == 0)
                                            {
                                                <input type="checkbox" class="form-check-input checkbox readonly-select"
                                                   style="border: 1px solid;" name="checkMultiSite" id="checkMultiSite">
                                            }
                                            
                                            <label class="custom-control-label" for="customCheck1">Multi Site / Roll Out	</label>
                                        </div>
                                    </div>
                                    <div class="col-5">
                                        <div class="custom-control custom-checkbox">
                                            @{count = 0;}
                                            @foreach (var item in ViewBag.riskdata)
                                            {
                                                @if (item.RiskName == "Customer Behavior (Highly Political/Baby Sitting)")
                                                {
                                                    <input type="checkbox" class="form-check-input checkbox readonly-select"
                                                   style="border: 1px solid;" name="checkCustomerBehavior" id="checkCustomerBehavior" checked>
                                                    count++;
                                                    break;
                                                }
                                            }
                                            @if (count == 0)
                                            {
                                                <input type="checkbox" class="form-check-input checkbox readonly-select" 
                                                   style="border: 1px solid;" name="checkCustomerBehavior" id="checkCustomerBehavior">
                                            }
                                            
                                            <label class="custom-control-label" for="customCheck1">
                                                Customer Behavior (Highly Political/Baby Sitting)
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="row mt-lg-2">
                                    <div class="col-5">
                                        <div class="custom-control custom-checkbox">
                                            @{count = 0;}
                                            @foreach (var item in ViewBag.riskdata)
                                            {
                                                @if (item.RiskName == "Stringent Requirement")
                                                {
                                                    <input type="checkbox" class="form-check-input checkbox readonly-select"
                                                    style="border: 1px solid;" name="checkStringentReq" id="checkStringentReq" checked>
                                                    count++;
                                                    break;
                                                }
                                            }
                                            @if (count == 0)
                                            {
                                                <input type="checkbox" class="form-check-input checkbox readonly-select"
                                                style="border: 1px solid;" name="checkStringentReq" id="checkStringentReq">
                                            }
                                            <label class="custom-control-label" for="customCheck1">Stringent Requirement	</label>
                                        </div>
                                    </div>
                                    <div class="col-5">
                                        <div class="custom-control custom-checkbox" id="divCheckAppImplementation">
                                            @{count = 0;}
                                            @foreach (var item in ViewBag.riskdata)
                                            {
                                                @if (item.RiskName == "Application Implementation Project")
                                                {
                                                    <input type="checkbox" class="form-check-input checkbox readonly-select"
                                                   style="border: 1px solid;" name="checkAppImplementation" id="checkAppImplementation" checked>
                                                    count++;
                                                    break;
                                                }
                                            }
                                            @if (count == 0)
                                            {
                                                <input type="checkbox" class="form-check-input checkbox readonly-select"
                                                   style="border: 1px solid;" name="checkAppImplementation" id="checkAppImplementation">
                                            }
                                            
                                            <label class="custom-control-label" for="customCheck1">
                                                Application Implementation Project
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="row mt-lg-2">
                                    <div class="col-5">
                                        <div class="custom-control custom-checkbox" id="divCheckMultiSubcon">
                                            @{count = 0;}
                                            @foreach (var item in ViewBag.riskdata)
                                            {
                                                @if (item.RiskName == "Multi Subcon / Vendor")
                                                {
                                                    <input type="checkbox" class="form-check-input checkbox readonly-select"
                                                   style="border: 1px solid;" name="checkMultiSubcon" id="checkMultiSubcon" checked>
                                                    count++;
                                                    break;
                                                }
                                            }
                                            @if (count == 0)
                                            {
                                                <input type="checkbox" class="form-check-input checkbox readonly-select"
                                                   style="border: 1px solid;" name="checkMultiSubcon" id="checkMultiSubcon">
                                            }
                                            
                                            <label class="custom-control-label" for="customCheck1">Multi Subcon / Vendor	</label>
                                        </div>
                                    </div>
                                    <div class="col-5">
                                        <div class="custom-control custom-checkbox">
                                            @{count = 0;}
                                            @foreach (var item in ViewBag.riskdata)
                                            {
                                                @if (item.RiskName == "Unclear Scope")
                                                {
                                                    <input type="checkbox" class="form-check-input checkbox readonly-select"
                                                   style="border: 1px solid;" name="checkUnclearScope" id="checkUnclearScope" checked>
                                                    count++;
                                                    break;
                                                }
                                            }
                                            @if (count == 0)
                                            {
                                                <input type="checkbox" class="form-check-input checkbox readonly-select"
                                                   style="border: 1px solid;" name="checkUnclearScope" id="checkUnclearScope">
                                            }
                                            
                                            <label class="custom-control-label" for="customCheck1">
                                                Unclear Scope
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="row mt-lg-2">
                                    <div class="col-5">
                                        <div class="custom-control custom-checkbox">
                                            @{count = 0;}
                                            @foreach (var item in ViewBag.riskdata)
                                            {
                                                @if (item.RiskName == "Multi Platform")
                                                {
                                                    <input type="checkbox" class="form-check-input checkbox readonly-select"
                                                   style="border: 1px solid;" name="checkMultiPlatform" id="checkMultiPlatform" checked>
                                                    count++;
                                                    break;
                                                }
                                            }
                                            @if (count == 0)
                                            {
                                                <input type="checkbox" class="form-check-input checkbox readonly-select"
                                                   style="border: 1px solid;" name="checkMultiPlatform" id="checkMultiPlatform">
                                            }
                                            
                                            <label class="custom-control-label" for="customCheck1">Multi Platform	</label>
                                        </div>
                                    </div>
                                    <div class="col-5">
                                        <div class="custom-control custom-checkbox" id="divCheckPayment100">
                                            @{count = 0;}
                                            @foreach (var item in ViewBag.riskdata)
                                            {
                                                @if (item.RiskName == "Payment 100% After Project Completion")
                                                {
                                                    <input type="checkbox" class="form-check-input checkbox readonly-select"
                                                   style="border: 1px solid;" name="checkPayment100" id="checkPayment100" checked>
                                                    count++;
                                                    break;
                                                }
                                            }
                                            @if (count == 0)
                                            {
                                                <input type="checkbox" class="form-check-input checkbox readonly-select"
                                                   style="border: 1px solid;" name="checkPayment100" id="checkPayment100">
                                            }
                                            
                                            <label class="custom-control-label" for="customCheck1">
                                                Payment 100% After Project Completion
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row mt-lg-4">
                                <b>Internal Factors</b>
                            </div>
                            <div class="form-group">
                                <div class="row mt-lg-2">
                                    <div class="col-5">
                                        <div class="custom-control custom-checkbox">
                                            @{count = 0;}
                                            @foreach (var item in ViewBag.riskdata)
                                            {
                                                @if (item.RiskName == "Lack of Resource Capacity")
                                                {
                                                    <input type="checkbox" class="form-check-input checkbox readonly-select"
                                                   style="border: 1px solid;" name="checkResourceCapacity" id="checkResourceCapacity" checked>
                                                    count++;
                                                    break;
                                                }
                                            }
                                            @if (count == 0)
                                            {
                                                <input type="checkbox" class="form-check-input checkbox readonly-select"
                                                   style="border: 1px solid;" name="checkResourceCapacity" id="checkResourceCapacity">
                                            }
                                            
                                            <label class="custom-control-label" for="customCheck1">
                                                Lack of Resource Capacity
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="row mt-lg-2">
                                    <div class="col-5">
                                        <div class="custom-control custom-checkbox">
                                            @{count = 0;}
                                            @foreach (var item in ViewBag.riskdata)
                                            {
                                                @if (item.RiskName == "Lack of Resource Capability")
                                                {
                                                   <input type="checkbox" class="form-check-input checkbox readonly-select"
                                                   style="border: 1px solid;" name="checkResourceCapability" id="checkResourceCapability" checked>
                                                    count++;
                                                    break;
                                                }
                                            }
                                            @if (count == 0)
                                            {
                                                <input type="checkbox" class="form-check-input checkbox readonly-select"
                                                   style="border: 1px solid;" name="checkResourceCapability" id="checkResourceCapability">
                                            }
                                            
                                            <label class="custom-control-label" for="customCheck1">
                                                Lack of Resource Capability
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="row mt-lg-2">
                                    <div class="col-5">
                                        <div class="custom-control custom-checkbox">
                                            @{count = 0;}
                                            @foreach (var item in ViewBag.riskdata)
                                            {
                                                @if (item.RiskName == "TOP does not Comply to MLPT Policy")
                                                {
                                                    <input type="checkbox" class="form-check-input checkbox readonly-select"
                                                   style="border: 1px solid;" name="checkTOP" id="checkTOP" checked>
                                                    count++;
                                                    break;
                                                }
                                            }
                                            @if (count == 0)
                                            {
                                                <input type="checkbox" class="form-check-input checkbox readonly-select"
                                                   style="border: 1px solid;" name="checkTOP" id="checkTOP">
                                            }
                                            
                                            <label class="custom-control-label" for="customCheck1">
                                                TOP does not Comply to MLPT Policy
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="row mt-lg-2">
                                    <div class="col-5">
                                        <div class="custom-control custom-checkbox">
                                            @{count = 0;}
                                            @foreach (var item in ViewBag.riskdata)
                                            {
                                                @if (item.RiskName == "GP Projection Less than Target")
                                                {
                                                    <input type="checkbox" class="form-check-input checkbox readonly-select"
                                                   style="border: 1px solid;" name="checkGPProjection" id="checkGPProjection" checked>
                                                    count++;
                                                    break;
                                                }
                                            }
                                            @if (count == 0)
                                            {
                                                <input type="checkbox" class="form-check-input checkbox readonly-select"
                                                   style="border: 1px solid;" name="checkGPProjection" id="checkGPProjection">
                                            }
                                            
                                            <label class="custom-control-label" for="customCheck1">
                                                GP Projection Less than Target
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row mt-lg-4">
                                <div class="col-2">
                                    <label class="col-form-label control-label">
                                        <b style="color:#970000">
                                            Overall Risk
                                        </b>
                                    </label>
                                </div>
                                <div class="col-4">
                                    <div class="row">
                                        <label class="col-form-label control-label col-1">
                                            :
                                        </label>
                                        @foreach (var item in @ViewBag.risktype)
                                        {
                                            @if (Model.OverallRisk == item.RiskType)
                                            {
                                                <label class="col-form-label control-label col-5">
                                                    @item.RiskType
                                                </label>
                                                break;
                                            }
                                        }
                                    </div>
                                </div>
                            </div>
                            <div class="row mt-lg-4">
                                <b>
                                    Risk Description:
                                </b>
                            </div>
                            <div class="row mt-lg-2">
                                <div class="col-7">
                                    @if (ViewBag.riskassess != null)
                                    {
                                        <textarea class="form-control readonly-select" style="width:650px;height:100px" id="txtRiskDesc">@ViewBag.riskassess.Description</textarea>
                                    }
                                </div>
                            </div>
                            <div class="row mt-lg-4">
                                <b>
                                    Detail Assessment Information:
                                </b>
                            </div>
                            <div class="form-group">
                                <div class="row mt-lg-2">
                                    <div class="col-2">
                                        <label class="col-form-label control-label col-11">
                                            Source of Budget
                                        </label>

                                    </div>
                                    <div class="col-4">
                                        <div class="row">
                                            <label class="col-form-label control-label col-1">
                                                :
                                            </label>
                                                @foreach (var item in @ViewBag.sourcebudget)
                                                {
                                                    @if (ViewBag.riskassess != null)
                                                    {
                                                        @if (item.Id.ToString() == ViewBag.riskassess.SourceBudget)
                                                        {
                                                            <label class="col-form-label control-label col">
                                                                    @item.Type
                                                            </label>
                                                        break;
                                                        }
                                                    }
                                                }
                                        </div>
                                    </div>
                                    <div class="col-2">
                                        <label class="col-form-label control-label col-11">
                                            Est. Project Start
                                        </label>

                                    </div>
                                    <div class="col-4">
                                        <div class="row">
                                            <label class="col-form-label control-label col-1">
                                                :
                                            </label>
                                            @if (ViewBag.riskassess != null)
                                            {
                                                @if (ViewBag.riskassess.EstProjectStart != null)
                                                {
                                                    <label class="col-form-label control-label col-5">@ViewBag.riskassess.EstProjectStart.ToString("yyyy-MM-dd")</label>
                                                }
                                                
                                            }
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="row mt-lg-2">
                                    <div class="col-2">
                                        <label class="col-form-label control-label col-11">
                                            Competition
                                        </label>

                                    </div>
                                    <div class="col-4">
                                        <div class="row">
                                            <label class="col-form-label control-label col-1">
                                                :
                                            </label>
                                            @foreach (var item in @ViewBag.competition)
                                            {
                                                @if (ViewBag.riskassess != null)
                                                {
                                                    @if (item.Id.ToString() == ViewBag.riskassess.Competition)
                                                    {
                                                        <label class="col-form-label control-label col-5">
                                                            @item.Type
                                                        </label>
                                                        break;
                                                    }
                                                }
                                            }
                                        </div>
                                    </div>
                                    <div class="col-2">
                                        <label class="col-form-label control-label col-11">
                                            Est. Project End
                                        </label>

                                    </div>
                                    <div class="col-4">
                                        <div class="row">
                                            <label class="col-form-label control-label col-1">
                                                :
                                            </label>
                                            @if (ViewBag.riskassess != null)
                                            {
                                                @if (ViewBag.riskassess.EstProjectCompletion != null)
                                                {
                                                    <label class="col-form-label control-label col-5">@ViewBag.riskassess.EstProjectCompletion.ToString("yyyy-MM-dd")</label>
                                                }
                                            }
                                            
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="row mt-lg-2">
                                    <div class="col-2">
                                        <label class="col-form-label control-label col-11">
                                            Contigency Cost
                                        </label>

                                    </div>
                                    <div class="col-4">
                                        <div class="row">
                                            <label class="col-form-label control-label col-1">
                                                :
                                            </label>
                                            @foreach (var item in @ViewBag.contingency)
                                            {
                                                @if (ViewBag.riskassess != null)
                                                {
                                                    @if (ViewBag.riskassess.ContigencyCost != null && item.Text == "Yes")
                                                    {
                                                        <label class="col-form-label control-label col-5">
                                                            @item.Text
                                                        </label>
                                                        break;
                                                    }
                                                    else if(ViewBag.riskassess.ContigencyCost == null && item.Text == "No")
                                                    {
                                                        <label class="col-form-label control-label col-5">
                                                            @item.Text
                                                        </label>
                                                        break;
                                                    }
                                                }
                                            }
                                        </div>
                                        @if (ViewBag.riskassess != null)
                                        {
                                            @if (ViewBag.riskassess.ContigencyCost > 0)
                                            {
                                                <div class="row mt-lg-2" id="visibleContingency">
                                                    <div class="col-1">
                                                    </div>
                                                    <label class="col-form-label control-label col-5">@ViewBag.riskassess.ContigencyCost %</label>
                                                </div>
                                            }
                                        }
                                    </div>
                                    <div class="col-2">
                                        <label class="col-form-label control-label col-11">
                                            Procurement Type
                                        </label>

                                    </div>
                                    <div class="col-4">
                                        <div class="row">
                                            <label class="col-form-label control-label col-1">
                                                :
                                            </label>
                                            @foreach (var item in @ViewBag.proctype)
                                            {
                                                @if (ViewBag.riskassess != null)
                                                {
                                                    @if (ViewBag.riskassess.ProcurementType == item.Id.ToString())
                                                    {
                                                        <label class="col-form-label control-label col-5">
                                                            @item.Type
                                                        </label>
                                                        break;
                                                    }
                                                }
                                                    
                                            }
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="row mt-lg-2">
                                    <div class="col-2">
                                        <label class="col-form-label control-label col-11">
                                            Competitor
                                        </label>

                                    </div>
                                    <div class="col-4">
                                        <div class="row">
                                            <label class="col-form-label control-label col-1">
                                                :
                                            </label>
                                            @if (ViewBag.riskassess != null)
                                            {
                                                <textarea class="form-control readonly-select" style="width:380px;height:100px" id="txtCompetitor">@ViewBag.riskassess.Competitor</textarea>
                                                
                                            }
                                            else{
                                                <textarea class="form-control readonly-select" style="width:380px;height:100px" id="txtCompetitor"></textarea>

                                            }
                                        </div>
                                    </div>
                                    <div class="col-2">
                                        <label class="col-form-label control-label col-11">
                                            Procurement Info
                                        </label>

                                    </div>
                                    <div class="col-4">
                                        <div class="row">
                                            <label class="col-form-label control-label col-1">
                                                :
                                            </label>
                                            @foreach (var item in @ViewBag.projectsource)
                                            {
                                                @if (ViewBag.riskassess != null)
                                                {
                                                    @if (ViewBag.riskassess.ProjectSource == item.Id.ToString())
                                                    {
                                                        <label class="col-form-label control-label col-5">
                                                            @item.Type
                                                        </label>
                                                        break;
                                                    }
                                                }
                                            }
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="row mt-lg-2">
                                    <div class="col-2">
                                        <label class="col-form-label control-label col-11">
                                            Revenue Sharing
                                        </label>

                                    </div>
                                    <div class="col-4">
                                        <div class="row">
                                            <label class="col-form-label control-label col-1">
                                                :
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="row mt-lg-2">
                                    <div class="col-1">
                                    </div>
                                    <div class="col-1">
                                        <label class="col-form-label control-label col-11">
                                            MLPT (Ex: 100)
                                        </label>

                                    </div>
                                    <div class="col-4">
                                        <div class="row">
                                            <label class="col-form-label control-label col-1">
                                                :
                                            </label>
                                            @if (ViewBag.projectrevmlpt != null)
                                            {
                                                <label class="col-form-label control-label col-5">@ViewBag.projectrevmlpt.ProjectRevenue %</label>
                                            }
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="row mt-lg-2">
                                    <div class="col-1">
                                    </div>
                                    <div class="col-1">
                                        <label class="col-form-label control-label col-11">
                                            # Subcon
                                        </label>

                                    </div>
                                    <div class="col-4">
                                        <div class="row">
                                            <label class="col-form-label control-label col-1">
                                                :
                                            </label>
                                            @if (ViewBag.countsubcon != 0)
                                            {
                                                <label class="col-form-label control-label col-5">@ViewBag.countsubcon</label>
                                            }
                                        </div>
                                        
                                    </div>
                                </div>
                                <div class="row mt-lg-4" id="visibleTableRevSharingSubCon">
                                    <div class="col-2">
                                                
                                    </div>
                                    <div class="col-9">
                                        <div class="table-wrapper table-responsive-lg">
                                            <table class="table table-striped" style="font-size:small;vertical-align:middle" id="tableRevSharing">
                                                <thead style="background:darkGreen;color:white">
                                                    <tr>
                                                        <th scope="col">Subcon Name</th>
                                                        <th scope="col">%</th>
                                                        <th scope="col">High Level Scope</th>
                                                        <th scope="col">Preload</th>
                                                    </tr>
                                                </thead>
                                                <tbody id="bodyRevSharingSubCon">
                                                    
                                                    @foreach (var rev in ViewBag.projectrev)
                                                    {
                                                        <tr class="trRowRevSharing">
                                                            <td scope="col" class="tdSubconName">
                                                                @foreach (var item in @ViewBag.principles)
                                                                {
                                                                    if (item.Vendor == rev.PrincipalName)
                                                                    {
                                                                        <label class="col-form-label control-label" style='width: 250px'>@item.Vendor</label>
                                                                       break;
                                                                    }
                                                                }
                                                                <div class="mt-lg-2 divTxtOtherSubconName" hidden>
                                                                    <label class="col-form-label control-label">@rev.PrincipalName</label>
                                                                </div>

                                                            </td>
                                                            <td scope="col" class="tdPercent text-center">
                                                                <label class="col-form-label control-label" style="width:80px">@rev.ProjectRevenue</label>
                                                                @* <input class="form-control txtPercent" style="width:80px" type="text" value="@rev.ProjectRevenue"/> *@
                                                            </td>
                                                            <td scope="col" class="tdHighLvlScope">
                                                                <label class="col-form-label control-label" style="min-width:400px">@rev.PrincipalScope</label>
                                                                @* <input class="form-control txtHighLvlScope" style="min-width:400px" type="text" value="@rev.PrincipalScope"/> *@
                                                            </td>
                                                            <td scope="col" class="tdPreload text-center">
                                                                @foreach (var item in @ViewBag.principalpreload)
                                                                {
                                                                    if (item.Id == rev.Preload)
                                                                    {
                                                                        <label class="col-form-label control-label" style='width: 80px'>@item.Type</label>
                                                                        break;
                                                                    }
                                                                        
                                                                }
                                                            </td>
                                                        </tr>
                                                    }
                                                    
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                 </div>
                            </div>
                            <div class="form-group">
                                <div class="row mt-lg-2">
                                    <div class="col-2">
                                        <label class="col-form-label control-label col-11">
                                            Procurement Condition
                                        </label>
                                    </div>
                                    <div class="col-4">
                                        <div class="row">
                                            <label class="col-form-label control-label col-1">
                                                :
                                            </label>
                                            @if (ViewBag.riskassess != null)
                                            {
                                                <textarea class="form-control readonly-select" style="width:380px;height:100px" id="txtProcCondition">@ViewBag.riskassess.ProjectCondition</textarea>
                                                
                                            }
                                            else{
                                                <textarea class="form-control readonly-select" style="width:380px;height:100px" id="txtProcCondition"></textarea>

                                            }
                                            
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="row mt-lg-2">
                                    <div class="col-2">
                                        <label class="col-form-label control-label col-11">
                                            Predefined Condition Requested by Principal/Broker
                                        </label>

                                    </div>
                                    <div class="col-4">
                                        <div class="row">
                                            <label class="col-form-label control-label col-1">
                                                :
                                            </label>
                                            @if (ViewBag.riskassess != null)
                                            {
                                                <textarea class="form-control readonly-select" style="width:380px;height:100px" id="txtPredefinedCondition" >@ViewBag.riskassess.PredefinedConditionReqByPrincipal</textarea>
                                                
                                            }
                                            else{
                                                <textarea class="form-control readonly-select" style="width:380px;height:100px" id="txtPredefinedCondition"></textarea>

                                            }
                                            
                                        </div>

                                    </div>
                                </div>
                            </div>
                            <div class="row mt-lg-4">
                                <b>
                                    Risk Assessment Committee:
                                </b>
                            </div>
                            <div class="form-group">
                                <div class="row mt-lg-2">
                                    <div class="col-2">
                                        <label class="col-form-label control-label col-11">
                                            Assigned To
                                        </label>

                                    </div>
                                    <div class="col-4">
                                        <div class="row">
                                            <label class="col-form-label control-label col-1">
                                                :
                                            </label>
                                            <textarea class="form-control readonly-select" id="resultSelectedCommittee" style="width:380px;height:100px">@ViewBag.riskassignto</textarea>
                                         
                                            
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="row mt-lg-2">
                                    <div class="col-2">
                                        <label class="col-form-label control-label col-11">
                                            Committee
                                        </label>

                                    </div>
                                    <div class="col-4">
                                        <div class="row">
                                            <label class="col-form-label control-label col-1">
                                                :
                                            </label>
                                            <input class="form-control" style="width:250px" type="text" value=""  hidden/>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    }
                    else{
                        <div class="tab-pane fade" id="pills-risk" role="tabpanel" aria-labelledby="risk-tab">
                            <hr />
                            <b>External Factors</b>
                            <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                            @* <input type="hidden" asp-for="DocumentId" value="@Model.DocumentId" />
                            <input type="hidden" asp-for="Id" value="@Model.Id" /> *@
                            <div class="form-group">
                                <div class="row mt-lg-2">
                                    <div class="col-5">
                                        <div class="custom-control custom-checkbox">
                                            <input type="checkbox" class="form-check-input checkbox readonly-select"
                                                   style="border: 1px solid;">
                                            <label class="custom-control-label" for="customCheck1">New Product / 1st Implementation</label>
                                        </div>
                                    </div>
                                    <div class="col-5">
                                        <div class="custom-control custom-checkbox">
                                            <input type="checkbox" class="form-check-input checkbox readonly-select"
                                                   style="border: 1px solid;">
                                            <label class="custom-control-label" for="customCheck1">
                                                Tight Timeline
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="row mt-lg-2">
                                    <div class="col-5">
                                        <div class="custom-control custom-checkbox">
                                            <input type="checkbox" class="form-check-input checkbox readonly-select"
                                                   style="border: 1px solid;">
                                            <label class="custom-control-label" for="customCheck1">New Customer	</label>
                                        </div>
                                    </div>
                                    <div class="col-5">
                                        <div class="custom-control custom-checkbox">
                                            <input type="checkbox" class="form-check-input checkbox readonly-select"
                                                   style="border: 1px solid;">
                                            <label class="custom-control-label" for="customCheck1">
                                                Harsh Penalty
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="row mt-lg-2">
                                    <div class="col-5">
                                        <div class="custom-control custom-checkbox">
                                            <input type="checkbox" class="form-check-input checkbox readonly-select"
                                                   style="border: 1px solid;">
                                            <label class="custom-control-label" for="customCheck1">New Subcon / Vendor	</label>
                                        </div>
                                    </div>
                                    <div class="col-5">
                                        <div class="custom-control custom-checkbox">
                                            <input type="checkbox" class="form-check-input checkbox readonly-select"
                                                   style="border: 1px solid;">
                                            <label class="custom-control-label" for="customCheck1">
                                                Non IT Scope of Work
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="row mt-lg-2">
                                    <div class="col-5">
                                        <div class="custom-control custom-checkbox">
                                            <input type="checkbox" class="form-check-input checkbox readonly-select"
                                                   style="border: 1px solid;">
                                            <label class="custom-control-label" for="customCheck1">Multi Site / Roll Out	</label>
                                        </div>
                                    </div>
                                    <div class="col-5">
                                        <div class="custom-control custom-checkbox">
                                            <input type="checkbox" class="form-check-input checkbox readonly-select"
                                                   style="border: 1px solid;">
                                            <label class="custom-control-label" for="customCheck1">
                                                Customer Behavior (Highly Political/Baby Sitting)
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="row mt-lg-2">
                                    <div class="col-5">
                                        <div class="custom-control custom-checkbox">
                                            <input type="checkbox" class="form-check-input checkbox readonly-select"
                                                   style="border: 1px solid;">
                                            <label class="custom-control-label" for="customCheck1">Stringent Requirement	</label>
                                        </div>
                                    </div>
                                    <div class="col-5">
                                        <div class="custom-control custom-checkbox">
                                            <input type="checkbox" class="form-check-input checkbox readonly-select"
                                                   style="border: 1px solid;">
                                            <label class="custom-control-label" for="customCheck1">
                                                Application Implementation Project
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="row mt-lg-2">
                                    <div class="col-5">
                                        <div class="custom-control custom-checkbox">
                                            <input type="checkbox" class="form-check-input checkbox readonly-select"
                                                   style="border: 1px solid;">
                                            <label class="custom-control-label" for="customCheck1">Multi Subcon / Vendor	</label>
                                        </div>
                                    </div>
                                    <div class="col-5">
                                        <div class="custom-control custom-checkbox">
                                            <input type="checkbox" class="form-check-input checkbox readonly-select"
                                                   style="border: 1px solid;">
                                            <label class="custom-control-label" for="customCheck1">
                                                Unclear Scope
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="row mt-lg-2">
                                    <div class="col-5">
                                        <div class="custom-control custom-checkbox">
                                            <input type="checkbox" class="form-check-input checkbox readonly-select"
                                                   style="border: 1px solid;">
                                            <label class="custom-control-label" for="customCheck1">Multi Platform	</label>
                                        </div>
                                    </div>
                                    <div class="col-5">
                                        <div class="custom-control custom-checkbox">
                                            <input type="checkbox" class="form-check-input checkbox readonly-select"
                                                   style="border: 1px solid;">
                                            <label class="custom-control-label" for="customCheck1">
                                                Payment 100% After Project Completion
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row mt-lg-4">
                                <b>Internal Factors</b>
                            </div>
                            <div class="form-group">
                                <div class="row mt-lg-2">
                                    <div class="col-5">
                                        <div class="custom-control custom-checkbox">
                                            <input type="checkbox" class="form-check-input checkbox readonly-select"
                                                   style="border: 1px solid;">
                                            <label class="custom-control-label" for="customCheck1">
                                                Lack of Resource Capacity
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="row mt-lg-2">
                                    <div class="col-5">
                                        <div class="custom-control custom-checkbox">
                                            <input type="checkbox" class="form-check-input checkbox readonly-select"
                                                   style="border: 1px solid;">
                                            <label class="custom-control-label" for="customCheck1">
                                                Lack of Resource Capability
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="row mt-lg-2">
                                    <div class="col-5">
                                        <div class="custom-control custom-checkbox">
                                            <input type="checkbox" class="form-check-input checkbox readonly-select"
                                                   style="border: 1px solid;">
                                            <label class="custom-control-label" for="customCheck1">
                                                TOP does not Comply to MLPT Policy
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="row mt-lg-2">
                                    <div class="col-5">
                                        <div class="custom-control custom-checkbox">
                                            <input type="checkbox" class="form-check-input checkbox readonly-select"
                                                   style="border: 1px solid;">
                                            <label class="custom-control-label" for="customCheck1">
                                                GP Projection Less than Target
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row mt-lg-4">
                                <b style="color:#970000">
                                    Overall Risk:
                                </b>
                            </div>
                            <div class="row mt-lg-4">
                                <b>
                                    Risk Description:
                                </b>
                            </div>
                            <div class="row mt-lg-2">
                                <div class="col-7">
                                    <textarea class="form-control readonly-select" style="width:650px;height:100px"></textarea>
                                </div>
                            </div>
                            <div class="row mt-lg-4">
                                <b>
                                    Detail Assessment Information:
                                </b>
                            </div>
                            <div class="form-group">
                                <div class="row mt-lg-2">
                                    <div class="col-2">
                                        <label class="col-form-label control-label col-11">
                                            Source of Budget
                                        </label>

                                    </div>
                                    <div class="col-4">
                                        <div class="row">
                                            <label class="col-form-label control-label col-1">
                                                :
                                            </label>
                                            <input class="form-control" style="width:250px" type="text" value="" hidden />
                                        </div>
                                    </div>
                                    <div class="col-2">
                                        <label class="col-form-label control-label col-11">
                                            Est. Project Start
                                        </label>

                                    </div>
                                    <div class="col-4">
                                        <div class="row">
                                            <label class="col-form-label control-label col-1">
                                                :
                                            </label>
                                            <input class="form-control" style="width:250px" type="text" value="" hidden />
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="row mt-lg-2">
                                    <div class="col-2">
                                        <label class="col-form-label control-label col-11">
                                            Competition
                                        </label>

                                    </div>
                                    <div class="col-4">
                                        <div class="row">
                                            <label class="col-form-label control-label col-1">
                                                :
                                            </label>
                                            <input class="form-control" style="width:250px" type="text" value="" hidden />
                                        </div>
                                    </div>
                                    <div class="col-2">
                                        <label class="col-form-label control-label col-11">
                                            Est. Project End
                                        </label>

                                    </div>
                                    <div class="col-4">
                                        <div class="row">
                                            <label class="col-form-label control-label col-1">
                                                :
                                            </label>
                                            <input class="form-control" style="width:250px" type="text" value="" hidden />
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="row mt-lg-2">
                                    <div class="col-2">
                                        <label class="col-form-label control-label col-11">
                                            Contigency Cost
                                        </label>

                                    </div>
                                    <div class="col-4">
                                        <div class="row">
                                            <label class="col-form-label control-label col-1">
                                                :
                                            </label>
                                            <input class="form-control" style="width:250px" type="text" value="" hidden />
                                        </div>
                                    </div>
                                    <div class="col-2">
                                        <label class="col-form-label control-label col-11">
                                            Procurement Type
                                        </label>

                                    </div>
                                    <div class="col-4">
                                        <div class="row">
                                            <label class="col-form-label control-label col-1">
                                                :
                                            </label>
                                            <input class="form-control" style="width:250px" type="text" value="" hidden />
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="row mt-lg-2">
                                    <div class="col-2">
                                        <label class="col-form-label control-label col-11">
                                            Competitor
                                        </label>

                                    </div>
                                    <div class="col-4">
                                        <div class="row">
                                            <label class="col-form-label control-label col-1">
                                                :
                                            </label>
                                            <input class="form-control" style="width:250px" type="text" value="" hidden />
                                        </div>
                                    </div>
                                    <div class="col-2">
                                        <label class="col-form-label control-label col-11">
                                            Procurement Info
                                        </label>

                                    </div>
                                    <div class="col-4">
                                        <div class="row">
                                            <label class="col-form-label control-label col-1">
                                                :
                                            </label>
                                            <input class="form-control" style="width:250px" type="text" value="" hidden />
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="row mt-lg-2">
                                    <div class="col-2">
                                        <label class="col-form-label control-label col-11">
                                            Revenue Sharing
                                        </label>

                                    </div>
                                    <div class="col-4">
                                        <div class="row">
                                            <label class="col-form-label control-label col-1">
                                                :
                                            </label>
                                            <input class="form-control" style="width:250px" type="text" value="" hidden />
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="row mt-lg-2">
                                    <div class="col-1">
                                    </div>
                                    <div class="col-1">
                                        <label class="col-form-label control-label col-11">
                                            MLPT (Ex: 100)
                                        </label>

                                    </div>
                                    <div class="col-4">
                                        <div class="row">
                                            <label class="col-form-label control-label col-1">
                                                :
                                            </label>
                                            <input class="form-control" style="width:250px" type="text" value="" hidden />
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="row mt-lg-2">
                                    <div class="col-1">
                                    </div>
                                    <div class="col-1">
                                        <label class="col-form-label control-label col-11">
                                            # Subcon
                                        </label>

                                    </div>
                                    <div class="col-4">
                                        <div class="row">
                                            <label class="col-form-label control-label col-1">
                                                :
                                            </label>
                                            <input class="form-control" style="width:250px" type="text" value="" hidden />
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="row mt-lg-2">
                                    <div class="col-2">
                                        <label class="col-form-label control-label col-11">
                                            Procurement Condition
                                        </label>

                                    </div>
                                    <div class="col-4">
                                        <div class="row">
                                            <label class="col-form-label control-label col-1">
                                                :
                                            </label>
                                            <textarea class="form-control readonly-select" style="width:380px;height:100px"></textarea>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="row mt-lg-2">
                                    <div class="col-2">
                                        <label class="col-form-label control-label col-11">
                                            Predefined Condition Requested by Principal/Broker
                                        </label>

                                    </div>
                                    <div class="col-4">
                                        <div class="row">
                                            <label class="col-form-label control-label col-1">
                                                :
                                            </label>
                                            <textarea class="form-control readonly-select" style="width:380px;height:100px"></textarea>
                                        </div>

                                    </div>
                                </div>
                            </div>
                            <div class="row mt-lg-4">
                                <b>
                                    Risk Assessment Committee:
                                </b>
                            </div>
                            <div class="form-group">
                                <div class="row mt-lg-2">
                                    <div class="col-2">
                                        <label class="col-form-label control-label col-11">
                                            Assigned To
                                        </label>

                                    </div>
                                    <div class="col-4">
                                        <div class="row">
                                            <label class="col-form-label control-label col-1">
                                                :
                                            </label>
                                            <input class="form-control readonly-select" style="width:250px" type="text" value="" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="row mt-lg-2">
                                    <div class="col-2">
                                        <label class="col-form-label control-label col-11">
                                            Committee
                                        </label>

                                    </div>
                                    <div class="col-4">
                                        <div class="row">
                                            <label class="col-form-label control-label col-1">
                                                :
                                            </label>
                                            <input class="form-control" style="width:250px" type="text" value="" hidden />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    }
                    <div class="tab-pane fade" id="pills-details" role="tabpanel" aria-labelledby="details-tab">
                        <hr />
                        <div class="row mt-lg-4">
                            <div class="col-2">
                                <label class="col-form-label control-label"> Update Multiple Lines</label>
                            </div>
                        </div>
                        <div class="row mt-lg-1">
                            <div style="width:1000px">
                                <select id="selectViewDetails" onchange="changeViewDetails()" aria-label="Default select example" class="btn btn-outline-secondary" style="width:160px">
                                    <option selected="Complete">Complete View</option>
                                    <option value="Simple">Simple View</option>
                                    <option value="PO">PO View</option>
                                </select>
                                @if(Model.Stage == "Presales"){
                                    @if (ViewBag.useraccessam != null || ViewBag.useraccessSuperAdmin != null)
                                    {
                                        <a class="btn btn-outline-secondary" id="btn-update-revenue" data-bs-toggle="modal" data-bs-target="#UpdateRevenue">
                                            Update Revenue
                                        </a>
                                    }
                                    @if (ViewBag.useraccessta != null || ViewBag.useraccessSuperAdmin != null || ViewBag.useraccessproc != null)
                                    {
                                        <a class="btn btn-outline-secondary" id="btn-update-cogs" data-bs-toggle="modal" data-bs-target="#UpdateCOGS">
                                            Update COGS
                                        </a>
                                    }
                                    @if (ViewBag.useraccessSuperAdmin != null || ViewBag.useraccessprodmgr != null)
                                    {
                                        <a class="btn btn-outline-secondary" id="btn-update-risk" data-bs-toggle="modal" data-bs-target="#UpdateRisk">
                                            Update Risk
                                        </a>
                                    }
                                    if ( ViewBag.userammanager != null || ViewBag.useraccessSuperAdmin != null || ViewBag.useraccessprodmgr != null)
                                    {
                                        <a class="btn btn-outline-secondary" id="btn-update-review" data-bs-toggle="modal" data-bs-target="#UpdateReview">
                                            Review Items
                                        </a>
                                    }
                                    @if (ViewBag.useraccesspresales != null || ViewBag.useraccessSuperAdmin != null || ViewBag.useraccessprodmgr != null)
                                    {
                                        <a class="btn btn-outline-secondary" id="btn-assign-pm" data-bs-toggle="modal" data-bs-target="#AssignPM">
                                            Assign Prod Mgr
                                        </a>
                                    }
                                }
                                else if(Model.Stage == "Delivery"){
                                    @* <a class="btn btn-outline-secondary" id="btn-update-cogs" data-bs-toggle="modal" data-bs-target="#UpdateCOGS">
                                        Update COGS
                                    </a> *@
                                    @if (ViewBag.useraccessproc != null || ViewBag.useraccessSuperAdmin != null)
                                    {
                                        <a class="btn btn-outline-secondary" id="btn-add-po" data-bs-toggle="modal" data-bs-target="#AddPO">
                                            Add PO Data
                                        </a>
                                    }
                                    @if (ViewBag.useraccesspm != null || ViewBag.useraccessproc != null || ViewBag.useraccessps != null || ViewBag.useraccesspc != null || ViewBag.useraccesspmohead != null || ViewBag.useraccessSuperAdmin != null)
                                    {
                                        <a class="btn btn-outline-secondary" id="btn-update-po" data-bs-toggle="modal" data-bs-target="#UpdatePO">
                                            Update PO Data
                                        </a>
                                    }
                                    @if (ViewBag.useraccesspm != null || ViewBag.useraccesspmohead != null || ViewBag.useraccesspc != null || ViewBag.useraccessSuperAdmin != null)
                                    {
                                        <a class="btn btn-outline-secondary" asp-controller="PreProcs" asp-action="ShowRDL" asp-route-type="" asp-route-id="@Model.ListItemId" target="_blank">Print PO Data</a>
                                    }
                                    @if (ViewBag.useraccesspmo != null || ViewBag.useraccesspmohead != null || ViewBag.useraccessSuperAdmin != null)
                                    {
                                        <a class="btn btn-outline-secondary" id="btn-browse-po" data-bs-toggle="modal" data-bs-target="#BrowsePO">
                                            Browse PO
                                        </a>
                                    }
                                    @if (ViewBag.useraccesswh != null || ViewBag.useraccessSuperAdmin != null)
                                    {
                                        <a class="btn btn-outline-secondary" id="btn-update-gr" data-bs-toggle="modal" data-bs-target="#UpdateGR">
                                            Update GR Data
                                        </a>
                                    }
                                }
                                
                            </div>
                            <div style="width:500px">
                                <div class="row">
                                    <label class="col-form-label control-label col-3">
                                       Filter By PID :
                                    </label>
                                    
                                    <div class="input-group" style="width:300px">
                                        <input type="search" id="searchpid" value="@Model.Pid" class="form-control" style="width:200px" name="searchpid"/>
                                        @* <button class="btn btn-outline-secondary" type="submit" id="inputGroupFileAddon04" >Search</button> *@
                                        <a asp-controller="PreProcs" asp-action="GetItemDetailFromSearch" asp-route-procid="@Model.Id" class="btn btn-outline-secondary">Search</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                        @if(Model.Stage != "Delivery"){
                        <div class="table-wrapper table-responsive-lg mt-lg-4" style="min-width:2000px;max-height:600px">                          <table id="tblData" class="table table-bordered table-striped border-white" style="font-size:small;vertical-align:middle">
                                <thead style="background:darkGreen;color:white">
                                    <tr>
                                        <th scope="col"></th>
                                        <th scope="col">No</th>
                                        <th scope="col"></th>
                                        <th scope="col" class="visiblePrincipal completeView">Principal/Manufacturer</th>
                                        <th scope="col" class="visibleItemDesc completeView">Item Description</th>
                                        <th scope="col" class="visibleInsurance completeView">Insurance</th>
                                        <th scope="col" class="visibleWarranty completeView">Warranty (Month)</th>
                                        <th scope="col" class="visibleSpecRKS completeView">Spec RKS</th>
                                        <th scope="col" class="visibleSurDuk completeView">SurDuk</th>
                                        <th scope="col" class="visibleQty completeView">Qty</th>
                                        <th scope="col" class="visibleCurrency completeView">Currency</th>
                                        <th scope="col" class="visibleUnitCOGS completeView">Unit COGS</th>
                                        <th scope="col" class="visibleUnitRevenue completeView">Unit Revenue	</th>
                                        <th scope="col" class="visibleTotalCOGS completeView">Total COGS</th>
                                        <th scope="col" class="visibleTotalRevenue completeView">Total Revenue</th>
                                        <th scope="col" class="visiblePM completeView">Product Manager</th>
                                        <th scope="col" class="visibleVendor completeView">Vendor</th>
                                        <th scope="col" class="visibleVendorQuot completeView">Vendor Quotation/SOW</th>
                                        <th scope="col" class="visibleRisk completeView">Risk</th>
                                        <th scope="col" class="visiblePresalesReview completeView">Presales Review	</th>
                                        <th scope="col" class="visibleAMReview completeView">
                                            AM Manager
                                        </th>
                                    </tr>
                                </thead>
                                <tbody id="tabelnewitem">
                                    @if(ViewBag.itemdetail != null)
                                    {
                                        @foreach (var itemdet in ViewBag.itemdetail)
                                        {
                                            <tr class="linedetailitem">
                                                <td class='tdControl col-1' style='padding-right: 0px; padding-left: 0px; text-align: center; vertical-align: middle;min-width:100px'>
                                                    @if(ViewBag.useraccesswh == null)
                                                    {
                                                        <a class='btn btn-outline-success btn-edit' style='font-size: 12px; padding: 7px!important;'>E</a>
                                                        <a class='btn btn-outline-danger btn-delete' style='font-size: 12px; padding: 7px!important;margin-right: 5px;margin-left: 5px; '>D</a>
                                                        <a class='btn btn-outline-primary btn-copy' style='font-size: 12px; padding: 7px!important;'>C</a>
                                                    }
                                                    
                                                </td>
                                                <td class="tdNo col-1 text-center">
                                                    @itemdet.Idnew
                                                </td>
                                                <input type='hidden' class='txtCommentPresalesHidden' style='border: 1px solid;font-size:large;' value=''>
                                                <input type='hidden' class='txtCommentAMHidden' style='border: 1px solid;font-size:large;' value=''>
                                                <td class="tdCheckItem text-center">
                                                    <input type="checkbox" class="form-check-input checkItem"
                                                                style="border: 1px solid;font-size:large;" value="@itemdet.DetailId">
                                                </td>
                                                <td class="tdPrincipal visiblePrincipal completeView">
                                                    @itemdet.Principle
                                                    <br>
                                                    <select class='form-select form-control txtPrincipal' style='width: 250px' id='selectPrincipal'     runat='server' name='Principal' hidden>
                                                        <option value=''>(Please Select)</option>
                                                        @foreach (var item in @ViewBag.principles)
                                                        {
                                                            @if(itemdet.Principle == item.Vendor){
                                                                <option value='@item.Vendor' selected> @item.Vendor</option>                                                                
                                                            }
                                                            else{
                                                                <option value='@item.Vendor'> @item.Vendor</option>
                                                            }
                                                        }
                                                    </select>
                                                </td>
                                                <td class="tdItemDesc col-1 visibleItemDesc completeView">
                                                    @itemdet.ItemDesc
                                                    <br>
                                                    <select class='form-select form-control txtItemDesc' hidden style='width: 250px' id='selectItemDesc' runat='server' name='ItemDesc'>
                                                        <option value=''>(Please Select)</option>
                                                        @foreach (var item in ViewBag.itemdescsall)
                                                        {
                                                            @if(itemdet.Nkpcode == item.NkpcodeLinkTitle){
                                                                <option value='@item.NkpcodeLinkTitle' selected> @item.Nkpname</option>
                                                            }
                                                            else{
                                                               <option value='@item.NkpcodeLinkTitle'> @item.Nkpname</option>
                                                            }
                                                        }
                                                    </select>
                                                    <input class='form-control txtItemDescOthers mt-lg-2' style='width:100%; font-size: 13px;display:none' type='text' value='' hidden>
                                                </td>
                                                    <input class='form-control txtNKPCode' type="hidden" value="@itemdet.Nkpcode">
                                                    <input class='form-control txtDetailId' type="hidden" value="@itemdet.DetailId">
                                                <td class="tdPreProcId col-1" hidden>
                                                    <input class='form-control txtPreProcId' type="hidden" value="@Model.Id">
                                                </td>

                                                @if (@itemdet.Insurance == true)
                                                {
                                                    <td class="tdInsurance text-center visibleInsurance completeView">
                                                        Y
                                                    </td>
                                                }
                                                else
                                                {
                                                    <td class="tdInsurance text-center visibleInsurance completeView">
                                                        N
                                                    </td>
                                                }
                                                <td class="tdWarranty visibleWarranty completeView">
                                                    @itemdet.Warranty
                                                </td>
                                                <td class="tdSpecRKS text-center visibleSpecRKS completeView">
                                                    @if(ViewBag.fileattach != null)
                                                    {
                                                        @foreach (var file in ViewBag.fileattach)
                                                        {
                                                            if(file.DocumentTypeId == 11 && file.Bastid == itemdet.DetailId)
                                                            {
                                                                <a  class='btn-down-spec' id='@file.Id' style='font-size: 12px; padding: 7px!important;margin-right: 5px;margin-left: 5px;' href='/Preprocs/GetFileAttachment?target=@file.StrictedFileName;@file.FileName'>@file.FileName</a><br/><br/>
                                                            }
                                                        }
                                                    }
                                                    
                                                </td>
                                                <input class='form-control txtIDAttachSpec' type='hidden' value=''>
                                                <input class='form-control txtIDAttachSurduk' type='hidden' value=''>
                                                <input class='form-control txtIDAttachVendorQuot' type='hidden' value=''>
                                                @if (@itemdet.SurDukCheck == true)
                                                {
                                                    <td class="tdSurDuk text-center visibleSurDuk completeView" style="min-width: 200px;">
                                                        @if(ViewBag.fileattach != null)
                                                    {
                                                        @foreach (var file in ViewBag.fileattach)
                                                        {
                                                            if(file.DocumentTypeId == 12 && file.Bastid == itemdet.DetailId)
                                                            {
                                                                    <a class='btn-down-spec' id='@file.Id' style='font-size: 12px; padding: 7px!important;margin-right: 5px;margin-left: 5px;' href='/Preprocs/GetFileAttachment?target=@file.StrictedFileName;@file.FileName'>@file.FileName</a>

                                                                    <br />
                                                                    <br />
                                                            }
                                                        }
                                                    }
                                                    </td>
                                                }
                                                else
                                                {
                                                    <td class="tdSurDuk text-center visibleSurDuk completeView" style="min-width: 200px;">
                                                        N
                                                    </td>
                                                }
                                                <td class="tdQty col-1 visibleQty completeView">
                                                    @itemdet.Qty
                                                </td>
                                                <td scope="col" class="tdCurrency visibleCurrency completeView">@itemdet.Currency</td>
                                                <td scope="col" class="tdUnitCOGS visibleUnitCOGS completeView">@itemdet.UnitCogs</td>
                                                <td scope="col" class="tdUnitRevenue visibleUnitRevenue completeView">@itemdet.UnitPrice</td>
                                                <td scope="col" class="tdTotalCOGS visibleTotalCOGS completeView">@itemdet.TotalCogs</td>
                                                <td scope="col" class="tdTotalRevenue visibleTotalRevenue completeView">@itemdet.TotalPrice</td>
                                                @if (itemdet.ProductManager != null)
                                                {
                                                    @foreach (var prod in ViewBag.prodmgr)
                                                    {
                                                        @if (itemdet.ProductManager == prod.Domain)
                                                        {
                                                            <td scope="col" class="tdPM visiblePM completeView">
                                                                @prod.ProductManager
                                                            </td>
                                                            break;
                                                        }
                                                    }
                                                }
                                                else{
                                                     <td scope="col" class="tdPM visiblePM completeView">
                                                    </td>
                                                }
                                               
                                                <td scope="col" class="tdVendor visibleVendor completeView">@itemdet.Vendor</td>
                                                <td scope="col" class="tdVendorQuot visibleVendorQuot completeView text-center">
                                                    @if(ViewBag.fileattach != null)
                                                    {
                                                        @foreach (var file in ViewBag.fileattach)
                                                        {
                                                            if(file.DocumentTypeId == 13 && file.Bastid == itemdet.DetailId)
                                                            {
                                                                <a  class='btn-down-spec' id='@file.Id' style='font-size: 12px; padding: 7px!important;margin-right: 5px;margin-left: 5px;' href='/Preprocs/GetFileAttachment?target=@file.StrictedFileName;@file.FileName'>@file.FileName</a><br/><br/>
                                                            }
                                                        }
                                                    }
                                                </td>
                                                <td scope="col" class="tdRisk visibleRisk completeView">@itemdet.Risk</td>
                                                <td scope="col" class="tdPresalesReview visiblePresalesReview completeView">@itemdet.PresalesReview</td>
                                                <td scope="col" class="tdAMReview visibleAMReview completeView">@itemdet.AmmanagerApproval</td>
                                            </tr>
                                            <tr class="lineremark">
                                                <td></td>
                                                <td></td>
                                                <td></td>
                                                <td><label class="col-form-label control-label text-red" style="min-width:120px"> Remarks on Item:</label></td>
                                                    <td class="tdRemark text-red">@itemdet.RemarkOnItem</td>
                                            </tr>
                                        }
                                        
                                    }
                                    <tr id="emptyRow" hidden>
                                            <input class='form-control txtNKPCode' type="hidden" value="">
                                            <input class='form-control txtDetailId' type="hidden" value="">
                                        <td class="tdPreProcId col-1" hidden>
                                            <input class='form-control txtPreProcId' type="hidden" value="@Model.Id">
                                        </td>
                                        <td class='tdControl col-1' style='padding-right: 0px; padding-left: 0px; text-align: center; vertical-align: middle;min-width:100px'>
                                            <a class='btn btn-outline-primary btn-submit' style='font-size: 12px; padding: 7px!important;'>
                                                Add/Save Item
                                            </a>
                                        </td>
                                        <td class="tdNo col-1 text-center">
                                            <input class='form-control txtNo' style='width:70px; font-size: 13px' type='text' value=''>
                                        </td>
                                        <td class="tdCheckItem text-center">
                                        </td>
                                        <td class="tdPrincipal visiblePrincipal completeView">
                                            <select class='form-select form-control txtPrincipal' style='width: 250px' id='selectPrincipal' runat='server' name='Principal'>
                                                <option selected=''>(Please Select)</option>
                                                @foreach (var item in @ViewBag.principles)
                                                {
                                                    <option value='@item.Vendor'> @item.Vendor</option>
                                                }
                                            </select>
                                        </td>
                                        <td class="tdItemDesc col-1 visibleItemDesc completeView">
                                            <select class='form-select form-control txtItemDesc' style='width: 250px' id='selectItemDesc' runat='server' name='ItemDesc'>
                                                <option selected=''>(Please Select)</option>
                                                @foreach (var item in ViewBag.itemdescs)
                                                {
                                                    <option value='@item.NkpcodeLinkTitle'> @item.Nkpname</option>
                                                }
                                            </select>
                                            <input class='form-control txtItemDescOthers mt-lg-2' style='width:100%; font-size: 13px;display:none' type='text' value=''>
                                        </td>
                                        <td class="tdInsurance text-center visibleInsurance completeView">
                                            <input name="Hedging" type="checkbox" class="txtInsurance form-check-input checkbox"
                                                      style="border: 1px solid;">
                                        </td>
                                        <td class="tdWarranty visibleWarranty completeView">
                                            <input class='form-control txtWarranty' style='width:100%; font-size: 13px' type='text' value=''>
                                        </td>
                                        <td class="tdSpecRKS text-center visibleSpecRKS completeView">
                                            <a class="btn btn-outline-secondary mt-lg-2 AttachSpecRKS" style="font-size: 12px; padding: 3px!important;min-width:80px" data-bs-toggle="modal" data-bs-target="#uploadSpec">
                                                Attach File
                                            </a>
                                        </td>
                                        <input class='form-control txtIDAttachSpec' type='hidden' value=''>
                                        <input class='form-control txtIDAttachSurduk' type='hidden' value=''>
                                        <input class='form-control txtIDAttachVendorQuot' type='hidden' value=''>
                                        <td class="tdSurDuk text-center visibleSurDuk completeView" style="min-width: 200px;">
                                            <input name="Hedging" type="checkbox" class="txtSurDuk form-check-input checkbox"
                                                   style="border: 1px solid;" value="true">
                                            <br>
                                            <a class="btn btn-outline-secondary mt-lg-2 AttachSurDuk" style="min-width:80px;visibility:hidden;font-size: 12px; padding: 3px!important;" data-bs-toggle="modal" data-bs-target="#uploadSurDuk">
                                                Attach File
                                            </a>
                                        </td>
                                        <td class="tdQty col-1 visibleQty completeView">
                                            <input class='form-control txtQty' style='width:70px; font-size: 13px' type='text' value=''>
                                        </td>
                                        <td scope="col" class="tdCurrency visibleCurrency completeView"></td>
                                        <td scope="col" class="tdUnitCOGS visibleUnitCOGS completeView"></td>
                                        <td scope="col" class="tdUnitRevenue visibleUnitRevenue completeView"></td>
                                        <td scope="col" class="tdTotalCOGS visibleTotalCOGS completeView"></td>
                                        <td scope="col" class="tdTotalRevenue visibleTotalRevenue completeView"></td>
                                        <td scope="col" class="tdPM visiblePM completeView"></td>
                                        <td scope="col" class="tdVendor visibleVendor completeView"></td>
                                        <td scope="col" class="tdVendorQuot visibleVendorQuot completeView text-center"></td>
                                        <td scope="col" class="tdRisk visibleRisk completeView"></td>
                                        <td scope="col" class="tdPresalesReview visiblePresalesReview completeView"></td>
                                        <td scope="col" class="tdAMReview visibleAMReview completeView"></td>
                                    </tr>

                                </tbody>
                            </table>
                        </div>
                        }
                        @* Item Detail Delivery *@
                        @if(Model.Stage == "Delivery"){
                            <div class="table-wrapper table-responsive-lg mt-lg-4" style="min-width:2000px;max-height:600px">                          <table id="tblDataDelivery" class="table table-bordered table-striped border-white" style="font-size:small;vertical-align:middle">
                                <thead style="background:darkGreen;color:white">
                                    <tr>
                                        <th scope="col"></th>
                                        <th scope="col">No</th>
                                        <th scope="col"></th>
                                        <th scope="col">PID</th>
                                        <th scope="col" class="visiblePrincipal completeView">Principal/Manufacturer</th>
                                        <th scope="col" class="visibleItemDesc completeView">Item Description</th>
                                        <th scope="col" class="visibleInsurance completeView">Insurance</th>
                                        <th scope="col" class="visibleWarranty completeView">Warranty (Month)</th>
                                        <th scope="col" class="visibleSpecRKS completeView">Spec RKS</th>
                                        <th scope="col" class="visibleSurDuk completeView">SurDuk</th>
                                        <th scope="col" class="visibleQty completeView">Qty</th>
                                        <th scope="col" class="visibleCurrency completeView">Currency</th>
                                        <th scope="col" class="visibleUnitCOGS completeView">Unit COGS</th>
                                        <th scope="col" class="visibleUnitRevenue completeView">Unit Revenue	</th>
                                        <th scope="col" class="visibleTotalCOGS completeView">Total COGS</th>
                                        <th scope="col" class="visibleTotalRevenue completeView">Total Revenue</th>
                                        <th scope="col" class="visiblePM completeView">Product Manager</th>
                                        <th scope="col" class="visibleVendor completeView">Vendor</th>
                                        <th scope="col" class="visibleVendorQuot completeView">Vendor Quotation/SOW</th>
                                        <th scope="col" class="">PO Data</th>
                                        <th scope="col" class="visibleGRN completeView">GRN	</th>
                                    </tr>
                                </thead>
                                <tbody id="tabelnewitem">
                                    @if(ViewBag.itemdetail != null)
                                    {
                                        @foreach (var itemdet in ViewBag.itemdetail)
                                        {
                                            <tr>
                                                <td class='tdControl col-1' style='padding-right: 0px; padding-left: 0px; text-align: center; vertical-align: middle;min-width:100px'>
                                                    @if (ViewBag.useraccessproc != null || ViewBag.useraccessSuperAdmin != null)
                                                        {
                                                            <a class='btn btn-outline-success btn-edit' style='font-size: 12px; padding: 7px!important;'>E</a>
                                                        }
                                                    
                                                </td>
                                                <td class="tdNo col-1 text-center" style="min-width:55px">
                                                    @itemdet.Idnew
                                                </td>
                                                <td class="tdCheckItem text-center">
                                                    <input type="checkbox" class="form-check-input checkItem"
                                                                style="border: 1px solid;font-size:large;" value="@itemdet.DetailId">
                                                </td>
                                                <td class="tdPID">@itemdet.Pidfull</td>
                                                <td class="tdPrincipal visiblePrincipal completeView">
                                                    @itemdet.Principle
                                                    <br>
                                                    
                                                    <select class='form-select form-control txtPrincipal' style='width: 250px' id='selectPrincipal'     runat='server' name='Principal' hidden>
                                                        <option value=''>(Please Select)</option>
                                                        @foreach (var item in @ViewBag.principles)
                                                        {
                                                            @if(itemdet.Principle == item.Vendor){
                                                                <option value='@item.Vendor' selected> @item.Vendor</option>                                                                
                                                            }
                                                            else{
                                                                <option value='@item.Vendor'> @item.Vendor</option>
                                                            }
                                                        }
                                                    </select>
                                                </td>
                                                <td class="tdItemDesc col-1 visibleItemDesc completeView" style="min-width: 500px;">
                                                    @itemdet.ItemDesc
                                                    <br>
                                                    
                                                    <select class='form-select form-control txtItemDesc' hidden style='width: 250px' id='selectItemDesc' runat='server' name='ItemDesc'>
                                                        <option value=''>(Please Select)</option>
                                                        @foreach (var item in ViewBag.itemdescsall)
                                                        {
                                                            @if(itemdet.Nkpcode == item.NkpcodeLinkTitle){
                                                                <option value='@item.NkpcodeLinkTitle' selected> @item.Nkpname</option>
                                                            }
                                                            else{
                                                               <option value='@item.NkpcodeLinkTitle'> @item.Nkpname</option>
                                                            }
                                                        }
                                                    </select>
                                                    <input class='form-control txtItemDescOthers mt-lg-2' style='width:100%; font-size: 13px;display:none' type='text' value='' hidden>
                                            <textarea class="form-control txtRemark mt-lg-2" placeholder="(Type remark here)" style="width:250px;height:50px" hidden>@itemdet.RemarkOnItem</textarea>
                                                </td>
                                                    <input class='form-control txtNKPCode' type="hidden" value="@itemdet.Nkpcode">
                                                    <input class='form-control txtDetailId' type="hidden" value="@itemdet.DetailId">
                                                <td class="tdPreProcId col-1" hidden>
                                                    <input class='form-control txtPreProcId' type="hidden" value="@Model.Id">
                                                </td>

                                                @if (@itemdet.Insurance == true)
                                                {
                                                    <td class="tdInsurance text-center visibleInsurance completeView">
                                                        Y
                                                    </td>
                                                }
                                                else
                                                {
                                                    <td class="tdInsurance text-center visibleInsurance completeView">
                                                        N
                                                    </td>
                                                }
                                                <td class="tdWarranty visibleWarranty completeView">
                                                    @itemdet.Warranty
                                                </td>
                                                <td class="tdSpecRKS text-center visibleSpecRKS completeView">
                                                    @if(ViewBag.fileattach != null)
                                                    {
                                                        @foreach (var file in ViewBag.fileattach)
                                                        {
                                                            if(file.DocumentTypeId == 11 && file.Bastid == itemdet.DetailIdold)
                                                            {
                                                                <a  class='btn-down-spec' id='@file.Id' style='font-size: 12px; padding: 7px!important;margin-right: 5px;margin-left: 5px;' href='/Preprocs/GetFileAttachment?target=@file.StrictedFileName;@file.FileName'>@file.FileName</a><br />
                                                            }
                                                        }
                                                    }
                                                </td>
                                                <input class='form-control txtIDAttachSpec' type='hidden' value=''>
                                                <input class='form-control txtIDAttachSurduk' type='hidden' value=''>
                                                <input class='form-control txtIDAttachVendorQuot' type='hidden' value=''>
                                                @if (@itemdet.SurDukCheck == true)
                                                {
                                                    <td class="tdSurDuk text-center visibleSurDuk completeView" style="min-width: 200px;">
                                                        @if(ViewBag.fileattach != null)
                                                    {
                                                        @foreach (var file in ViewBag.fileattach)
                                                        {
                                                            if(file.DocumentTypeId == 12 && file.Bastid == itemdet.DetailIdold)
                                                            {
                                                                    <a class='btn-down-spec' id='@file.Id' style='font-size: 12px; padding: 7px!important;margin-right: 5px;margin-left: 5px;' href='/Preprocs/GetFileAttachment?target=@file.StrictedFileName;@file.FileName'>@file.FileName</a>

                                                                    <br />
                                                            }
                                                        }
                                                    }
                                                    </td>
                                                }
                                                else
                                                {
                                                        <td class="tdSurDuk text-center visibleSurDuk completeView" style="min-width: 200px;">
                                                        N
                                                    </td>
                                                }
                                                <td class="tdQty col-1 visibleQty completeView">
                                                    @itemdet.Qty
                                                </td>
                                                <td scope="col" class="tdCurrency visibleCurrency completeView">@itemdet.Currency</td>
                                                <td scope="col" class="tdUnitCOGS visibleUnitCOGS completeView">@itemdet.UnitCogs</td>
                                                <td scope="col" class="tdUnitRevenue visibleUnitRevenue completeView">@itemdet.UnitPrice</td>
                                                <td scope="col" class="tdTotalCOGS visibleTotalCOGS completeView">@itemdet.TotalCogs</td>
                                                <td scope="col" class="tdTotalRevenue visibleTotalRevenue completeView">@itemdet.TotalPrice</td>
                                                <td scope="col" class="tdPM visiblePM completeView">@itemdet.ProductManager</td>
                                                <td scope="col" class="tdVendor visibleVendor completeView">@itemdet.Vendor</td>
                                                    <td scope="col" class="tdVendorQuot visibleVendorQuot completeView text-center">
                                                        @if(ViewBag.fileattach != null)
                                                    {
                                                        @foreach (var file in ViewBag.fileattach)
                                                        {
                                                            if(file.DocumentTypeId == 13 && file.Bastid == itemdet.DetailId)
                                                            {
                                                                <a  class='btn-down-spec' id='@file.Id' style='font-size: 12px; padding: 7px!important;margin-right: 5px;margin-left: 5px;' href='/Preprocs/GetFileAttachment?target=@file.StrictedFileName;@file.FileName'>@file.FileName</a><br/><br/>
                                                            }
                                                        }
                                                    }
                                                    </td>
                                                <td scope="col" class="tdVendor visiblePOData completeView">
                                                    @{
                                                        var count = 0;
                                                    }
                                                    @foreach (var datapo in ViewBag.datapo)
                                                    {
                                                        @if (datapo.Idnew == itemdet.Idnew)
                                                            {
                                                                count++;
                                                            }
                                                    }
                                                    @if(ViewBag.datapo.Count > 0 && count > 0)
                                                    {
                                                    <div class="table-wrapper table-responsive-lg" style="width:1100px;min-height:50px">
                                                                <table class="table tblPO table-borderless" style="font-size:small;vertical-align:middle">
                                                            <thead>
                                                                <tr>
                                                                    <th scope="col" style="background:transparent;color:black"><b>Exp PO Issued Dt</b></th>
                                                                    <th scope="col" style="background:transparent;color:black"><b>ETD</b></th>
                                                                    <th scope="col" style="background:transparent;color:black"><b>PO Number</b></th>
                                                                    <th scope="col" style="background:transparent;color:black"><b>PO Item</b></th>
                                                                    <th scope="col" style="background:transparent;color:black"><b>NKS</b></th>
                                                                    <th scope="col" style="background:transparent;color:black"><b>PO Date</b></th>
                                                                    <th scope="col" style="background:transparent;color:black"><b>PO Qty</b></th>
                                                                    <th scope="col" style="background:transparent;color:black"><b>ETA</b></th>
                                                                    <th scope="col" style="background:transparent;color:black"><b>Vendor</b></th>
                                                                    <th scope="col" style="background:transparent;color:black"><b>GR Date</b></th>
                                                                    <th scope="col" style="background:transparent;color:black"><b>GR Qty</b></th>
                                                                    <th scope="col" style="background:transparent;color:black"><b>GR Backlog</b></th>
                                                                </tr>
                                                            </thead>
                                                            <tbody>
                                                                @foreach (var datapo in ViewBag.datapo)
                                                                {
                                                                    @if (datapo.Idnew == itemdet.Idnew)
                                                                        {
                                                                        <tr>
                                                                            @if(datapo.ExpectedPoissuedDate != null){
                                                                                <td class="tdPID text-center" style="background:transparent;width:85px">
                                                                                    @datapo.ExpectedPoissuedDate.ToString("dd MMM yy")
                                                                                </td>
                                                                            }
                                                                            else{
                                                                                <td class="tdPID text-center" style="background:transparent;width:90px">@datapo.ExpectedPoissuedDate</td>
                                                                            }
                                                                            @if(datapo.Etd != null){
                                                                                <td class="tdQty text-center" style="background:transparent;width:90px">
                                                                                    @datapo.Etd.ToString("dd MMM yy")
                                                                                </td>
                                                                            }
                                                                            else{
                                                                                <td class="tdQty text-center" style="background:transparent;width:90px">
                                                                                    @datapo.Etd
                                                                                </td>
                                                                            }
                                                                            <td scope="col" class="tdCurrency text-center" style="background:transparent;width:90px"><a class='text-danger btn-remove-po'><b><i class='bi bi-x-lg'></i></b></a> @datapo.Poid</td>
                                                                            <td scope="col" class="tdUnitCOGS" style="background:transparent;;width:300px">@datapo.ItemDescription</td>
                                                                            <td scope="col" class="tdUnitRevenue" style="background:transparent;width:90px">@datapo.ItemNo</td>
                                                                            <td scope="col" class="tdTotalCOGS text-center" style="background:transparent;width:90px">@datapo.Podate.ToString("dd MMM yy")</td>
                                                                                <td scope="col" class="tdTotalRevenue text-center" style="background:transparent;width:65px">@datapo.Poqty                                                      @if(@datapo.Poqty > 0){
                                                                                        @datapo.Uom
                                                                                    }
                                                                                </td>
                                                                                @if(datapo.Eta != null){
                                                                                    <td class="tdQty text-center" style="background:transparent;width:90px">
                                                                                        @datapo.Eta.ToString("dd MMM yy")
                                                                                    </td>
                                                                                }
                                                                                else{
                                                                                   <td scope="col" class="tdPM text-center" style="background:transparent;width:90px">@datapo.Eta</td>
                                                                                }
                                                                            
                                                                            <td scope="col" class="tdVendor" style="background:transparent">@datapo.VendorName</td>
                                                                            <td scope="col" class="tdGRDate text-center" style="background:transparent;width:90px">
                                                                                @if(datapo.Grdate != null){
                                                                                    @datapo.Grdate.ToString("dd MMM yy")

                                                                                }
                                                                                else{
                                                                                   @datapo.Grdate
                                                                                }
                                                                            </td>
                                                                            <td scope="col" class="tdGRQty text-center" style="background:transparent;width:65px">@datapo.Grqty</td>
                                                                            <td scope="col" class="tdGRBacklog" style="background:transparent">@datapo.Grbacklog</td>
                                                                        </tr>       
                                                                    }
                                                                }
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                    }
                                                </td>
                                                <td scope="col" class="tdVendorQuot visibleGRN completeView text-center">
                                                    @if(ViewBag.fileattach != null)
                                                    {
                                                        @foreach (var file in ViewBag.fileattach)
                                                        {
                                                            if(file.DocumentTypeId == 19 && file.Bastid == itemdet.DetailId)
                                                            {
                                                                    <a class='btn-down-spec' id='@file.Id' style='font-size: 12px; padding: 7px!important;' href='/Preprocs/GetFileAttachment?target=@file.StrictedFileName;@file.FileName'>@file.FileName</a>

                                                                    <br />

                                                                    <br />
                                                            }
                                                        }
                                                    }

                                                </td>
                                            </tr>
                                            <tr class="trRemark">
                                                <td></td>
                                                <td></td>
                                                <td></td>
                                                <td><label class="col-form-label control-label text-red" style="min-width:120px"> Remarks on Item:</label></td>
                                                    <td class="tdRemark text-red">@itemdet.RemarkOnItem</td>
                                                    <input class='form-control txtDetailIdRemark' type="hidden" value="@itemdet.DetailId">
                                            </tr>
                                        }
                                        
                                    }
                                </tbody>
                            </table>
                        </div>
                        }

                        @* <div class="table-wrapper table-responsive-lg mt-lg-4">
                            <table id="tblData" class="table" style="font-size:small">
                                <thead style="background:darkGreen;color:white">
                                    <tr>
                                        <th scope="col"></th>
                                        <th scope="col">No</th>
                                        <th scope="col"></th>
                                        <th scope="col">Principal/Manufacturer</th>
                                        <th scope="col">Item Description</th>
                                        <th scope="col">Insurance</th>
                                        <th scope="col">Warranty (Month)</th>
                                        <th scope="col">Spec RKS</th>
                                        <th scope="col">SurDuk</th>
                                        <th scope="col">Qty</th>
                                        <th scope="col">Currency</th>
                                        <th scope="col">Unit COGS</th>
                                        <th scope="col">Unit Revenue	</th>
                                        <th scope="col">Total COGS</th>
                                        <th scope="col">Total Revenue</th>
                                        <th scope="col">Product Manager</th>
                                        <th scope="col">Vendor Quotation/SOW</th>
                                        <th scope="col">Risk</th>
                                        <th scope="col">Presales Review	</th>
                                        <th scope="col">
                                            AM Manager
                                        </th>
                                    </tr>
                                </thead>
                                <tbody id="tabelnewitem">
                                </tbody>
                            </table>
                        </div> *@
                        <div class="row mt-lg-5">
                            <div class="col-1">
                                <label class="col-form-label control-label"> <b>Currency</b></label>
                            </div>
                            <div class="col-1">
                                <label class="col-form-label control-label"><b>Total COGS</b></label>
                            </div>
                            <div class="col-1">
                                <label class="col-form-label control-label"><b>Total Revenue</b></label>
                            </div>
                        </div>
                        <div class="row mt-lg-2">
                            <div class="col-1">
                                <label class="col-form-label control-label">IDR</label>
                            </div>
                            <div class="col-1 text-end">
                                <label class="col-form-label control-label">@ViewBag.totalcogsidr</label>
                            </div>
                            <div class="col-1 text-end">
                                <label class="col-form-label control-label">@ViewBag.totpriceidr</label>
                            </div>
                        </div>
                        <div class="row mt-lg-2">
                            <div class="col-1">
                                <label class="col-form-label control-label">USD</label>
                            </div>
                            <div class="col-1 text-end">
                                <label class="col-form-label control-label">@ViewBag.totalcogsusd</label>
                            </div>
                            <div class="col-1 text-end">
                                <label class="col-form-label control-label">@ViewBag.totpriceusd</label>
                            </div>
                        </div>
                        
                    </div>
                    <div class="tab-pane fade" id="pills-attachment" role="tabpanel" aria-labelledby="attachment-tab">
                        <hr />
                        @*  <form asp-action="UploadAttachment" onsubmit="loading()" asp-controller="PreProcs" method="post" enctype="multipart/form-data"> *@
                        <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                        @* <input type="hidden" asp-for="DocumentId" value="@Model.DocumentId" />
                        <input type="hidden" asp-for="Id" value="@Model.Id" /> *@
                        <div class="form-group">
                            <div class="row mt-lg-2">
                                <div class="col-6" id="divAttachRFP">
                                    <label class="col-form-label control-label">1. RFP / RKS</label>
                                    <span class="text-danger"></span>
                                </div>
                                <div class="col-2">
                                    <label class="col-form-label control-label">4. BoQ</label>
                                    <span class="text-danger"></span>
                                </div>
                            </div>
                            <div class="row mt-lg-2">
                                <div class="col-6">
                                    <div class="input-group" style="width:500px">
                                        <input type="file" name="postedfilerfp" class="form-control" id="postedfilerfp" aria-describedby="inputGroupFileAddon04" aria-label="Upload">
                                        <button class="btn btn-outline-secondary" type="button" id="inputGroupFileAddon04" onclick="uploadrfpfile()">Upload</button>
                                    </div>
                                    <div class='row mt-lg-2' id="divInputFileRFP">
                                        @if (FileNameRFP != null)
                                        {
                                            <a class="btn-outline-primary" data-bs-toggle="modal" role="button" data-bs-target="#attachmentModalRFP">@FileNameRFP</a>
                                        }
                                    </div>
                                </div>
                                <div class="col-6">
                                    <div class="input-group" style="width:500px">
                                        <input type="file" name="postedfileboq" class="form-control" id="postedfileboq" aria-describedby="inputGroupFileAddon04" aria-label="Upload">
                                        <button class="btn btn-outline-secondary" type="button" id="inputGroupFileAddon04" onclick="uploadboqfile()">Upload</button>
                                    </div>
                                    <div class='row mt-lg-2' id="divInputFileBOQ">
                                        @if (FileNameBOQ != null)
                                        {
                                            <a class="btn-outline-primary" data-bs-toggle="modal" role="button" data-bs-target="#attachmentModalBOQ">@FileNameBOQ</a>
                                        }
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="row mt-lg-2">
                                <div class="col-6 divAttachQuotCustomer">
                                    <label class="col-form-label control-label">2. Quotation to Customer</label>
                                    <span class="text-danger"></span>
                                </div>
                                <div class="col-2">
                                    <label class="col-form-label control-label">5. GP Projection</label>
                                    <span class="text-danger"></span>
                                </div>
                            </div>
                            <div class="row mt-lg-2">
                                <div class="col-6">
                                    <div class="input-group" style="width:500px">
                                        <input type="file" name="postedfilequot" class="form-control" id="postedfilequot" aria-describedby="inputGroupFileAddon04" aria-label="Upload">
                                        <button class="btn btn-outline-secondary" type="button" id="inputGroupFileAddon04" onclick="uploadquotfile()">Upload</button>
                                    </div>
                                    <div class='row mt-lg-2' id="divInputFileQuot">
                                        @if (FileNameQuot != null)
                                        {
                                            <a class="btn-outline-primary" data-bs-toggle="modal" role="button" data-bs-target="#attachmentModalQuot">@FileNameQuot</a>
                                        
                                        }
                                    </div>
                                </div>
                                <div class="col-6">
                                    <div class="input-group" style="width:500px">
                                        <input type="file" name="postedfilegp" class="form-control" id="postedfilegp" aria-describedby="inputGroupFileAddon04" aria-label="Upload">
                                        <button class="btn btn-outline-secondary" type="button" id="inputGroupFileAddon04" onclick="uploadgpfile()">Upload</button>
                                    </div>
                                    <div class='row mt-lg-2' id="divInputFileGP">
                                        @if (FileNameGP != null)
                                        {
                                        
                                            <a class="btn-outline-primary" data-bs-toggle="modal" role="button" data-bs-target="#attachmentModalGP">@FileNameGP</a>
                                        }
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="row mt-lg-2">
                                <div class="col-6 divAttachProposal">
                                    <label class="col-form-label control-label">3. Proposal</label>
                                    <span class="text-danger"></span>
                                </div>
                                <div class="col-2">
                                    <label class="col-form-label control-label">6. Others</label>
                                    <span class="text-danger"></span>
                                </div>
                            </div>
                            <div class="row mt-lg-2">
                                <div class="col-6">
                                    <div class="input-group" style="width:500px">
                                        <input type="file" name="postedfileproposal" class="form-control" id="postedfileproposal" aria-describedby="inputGroupFileAddon04" aria-label="Upload">
                                        <button class="btn btn-outline-secondary" type="button" id="inputGroupFileAddon04" onclick="uploadpropofile()">Upload</button>
                                    </div>
                                    <div class='row mt-lg-2' id="divInputFilePropo">
                                        @if (FileNamePropo != null)
                                        {
                                            <a class="btn-outline-primary" data-bs-toggle="modal" role="button" data-bs-target="#attachmentModalPropo">@FileNamePropo</a>
                                        }
                                    </div>
                                </div>
                                <div class="col-6">
                                    <div class="input-group" style="width:500px">
                                        <input type="file" name="postedfileothers" class="form-control" id="postedfileothers" aria-describedby="inputGroupFileAddon04" aria-label="Upload">
                                        <button class="btn btn-outline-secondary" type="button" id="inputGroupFileAddon04" onclick="uploadothersfile()">Upload</button>
                                    </div>
                                     <div class='row mt-lg-2' id="divInputFileOthers">
                                        @if (FileNameOthers != null)
                                        {
                                            <a class="btn-outline-primary" data-bs-toggle="modal" role="button" data-bs-target="#attachmentModalOthers">@FileNameOthers</a>
                                        }
                                    </div>
                                </div>
                            </div>
                        </div>
                        @* </form> *@
                    </div>
                    <div class="tab-pane fade " id="pills-approval" role="tabpanel" aria-labelledby="approval-tab">
                        <hr />
                        <div class="row mt-lg-4">
                            <b>
                                Approval/Review Items
                            </b>
                        </div>
                        <div class="table-wrapper table-responsive-lg mt-lg-4">
                            <table class="table table-striped" style="font-size:small">
                                <thead style="background:darkGreen;color:white">
                                    <tr>
                                        <th scope="col">Name</th>
                                        <th scope="col">Role</th>
                                        <th scope="col">Submit Date</th>
                                        <th scope="col">Status</th>
                                        <th scope="col">Remark</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    @if (@ViewBag.approvalhist != null)
                                    {
                                        @foreach (var item in @ViewBag.approvalhist)
                                        {
                                            <tr>
                                                <td scope="col" style="width: 250px;">@item.ApproverName</td>
                                                <td scope="col" class="text-center" style="width: 200px;">@item.ApproverRole</td>
                                                <td scope="col" class="text-center" style="width: 150px;">@item.ApprovalDate.ToString("dd MMM yy")</td>
                                                <td scope="col" style="width: 150px;" class="text-center">@item.Status</td>
                                                <td scope="col">@item.Remark</td>
                                            </tr>
                                        }
                                    }
                                </tbody>
                            </table>
                        </div>

                        <div class="row mt-lg-4">
                            <b>
                                Approval/Review Risk
                            </b>
                        </div>
                        <div class="table-wrapper table-responsive-lg mt-lg-4">
                            <table class="table table-striped" style="font-size:small">
                                <thead style="background:darkGreen;color:white">
                                    <tr>
                                        <th scope="col">Name</th>
                                        <th scope="col">Role</th>
                                        <th scope="col">Submit Date</th>
                                        <th scope="col">Status</th>
                                        <th scope="col">Remark</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    @if (@ViewBag.approvalhistrisk != null)
                                    {
                                        @foreach (var item in @ViewBag.approvalhistrisk)
                                        {
                                            <tr>
                                                <td scope="col" style="width: 250px;">@item.ApproverName</td>
                                                <td scope="col" class="text-center" style="width: 200px;">@item.ApproverRole</td>
                                                <td scope="col" class="text-center" style="width: 150px;">@item.ApprovalDate.ToString("dd MMM yy")</td>
                                                <td scope="col" style="width: 150px;" class="text-center">@item.Status</td>
                                                <td scope="col">@item.Remark</td>
                                            </tr>
                                        }
                                    }
                                </tbody>
                            </table>
                        </div>

                        @* <div class="row mt-lg-4">
                            <b>
                                Remark & Clarification
                            </b>
                        </div>
                        <div class="row mt-lg-4">
                            <span>User Responses :</span>
                        </div> *@

                    </div>
                    <div class="tab-pane fade" id="pills-pmo" role="tabpanel" aria-labelledby="pmo-tab">
                        <hr />
                        <b>PMO Request Checklist</b>
                        <div class="form-group">
                            <div class="row mt-lg-3">
                                <div class="col-9">
                                    <span class="badge rounded-pill bg-success text-center" style="width: 100%;font-size: medium;">Information to Provide</span>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="row mt-lg-3">
                                <div class="col-2">
                                    <div class="custom-control custom-checkbox">
                                        @if (@ViewBag.pmocheck != null)
                                        {
                                            @if (@ViewBag.pmocheck.CheckedCustomerPic == true && @ViewBag.pmocheck != null)
                                            {
                                                <input type="checkbox" class="form-check-input checkbox"
                                                    style="border: 1px solid;vertical-align:-webkit-baseline-middle" id="checkCustPIC" checked>
                                            } 
                                            else{
                                                <input type="checkbox" class="form-check-input checkbox"
                                                    style="border: 1px solid;vertical-align:-webkit-baseline-middle" id="checkCustPIC">
                                            }
                                        }
                                        else{
                                            <input type="checkbox" class="form-check-input checkbox"
                                                style="border: 1px solid;vertical-align:-webkit-baseline-middle" id="checkCustPIC">
                                        }
                                        
                                        <label class="custom-control-label" for="customCheck1" style="vertical-align:-webkit-baseline-middle">Customer PIC <b class="text-red" > * </b></label>
                                    </div>
                                </div>
                                <div class="col-6">
                                    <div class="row">
                                        <label class="col-form-label control-label col-1">
                                            :
                                        </label>
                                        @if(@ViewBag.pmocheck != null){
                                            <input class="form-control inputAll txtCustomerPIC" name="txtCustomerPIC" id="txtCustomerPIC" style="width:90%" type="text" value="@ViewBag.pmocheck.CustomerPic" == null ? null : "@ViewBag.pmocheck.CustomerPic"/>
                                        }
                                        else{
                                           <input class="form-control inputAll txtCustomerPIC" name="txtCustomerPIC" id="txtCustomerPIC" style="width:90%" type="text"/>
                                        }
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="row mt-lg-3">
                                <div class="col-2">
                                    <div class="custom-control custom-checkbox">
                                        @if (@ViewBag.pmocheck != null)
                                        {
                                            @if (@ViewBag.pmocheck.CheckedHighLevelSow == true)
                                            {
                                                <input type="checkbox" class="form-check-input checkbox"
                                                style="border: 1px solid;vertical-align:-webkit-baseline-middle" id="checkHighLvlSOW" checked>
                                            }
                                            else
                                            {
                                                <input type="checkbox" class="form-check-input checkbox"
                                                style="border: 1px solid;vertical-align:-webkit-baseline-middle" id="checkHighLvlSOW">
                                            }
                                        }
                                        else
                                        {
                                            <input type="checkbox" class="form-check-input checkbox"
                                            style="border: 1px solid;vertical-align:-webkit-baseline-middle" id="checkHighLvlSOW">
                                        }
                                        <label class="custom-control-label" for="customCheck1" style="vertical-align:-webkit-baseline-middle">High Level SOW <b class="text-red" > * </b></label>
                                    </div>
                                </div>
                                <div class="col-6">
                                    <div class="row">
                                        <label class="col-form-label control-label col-1">
                                            :
                                        </label>
                                        @if(@ViewBag.pmocheck != null){
                                            <input class="form-control inputAll txtHighLevelSOW" name="txtHighLevelSOW" id="txtHighLevelSOW" style="width:90%" type="text" value="@ViewBag.pmocheck.HighLevelSow" == null ? null : "@ViewBag.pmocheck.HighLevelSow"/>
                                        }
                                        else{
                                            <input class="form-control inputAll txtHighLevelSOW" name="txtHighLevelSOW" id="txtHighLevelSOW" style="width:90%" type="text"/>
                                        }
                                        
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="row mt-lg-3">
                                <div class="col-2">
                                    <div class="custom-control custom-checkbox">
                                        @if (@ViewBag.pmocheck != null)
                                        {
                                            @if (@ViewBag.pmocheck.CheckedProjectSite == true)
                                            {
                                                <input type="checkbox" class="form-check-input checkbox"
                                                style="border: 1px solid;vertical-align:-webkit-baseline-middle" id="checkProjectSite" checked>
                                            }
                                            else
                                            {
                                                <input type="checkbox" class="form-check-input checkbox"
                                                style="border: 1px solid;vertical-align:-webkit-baseline-middle" id="checkProjectSite">
                                            }
                                        }
                                        else
                                        {
                                            <input type="checkbox" class="form-check-input checkbox"
                                            style="border: 1px solid;vertical-align:-webkit-baseline-middle" id="checkProjectSite">
                                        }

                                        <label class="custom-control-label" for="customCheck1" style="vertical-align:-webkit-baseline-middle">Project Site <b class="text-red" > * </b></label>
                                    </div>
                                </div>
                                <div class="col-6">
                                    <div class="row">
                                        <label class="col-form-label control-label col-1">
                                            :
                                        </label>
                                        @if(@ViewBag.pmocheck != null){
                                            <input class="form-control inputAll txtProjectSite" name="txtProjectSite" id="txtProjectSite" style="width:90%" type="text" value="@ViewBag.pmocheck.ProjectSite" = =null ? null : "@ViewBag.pmocheck.ProjectSite" />
                                        }
                                        else{
                                            <input class="form-control inputAll txtProjectSite" name="txtProjectSite" id="txtProjectSite" style="width:90%" type="text"/>
                                        }
                                        
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="row mt-lg-3">
                                <div class="col-2">
                                    <div class="custom-control custom-checkbox">
                                        @if (@ViewBag.pmocheck != null)
                                        {
                                            @if (@ViewBag.pmocheck.CheckedProjectValue == true)
                                            {
                                                <input type="checkbox" class="form-check-input checkbox"
                                                style="border: 1px solid;vertical-align:-webkit-baseline-middle" id="checkProjectValue" checked>
                                            }
                                            else
                                            {
                                                <input type="checkbox" class="form-check-input checkbox"
                                                style="border: 1px solid;vertical-align:-webkit-baseline-middle" id="checkProjectValue">
                                            }
                                        }
                                        else
                                        {
                                            <input type="checkbox" class="form-check-input checkbox"
                                            style="border: 1px solid;vertical-align:-webkit-baseline-middle" id="checkProjectValue">
                                        }

                                        <label class="custom-control-label" for="customCheck1" style="vertical-align:-webkit-baseline-middle">Project Value <b class="text-red" > * </b></label>
                                    </div>
                                </div>
                                <div class="col-6">
                                    <div class="row">
                                        <label class="col-form-label control-label col-1">
                                            :
                                        </label>
                                        @if (@Model.ProjectValueUsd == null)
                                        {
                                            <input class="text-end form-control inputAll txtProjectValue" name="txtProjectValue" id="txtProjectValue" style="width:90%" type="text" value="@Model.ProjectValueIdr"/>
                                        }
                                        @if (@Model.ProjectValueIdr == null)
                                        {
                                            <input class="text-end form-control inputAll txtProjectValue" name="txtProjectValue" id="txtProjectValue" style="width:90%" type="text" value="@Model.ProjectValueUsd"/>
                                        }
                                        
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="row mt-lg-3">
                                <div class="col-2">
                                    <div class="custom-control custom-checkbox">
                                        @if (@ViewBag.pmocheck != null)
                                        {
                                            @if (@ViewBag.pmocheck.CheckedEstimatedStartEndDate == true)
                                            {
                                                <input type="checkbox" class="form-check-input checkbox" style="border: 1px solid;vertical-align:-webkit-baseline-middle" id="checkEstStartDate" checked>
                                            }
                                            else
                                            {
                                                <input type="checkbox" class="form-check-input checkbox" style="border: 1px solid;vertical-align:-webkit-baseline-middle" id="checkEstStartDate">
                                            }
                                        }
                                        else
                                        {
                                            <input type="checkbox" class="form-check-input checkbox" style="border: 1px solid;vertical-align:-webkit-baseline-middle" id="checkEstStartDate">
                                        }

                                        <label class="custom-control-label" for="customCheck1" style="vertical-align:-webkit-baseline-middle">Estimated Start Date <b class="text-red" > * </b></label>
                                    </div>
                                </div>
                                @if (@ViewBag.pmocheck != null)
                                {
                                    @if (@ViewBag.pmocheck.EstimatedStartDate != null)
                                    {
                                        <div class="col-3">
                                            <div class="row">
                                                <label class="col-form-label control-label col-1">
                                                    :
                                                </label>
                                                <input class="form-control inputAll txtEstStartDate" name="txtEstStartDate" id="txtEstStartDate" style="width:150px;margin-left: 27px;" type="date" value="@ViewBag.pmocheck.EstimatedStartDate.ToString("yyyy-MM-dd")">
                                            </div>
                                        </div>
                                    }
                                }
                                else
                                {
                                    <div class="col-3">
                                        <div class="row">
                                            <label class="col-form-label control-label col-1">
                                                :
                                            </label>
                                            <input class="form-control inputAll txtEstStartDate" name="txtEstStartDate" id="txtEstStartDate" style="width:150px;margin-left: 27px;" type="date" min="@todayyy">
                                        </div>
                                    </div>
                                }

                                <div class="col-1">
                                    <label class="custom-control-label" for="customCheck1" style="vertical-align:-webkit-baseline-middle">End Date <b class="text-red" > * </b></label>
                                </div>
                                @if (@ViewBag.pmocheck != null)
                                {
                                    @if (@ViewBag.pmocheck.EndDate != null)
                                    {
                                        <div class="col-3">
                                            <div class="row">
                                                <label class="col-form-label control-label col-1">
                                                    :
                                                </label>
                                                <input class="form-control inputAll txtEndDate" name="txtEndDate" id="txtEndDate" style="width: 176px;" type="date" value="@ViewBag.pmocheck.EndDate.ToString("yyyy-MM-dd")">
                                            </div>
                                        </div>
                                    }
                                }
                                else
                                {
                                    <div class="col-3">
                                        <div class="row">
                                            <label class="col-form-label control-label col-1">
                                                :
                                            </label>
                                            <input class="form-control inputAll txtEndDate" name="txtEndDate" id="txtEndDate" style="width: 176px;" type="date" >
                                        </div>
                                    </div>
                                }
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="row mt-lg-3">
                                <div class="col-2">
                                    <div class="custom-control custom-checkbox">
                                        @if (@ViewBag.pmocheck != null)
                                        {
                                            @if (@ViewBag.pmocheck.CheckedEstimatedKickOff == true)
                                            {
                                                <input type="checkbox" class="form-check-input checkbox" style="border: 1px solid;vertical-align:-webkit-baseline-middle" id="checkEstKickOff" checked>
                                            }
                                            else
                                            {
                                                <input type="checkbox" class="form-check-input checkbox" style="border: 1px solid;vertical-align:-webkit-baseline-middle" id="checkEstKickOff">
                                            }
                                        }
                                        else
                                        {
                                            <input type="checkbox" class="form-check-input checkbox" style="border: 1px solid;vertical-align:-webkit-baseline-middle" id="checkEstKickOff">
                                        }

                                        <label class="custom-control-label" for="customCheck1" style="vertical-align:-webkit-baseline-middle">Estimated Kick Off</label>
                                    </div>
                                </div>
                                <div class="col-3">
                                    <div class="row">
                                        <label class="col-form-label control-label col-1">
                                            :
                                        </label>
                                        @if(@ViewBag.pmocheck != null){
                                            <input class="form-control inputAll txtKickOff" name="txtKickOff" id="txtKickOff" style="width:265px;margin-left: 27px;" type="text" value="@ViewBag.pmocheck.EstimatedKickOffNote" == null ? null : "@ViewBag.pmocheck.EstimatedKickOffNote">
                                        }
                                        else{
                                            <input class="form-control inputAll txtKickOff" name="txtKickOff" id="txtKickOff" style="width:265px;margin-left: 27px;" type="text">
                                        }
                                        
                                    </div>
                                </div>
                                <div class="col-1">
                                    <label class="custom-control-label" for="customCheck1" style="vertical-align:-webkit-baseline-middle">Date</label>
                                </div>
                                @if (@ViewBag.pmocheck != null)
                                {
                                    @if (@ViewBag.pmocheck.EstimatedKickOffDate != null)
                                    {
                                        <div class="col-3">
                                            <div class="row">
                                                <label class="col-form-label control-label col-1">
                                                    :
                                                </label>
                                                <input class="form-control inputAll txtKickOffDate" name="txtKickOffDate" id="txtKickOffDate" style="width: 176px;" type="date" value="@ViewBag.pmocheck.EstimatedKickOffDate.ToString("yyyy-MM-dd")">
                                            </div>
                                        </div>
                                    }
                                    else{
                                        <div class="col-3">
                                            <div class="row">
                                                <label class="col-form-label control-label col-1">
                                                    :
                                                </label>
                                                <input class="form-control inputAll txtKickOffDate" name="txtKickOffDate" id="txtKickOffDate" style="width: 176px;" type="date">
                                            </div>
                                        </div>
                                    }
                                }
                                else
                                {
                                    <div class="col-3">
                                        <div class="row">
                                            <label class="col-form-label control-label col-1">
                                                :
                                            </label>
                                            <input class="form-control inputAll txtKickOffDate" name="txtKickOffDate" id="txtKickOffDate" style="width: 176px;" type="date">
                                        </div>
                                    </div>
                                }

                            </div>
                        </div>
                        <div class="form-group">
                            <div class="row mt-lg-3">
                                <div class="col-2">
                                    <div class="custom-control custom-checkbox">
                                        @if (@ViewBag.pmocheck != null)
                                        {
                                            @if (@ViewBag.pmocheck.CheckedProductTeamPic == true)
                                            {
                                                <input type="checkbox" class="form-check-input checkbox"
                                                style="border: 1px solid;vertical-align:-webkit-baseline-middle" id="checkProductTeamPIC" checked>
                                            }
                                            else
                                            {
                                                <input type="checkbox" class="form-check-input checkbox"
                                                style="border: 1px solid;vertical-align:-webkit-baseline-middle" id="checkProductTeamPIC">
                                            }
                                        }
                                        else
                                        {
                                            <input type="checkbox" class="form-check-input checkbox"
                                            style="border: 1px solid;vertical-align:-webkit-baseline-middle" id="checkProductTeamPIC">
                                        }

                                        <label class="custom-control-label" for="customCheck1" style="vertical-align:-webkit-baseline-middle">Product Team PIC</label>
                                    </div>
                                </div>
                                <div class="col-6">
                                    <div class="row">
                                        <label class="col-form-label control-label col-1">
                                            :
                                        </label>
                                        @if(@ViewBag.pmocheck != null){
                                            <input class="form-control inputAll txtProductTeamPIC" name="txtProductTeamPIC" id="txtProductTeamPIC" style="width:90%" type="text" value=@ViewBag.pmocheck.ProductTeamPic = =null ? null : "@ViewBag.pmocheck.ProductTeamPic" />
                                        }
                                        else{
                                             <input class="form-control inputAll txtProductTeamPIC" name="txtProductTeamPIC" id="txtProductTeamPIC" style="width:90%" type="text"/>
                                        }
                                       
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="row mt-lg-3">
                                <div class="col-9">
                                    <span class="badge rounded-pill bg-success text-center" style="width: 100%;font-size: medium;">Document to Attach</span>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="row mt-lg-3">
                                <div class="col-2">
                                    <div class="custom-control custom-checkbox">
                                        @if (@ViewBag.pmocheck != null)
                                        {
                                            @if (@ViewBag.pmocheck.CheckedSpkorPoorContract == true)
                                            {
                                                <input type="checkbox" class="form-check-input checkbox"
                                                style="border: 1px solid;vertical-align:-webkit-baseline-middle" id="checkAttachSPK" checked>
                                            }
                                            else
                                            {
                                                <input type="checkbox" class="form-check-input checkbox"
                                                style="border: 1px solid;vertical-align:-webkit-baseline-middle" id="checkAttachSPK">
                                            }
                                        }
                                        else
                                        {
                                            <input type="checkbox" class="form-check-input checkbox"
                                            style="border: 1px solid;vertical-align:-webkit-baseline-middle" id="checkAttachSPK">
                                        }

                                        <label class="custom-control-label" for="customCheck1" style="vertical-align:-webkit-baseline-middle">SPK / PO / Contract	</label>
                                    </div>
                                </div>
                                <div class="col-7">
                                    <div class="row">
                                        <label class="col-form-label control-label col-1" style="width: 42px;">
                                            :
                                        </label>
                                        <div class="input-group" style="width:80%">
                                            <input type="file" name="postedfilepmospk" class="form-control" id="postedfilepmospk" aria-describedby="inputGroupFileAddon04" aria-label="Upload">
                                            <button class="btn btn-outline-secondary" type="button" id="inputGroupFileAddon04">Upload</button>
                                        </div>
                                    </div>
                                    
                                </div>
                            </div>
                            <div class="row mt-lg-3">
                                <div class="col-2" style="margin-left:42px">
                                </div>
                                <div class="col">
                                    @if (@ViewBag.attachSPK.Count > 0)
                                    {
                                        @Html.ActionLink(FileNameSPK, "GetFileAttachment", new { controller = "PreProcs",
                                    target =  @ViewBag.attachSPK[0].StrictedFileName + ";" + FileNameSPK }, new { target = "_blank", @class="btn-outline-primary" })
                                    }

                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="row mt-lg-3">
                                <div class="col-2">
                                    <div class="custom-control custom-checkbox">
                                        @if (@ViewBag.pmocheck != null)
                                        {
                                            @if (@ViewBag.pmocheck.CheckedRfporRksorTor == true)
                                            {
                                                <input type="checkbox" class="form-check-input checkbox"
                                                style="border: 1px solid;vertical-align:-webkit-baseline-middle" id="checkAttachRFP" checked>
                                            }
                                            else
                                            {
                                                <input type="checkbox" class="form-check-input checkbox"
                                                style="border: 1px solid;vertical-align:-webkit-baseline-middle" id="checkAttachRFP">
                                            }
                                        }
                                        else
                                        {
                                            <input type="checkbox" class="form-check-input checkbox"
                                            style="border: 1px solid;vertical-align:-webkit-baseline-middle" id="checkAttachRFP">
                                        }
                                        @if (@Model.Stage == "Delivery")
                                        {
                                            <label class="custom-control-label" for="customCheck1" style="vertical-align:-webkit-baseline-middle">RFP / RKS / TOR </label>
                                        }
                                        else if(@Model.Stage == "Presales"){
                                            <label class="custom-control-label" for="customCheck1" style="vertical-align:-webkit-baseline-middle">RFP / RKS / TOR <b class="text-red" > * </b></label>
                                        }
                                        
                                    </div>
                                </div>
                                <div class="col-7">
                                    <div class="row">
                                        <label class="col-form-label control-label col-1" style="width: 42px;">
                                            :
                                        </label>
                                        <div class="input-group" style="width:80%">
                                            <input type="file" name="postedfilepmorfp" class="form-control" id="postedfilepmorfp" aria-describedby="inputGroupFileAddon04" aria-label="Upload">
                                            <button class="btn btn-outline-secondary" type="button" id="inputGroupFileAddon04">Upload</button>
                                        </div>
                                    </div>
                                    
                                </div>
                            </div>
                            <div class="row mt-lg-3">
                                <div class="col-2" style="margin-left:42px">
                                </div>
                                <div class="col">
                                    @if (@ViewBag.attachRFP.Count > 0)
                                    {
                                        @Html.ActionLink(FileNameRFP, "GetFileAttachment", new { controller = "PreProcs",
                                    target =  @ViewBag.attachRFP[0].StrictedFileName + ";" + FileNameRFP }, new { target = "_blank", @class="btn-outline-primary" })
                                    }
                                    
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="row mt-lg-3">
                                <div class="col-2">
                                    <div class="custom-control custom-checkbox">
                                        @if (@ViewBag.pmocheck != null)
                                        {
                                            @if (@ViewBag.pmocheck.CheckedQuotation == true)
                                            {
                                                <input type="checkbox" class="form-check-input checkbox"
                                                style="border: 1px solid;vertical-align:-webkit-baseline-middle" id="checkAttachQuot" checked>
                                            }
                                            else
                                            {
                                                <input type="checkbox" class="form-check-input checkbox"
                                                style="border: 1px solid;vertical-align:-webkit-baseline-middle" id="checkAttachQuot">
                                            }
                                        }
                                        else
                                        {
                                            <input type="checkbox" class="form-check-input checkbox"
                                            style="border: 1px solid;vertical-align:-webkit-baseline-middle" id="checkAttachQuot">
                                        }
                                        @if (@Model.Stage == "Delivery")
                                        {
                                            <label class="custom-control-label" for="customCheck1" style="vertical-align:-webkit-baseline-middle">Quotation <b class="text-red" > ** </b></label>
                                        }
                                        else if(@Model.Stage == "Presales"){
                                            <label class="custom-control-label" for="customCheck1" style="vertical-align:-webkit-baseline-middle">Quotation</label>
                                        }
                                        
                                    </div>
                                </div>
                                <div class="col-7">
                                    <div class="row">
                                        <label class="col-form-label control-label col-1" style="width: 42px;">
                                            :
                                        </label>
                                        <div class="input-group" style="width:80%">
                                            <input type="file" name="postedfilepmoquot" class="form-control" id="postedfilepmoquot" aria-describedby="inputGroupFileAddon04" aria-label="Upload">
                                            <button class="btn btn-outline-secondary" type="button" id="inputGroupFileAddon04">Upload</button>
                                        </div>
                                    </div>
                                    
                                </div>
                            </div>
                            <div class="row mt-lg-3">
                                <div class="col-2" style="margin-left:42px">
                                </div>
                                <div class="col">
                                    @if (@ViewBag.attachQuot.Count > 0)
                                    {
                                        @Html.ActionLink(FileNameQuot, "GetFileAttachment", new { controller = "PreProcs",
                                    target =  @ViewBag.attachQuot[0].StrictedFileName + ";" + FileNameQuot }, new { target = "_blank", @class="btn-outline-primary" })
                                    }
                                    
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="row mt-lg-3">
                                <div class="col-2">
                                    <div class="custom-control custom-checkbox">
                                        @if (@ViewBag.pmocheck != null)
                                        {
                                            @if (@ViewBag.pmocheck.CheckedProposal == true)
                                            {
                                                <input type="checkbox" class="form-check-input checkbox"
                                                style="border: 1px solid;vertical-align:-webkit-baseline-middle" id="checkAttachProposal" checked>
                                            }
                                            else
                                            {
                                                <input type="checkbox" class="form-check-input checkbox"
                                                style="border: 1px solid;vertical-align:-webkit-baseline-middle" id="checkAttachProposal">
                                            }
                                        }
                                        else
                                        {
                                            <input type="checkbox" class="form-check-input checkbox"
                                            style="border: 1px solid;vertical-align:-webkit-baseline-middle" id="checkAttachProposal">
                                        }
                                        @if (@Model.Stage == "Delivery")
                                        {
                                            <label class="custom-control-label" for="customCheck1" style="vertical-align:-webkit-baseline-middle">Proposal <b class="text-red" > ** </b></label>
                                        }
                                        else if(@Model.Stage == "Presales"){
                                            <label class="custom-control-label" for="customCheck1" style="vertical-align:-webkit-baseline-middle">Proposal</label>
                                        }
                                        
                                    </div>
                                </div>
                                <div class="col-7">
                                    <div class="row">
                                        <label class="col-form-label control-label col-1" style="width: 42px;">
                                            :
                                        </label>
                                        <div class="input-group" style="width:80%">
                                            <input type="file" name="postedfilepmoproposal" class="form-control" id="postedfilepmoproposal" aria-describedby="inputGroupFileAddon04" aria-label="Upload">
                                            <button class="btn btn-outline-secondary" type="button" id="inputGroupFileAddon04">Upload</button>
                                        </div>
                                    </div>
                                    
                                </div>
                            </div>
                            <div class="row mt-lg-3">
                                <div class="col-2" style="margin-left:42px">
                                </div>
                                <div class="col">
                                    @if (@ViewBag.attachPropo.Count > 0)
                                    {
                                        @Html.ActionLink(FileNamePropo, "GetFileAttachment", new { controller = "PreProcs",
                                    target =  @ViewBag.attachPropo[0].StrictedFileName + ";" + FileNamePropo }, new { target = "_blank", @class="btn-outline-primary" })
                                    }
                                    
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="row mt-lg-3">
                                <div class="col-2">
                                    <div class="custom-control custom-checkbox">
                                        @if (@ViewBag.pmocheck != null)
                                        {
                                            @if (@ViewBag.pmocheck.CheckedBoQ == true)
                                            {
                                                <input type="checkbox" class="form-check-input checkbox"
                                                style="border: 1px solid;vertical-align:-webkit-baseline-middle" id="checkAttachBOQ" checked>
                                            }
                                            else
                                            {
                                                <input type="checkbox" class="form-check-input checkbox"
                                                style="border: 1px solid;vertical-align:-webkit-baseline-middle" id="checkAttachBOQ">
                                            }
                                        }
                                        else
                                        {
                                            <input type="checkbox" class="form-check-input checkbox"
                                            style="border: 1px solid;vertical-align:-webkit-baseline-middle" id="checkAttachBOQ">
                                        }

                                        <label class="custom-control-label" for="customCheck1" style="vertical-align:-webkit-baseline-middle">BoQ (Bill of Quantity)</label>
                                    </div>
                                </div>
                                <div class="col-7">
                                    <div class="row">
                                        <label class="col-form-label control-label col-1" style="width: 42px;">
                                            :
                                        </label>
                                        <div class="input-group" style="width:80%">
                                            <input type="file" name="postedfilepmoboq" class="form-control" id="postedfilepmoboq" aria-describedby="inputGroupFileAddon04" aria-label="Upload">
                                            <button class="btn btn-outline-secondary" type="button" id="inputGroupFileAddon04">Upload</button>
                                        </div>
                                    </div>
                                    
                                </div>
                            </div>
                            <div class="row mt-lg-3">
                                <div class="col-2" style="margin-left:42px">
                                </div>
                                <div class="col">
                                    @if (@ViewBag.attachBOQ.Count > 0)
                                    {
                                        @Html.ActionLink(FileNameBOQ, "GetFileAttachment", new { controller = "PreProcs",
                                    target =  @ViewBag.attachBOQ[0].StrictedFileName + ";" + FileNameBOQ }, new { target = "_blank", @class="btn-outline-primary" })
                                    }
                                    
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="row mt-lg-3">
                                <div class="col-2">
                                    <div class="custom-control custom-checkbox">
                                        @if (@ViewBag.pmocheck != null)
                                        {
                                            @if (@ViewBag.pmocheck.CheckedNegotiationMoM == true)
                                            {
                                                <input type="checkbox" class="form-check-input checkbox"
                                                style="border: 1px solid;vertical-align:-webkit-baseline-middle" id="checkAttachNego" checked>
                                            }
                                            else
                                            {
                                                <input type="checkbox" class="form-check-input checkbox"
                                                style="border: 1px solid;vertical-align:-webkit-baseline-middle" id="checkAttachNego">
                                            }
                                        }
                                        else
                                        {
                                            <input type="checkbox" class="form-check-input checkbox"
                                            style="border: 1px solid;vertical-align:-webkit-baseline-middle" id="checkAttachNego">
                                        }
                                        <label class="custom-control-label" for="customCheck1" style="vertical-align:-webkit-baseline-middle">Negotiation MoM</label>
                                    </div>
                                </div>
                                <div class="col-7">
                                    <div class="row">
                                        <label class="col-form-label control-label col-1" style="width: 42px;">
                                            :
                                        </label>
                                        <div class="input-group" style="width:80%">
                                            <input type="file" name="postedfilepmonego" class="form-control" id="postedfilepmonego" aria-describedby="inputGroupFileAddon04" aria-label="Upload">
                                            <button class="btn btn-outline-secondary" type="button" id="inputGroupFileAddon04">Upload</button>
                                        </div>
                                    </div>
                                    
                                </div>
                            </div>
                            <div class="row mt-lg-3">
                                <div class="col-2" style="margin-left:42px">
                                </div>
                                <div class="col">
                                    @if (@ViewBag.attachNego.Count > 0)
                                    {
                                        @Html.ActionLink(FileNameNego, "GetFileAttachment", new { controller = "PreProcs",
                                    target =  @ViewBag.attachNego[0].StrictedFileName + ";" + FileNameNego }, new { target = "_blank", @class="btn-outline-primary" })
                                    }
                                    
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="row mt-lg-3">
                                <div class="col-2">
                                    <div class="custom-control custom-checkbox">
                                        @if (@ViewBag.pmocheck != null)
                                        {
                                            @if (@ViewBag.pmocheck.CheckedOtherAttachment == true)
                                            {
                                                <input type="checkbox" class="form-check-input checkbox"
                                                style="border: 1px solid;vertical-align:-webkit-baseline-middle" id="checkAttachOther" checked>
                                            }
                                            else
                                            {
                                                <input type="checkbox" class="form-check-input checkbox"
                                                style="border: 1px solid;vertical-align:-webkit-baseline-middle" id="checkAttachOther">
                                            }
                                        }
                                        else
                                        {
                                            <input type="checkbox" class="form-check-input checkbox"
                                            style="border: 1px solid;vertical-align:-webkit-baseline-middle" id="checkAttachOther">
                                        }

                                        <label class="custom-control-label" for="customCheck1" style="vertical-align:-webkit-baseline-middle">Other</label>
                                    </div>
                                </div>
                                <div class="col-7">
                                    <div class="row">
                                        <label class="col-form-label control-label col-1" style="width: 42px;">
                                            :
                                        </label>
                                        <div class="input-group" style="width:80%">
                                            <input type="file" name="postedfilepmoother" class="form-control" id="postedfilepmoother" aria-describedby="inputGroupFileAddon04" aria-label="Upload">
                                            <button class="btn btn-outline-secondary" type="button" id="inputGroupFileAddon04">Upload</button>
                                        </div>
                                    </div>
                                    
                                </div>
                            </div>
                            <div class="row mt-lg-3">
                                <div class="col-2" style="margin-left:42px">
                                </div>
                                <div class="col">
                                    @if (@ViewBag.attachOthers.Count > 0)
                                    {
                                        @Html.ActionLink(FileNameOthers, "GetFileAttachment", new { controller = "PreProcs",
                                    target =  @ViewBag.attachOthers[0].StrictedFileName + ";" + FileNameOthers }, new { target = "_blank", @class="btn-outline-primary" })
                                    }
                                    
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="row mt-lg-3">
                                <div class="col-9">
                                    <span class="badge rounded-pill bg-success text-center" style="width: 100%;font-size: medium;">Specific Term & Condition</span>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="row mt-lg-1">
                                <div class="col-8 text-center">
                                    <label class="custom-control-label text-red" for="customCheck1" style="vertical-align:-webkit-baseline-middle;font-style: italic;font-size:smaller">Please specify any other specific terms & condition that PM or project team should be aware of, such as:
    </label>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="row mt-lg-3">
                                <div class="col-8">
                                    @if (@ViewBag.pmocheck != null)
                                    {
                                        <textarea class="form-control" id="txtSpecTerm" style="width: 97%;height:200px;margin-left: 23px;font-weight: bold">@ViewBag.pmocheck.SpecificTerms</textarea>
                                    }
                                    else{
                                        <textarea class="form-control" id="txtSpecTerm" style="width: 97%;height:200px;margin-left: 23px;font-weight: bold">1. Specific customer request or requirement
2. Customer office hour, code of conduct
3. NDA requirement
4. Customer site condition (ready, on renovation, building in progress, etc)
5. Delivery Terms (i.e. asset# required, within office hour, ETD, etc)
6. BAST Terms (i.e. customer format & numbering required)
7. Invoice Terms (i.e. invoice must be not later than one month after BAST or not later than any particular date)
8. Penalty terms
9. Customer Master Asset requirement
10. etc.</textarea>
                                    }
                                    
                                </div>
                            </div>
                        </div>
                        @if (Model.Stage == "Delivery")
                        {
                            <div class="form-group">
                                <div class="row mt-lg-3">
                                    <div class="col-2">
                                        <label class="col-form-label control-label" style="margin-left: 23px;">
                                            PM HR Cost <b class="text-red" id="mandaPMHRCost" style="visibility:hidden">*</b>
                                        </label>
                                    </div>
                                    <div class="col-4">
                                        <div class="row">
                                            <label class="col-form-label control-label col-3">
                                                Mandays :
                                            </label>
                                            <div class="input-group text-center" style="width: 65%;">
                                                @if (ViewBag.pmocheck != null)
                                                {
                                                    <input class="form-control txtMandaysPM readonly-select" name="txtMandaysPM" id="txtMandaysPM" type="text" value="@ViewBag.pmocheck.Pmmandays">
                                                }
                                                else{
                                                    <input class="form-control txtMandaysPM readonly-select" name="txtMandaysPM" id="txtMandaysPM" type="text">
                                                }
                                            </div>
                                        </div>
                                    
                                    </div>
                                    <div class="col-3">
                                        <div class="row">
                                            <label class="col-form-label control-label col-3">
                                                Value :
                                            </label>
                                            <div class="input-group text-center" style="width: 75%;">
                                                @if (ViewBag.pmocheck != null)
                                                {
                                                    <input class="form-control txtValuePM readonly-select" name="txtValuePM" id="txtValuePM" type="text" value="@ViewBag.pmocheck.Pmvalue">
                                                }
                                                else{
                                                    <input class="form-control txtValuePM readonly-select" name="txtValuePM" id="txtValuePM" type="text">
                                                }
                                            </div>
                                        </div>
                                    
                                    </div>
                                </div>
                                <div class="row mt-lg-4">
                                    <div class="col-2">
                                    
                                    </div>
                                    <div class="col-4">
                                        @if (ViewBag.pmocheck != null){
                                            <div class="row">
                                                <label class="col-form-label control-label col-3">
                                                    CV PM <span class="tab">:</span>
                                                </label>
                                                <div class="input-group" style="width: 65%;">
                                                    <select asp-for="Pm" class="form-select form-control readonly-select " id="cvPM" aria-label="Default select example" style="width:250px">
                                                    @foreach (var item in @ViewBag.pm)
                                                    {
                                                        <option value="@item.EmployeeEmail">@item.EmployeeName</option>
                                                    }
                                                </select>
                                                </div>
                                            </div>
                                        }
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="row mt-lg-3">
                                    <div class="col-2">
                                        <label class="col-form-label control-label" style="margin-left: 23px;">
                                            PC HR Cost <b class="text-red" id="mandaPCHRCost" style="visibility:hidden">*</b>
                                        </label>
                                    </div>
                                    <div class="col-4">
                                        <div class="row">
                                            <label class="col-form-label control-label col-3">
                                                Mandays :
                                            </label>
                                            <div class="input-group text-center" style="width: 65%;">
                                                @if (ViewBag.pmocheck != null)
                                                {
                                                    <input class="form-control  txtMandaysPC readonly-select" name="txtMandaysPC" id="txtMandaysPC" type="text" value="@ViewBag.pmocheck.Pcmandays">
                                                }
                                                else{
                                                    <input class="form-control  txtMandaysPC readonly-select" name="txtMandaysPC" id="txtMandaysPC" type="text" >
                                                }
                                            </div>
                                        </div>
                                    
                                    </div>
                                    <div class="col-3">
                                        <div class="row">
                                            <label class="col-form-label control-label col-3">
                                                Value :
                                            </label>
                                            <div class="input-group text-center" style="width: 75%;">
                                                @if (ViewBag.pmocheck != null)
                                                {
                                                    <input class="form-control  txtValuePC readonly-select" name="txtValuePC" id="txtValuePC" type="text" value="@ViewBag.pmocheck.Pcvalue">
                                                }
                                                else{
                                                    <input class="form-control  txtValuePC readonly-select" name="txtValuePC" id="txtValuePC" type="text" >
                                                }
                                            </div>
                                        </div>
                                    
                                    </div>
                                </div>
                                <div class="row mt-lg-4">
                                    <div class="col-2">
                                    
                                    </div>
                                    <div class="col-4">
                                        @if (ViewBag.pmocheck != null){
                                            <div class="row">
                                                <label class="col-form-label control-label col-3">
                                                    CV PC <span class="tab">:</span>
                                                </label>
                                                <div class="input-group" style="width: 65%;">
                                                    <select asp-for="Pc" class="form-select form-control readonly-select" id="cvPC" aria-label="Default select example" style="width:250px">
                                                    @foreach (var item in @ViewBag.pc)
                                                    {
                                                        <option value="@item.EmployeeEmail">@item.EmployeeName</option>
                                                    }
                                                </select>
                                                </div>
                                            </div>
                                        }
                                    </div>
                                </div>
                            </div>
                        }    
                        
                        <div class="form-group">
                            <div class="row mt-lg-4">
                                <div class="col">
                                    @if(@ViewBag.pmocheck == null){
                                        <a id="btnsubmitpmo" onclick="submitPMO()" data-toggle="tooltip" class="btn btn-outline-success">
                                            Submit to PMO
                                        </a>
                                    }
                                    else if (@ViewBag.pmocheck != null && Model.Stage == "Delivery" && (ViewBag.useraccesspmmgr != null || ViewBag.useraccesspcmgr != null || ViewBag.useraccesspmohead != null || ViewBag.useraccesssuperadmin != null))
                                    {
                                        <a id="btnnotiftoam" onclick="notifPMOtoAM()" data-toggle="tooltip" class="btn btn-outline-success">
                                            Notification To AM
                                        </a>
                                    }
                                    
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="tab-pane fade " id="pills-report" role="tabpanel" aria-labelledby="report-tab">
                        <hr />
                        @* <p> *@
                        <b>Reports</b>
                        <div class="row mt-lg-1">
                            <a asp-controller="PreProcs" asp-action="ShowRDL" asp-route-type="View PreProc Details" asp-route-id="@Model.ListItemId" target="_blank">View PreProc Details Item.rdl</a>
                            <a asp-controller="PreProcs" asp-action="ShowRDL" asp-route-type="Tracking Delivery Sheet" asp-route-id="@Model.ListItemId" target="_blank">Tracking Delivery Sheet.rdl</a>
                            <a asp-controller="PreProcs" asp-action="ShowRDL" asp-route-type="" asp-route-id="@Model.ListItemId" target="_blank">PO Data by PID.rdl</a>
                        </div>
                        <br>
                        <b>Reminder</b>
                        <div class="form-group">
                            <div class="row mt-lg-2">
                                <div class="col-2">
                                    <div class="custom-control custom-checkbox">
                                        <input type="checkbox" class="form-check-input checkbox"
                                               style="border: 1px solid;">
                                        <label class="custom-control-label" for="customCheck1">Is Penalty Applied</label>
                                    </div>
                                </div>
                                <div class="col-3">
                                    <label class="custom-control-label">| Penalty Due Date (if any) :</label>
                                </div>
                                <div class="col-2">
                                    <input class="form-control" style="width:250px" type="date" value="" />
                                </div>
                            </div>
                        </div>
                        <div class="row mt-lg-2">
                            <div class="col-2">
                                <div class="custom-control custom-checkbox">
                                    <input type="checkbox" class="form-check-input checkbox" style="border: 1px solid;" checked>
                                    <label class="custom-control-label" for="customCheck1">
                                        Active Status
                                    </label>
                                </div>
                            </div>
                        </div>
                        <div class="row mt-lg-2">
                            <div class="col-2">
                                <label class="col-form-label control-label">Need Escalation To AM</label>
                                <span class="text-danger"></span>
                            </div>
                            <div class="col-3">
                                <div class="row">
                                    <label class="col-form-label control-label col-1">
                                        : 
                                    </label>
                                    @if (ViewBag.billreason != null)
                                    {
                                        <input name="NeedEsc" value="true" type="checkbox" class="form-check-input checkbox readonly-select"
                                    style="border: 1px solid;" id="CheckEsc" checked> 
                                    }
                                    else
                                    {
                                        <input name="NeedEsc" value="true" type="checkbox" class="form-check-input checkbox readonly-select"
                                               style="border: 1px solid;" id="CheckEsc">
                                    }
                                </div>
                            </div>
                        </div>
                        <div class="row mt-lg-2">
                            <div class="col-2">
                                <label class="col-form-label control-label">Pending Billing Reason</label>
                                <span class="text-danger"></span>
                            </div>
                            <div class="col-4">
                                <div class="row">
                                    <label class="col-form-label control-label col-1">
                                        :
                                    </label>
                                    <select class="form-select form-control readonly-select" id="selectBillReason" aria-label="Default select example" style="width:250px" data-toggle="tooltip" data-placement="top" data-html="true" name="txtBillReason">
                                        <option value="">(Please Select)</option>
                                            @foreach (var item in @ViewBag.escalatetoam)
                                            {
                                                @if(ViewBag.billreason != null){
                                                    @if(ViewBag.billreason.EscalationReasonId == @item.Id){
                                                        <option selected value="@item.Id" title="@item.EscalationReason">@item.EscalationReason</option>
                                                    }
                                                    else{
                                                        <option value="@item.Id" title="@item.EscalationReason">@item.EscalationReason</option>
                                                    }

                                                }
                                                else{
                                                        <option value="@item.Id" title="@item.EscalationReason">@item.EscalationReason</option>
                                                }
                                            }
                                    </select>
                                </div>
                            </div>
                            <div class="col-3">
                                @if(ViewBag.billreason != null){
                                    <input id="inputOtherBillReason" class="form-control readonly-select" style="width:350px;display:none" name="txtOtherReason" type="text" value="@ViewBag.billreason.OtherReason"/>
                                }
                                else{
                                    <input id="inputOtherBillReason" class="form-control readonly-select" style="width:350px;display:none" name="txtOtherReason" type="text" />
                                }
                            </div>
                        </div>
                        <div class="form-group">
                                <div class="row mt-lg-2">
                                    <div class="col-2">
                                        <label class="col-form-label control-label col-11">
                                            PIC Billing Reason
                                        </label>

                                    </div>
                                    <div class="col-4">
                                        <div class="row">
                                            <label class="col-form-label control-label col-1">
                                                :
                                            </label>
                                            <textarea class="form-control readonly-select" id="editresultSelectedPICReason" style="width:380px;height:100px"></textarea>
                                        </div>
                                    </div>
                                    <div class="col-4" hidden id="divResultSelectedPICReasonDomain">
                                        @if (ViewBag.riskassess != null)
                                            {
                                                <textarea class="form-control" id="resultSelectedPICReasonDomain">@ViewBag.riskassess.EmailAssignTo</textarea>
                                                
                                            }
                                            else{
                                                <textarea class="form-control" id="resultSelectedPICReasonDomain"></textarea>

                                            }
                                    </div>
                                    <div class="col-2">
                                        <a class="btn btn-outline-secondary modalDelete readonly-select" id="selectPICReason" data-bs-toggle="modal" data-bs-target="#assignPICReasonModal">
                                            Select PIC Reason
                                        </a>
                                        @* <input class="form-control" style="width:250px" type="text" value="" />
                                    </div>
                                </div>
                            </div>

                        @* </p> *@

                    </div>
                </div><!-- End Pills Tabs -->

            </form>
        </div>
    </div>
</div>

@* MODAL *@
<div class="modal fade" id="modalLoadingElement" tabindex="-1" aria-hidden="true">
        <div class="modalBackdrop hidden"></div>
        <div class="modal-dialog modal-dialog-centered modal-sm">
            <div class="modal-content">

                <div class="modal-body">
                    <div class="d-flex justify-content-center">
                        <div class="spinner-border" role="status">
                            <span class="visually-hidden">Loading...</span>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>
<div class="modal fade" id="reviewRisk" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered">
        <div class="modal-content">
            <div class="container">
                @* <form asp-action="SelectPIC"> *@
                <div class="modal-body">
                    <div class="form-group">
                        <div class="row">
                            <div class="col">
                                <textarea class="form-control" id="txtReviewRisk" style="height:150px"></textarea>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <a data-toggle="tooltip" onclick="reviewRisk()" class="btn btn-outline-success">
                    Review 
                </a>
                <a class="btn btn-outline-danger" data-bs-dismiss="modal">
                    Cancel
                </a>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="approveRisk" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered">
        <div class="modal-content">
            <div class="container">
                @* <form asp-action="SelectPIC"> *@
                <div class="modal-body">
                    <div class="form-group">
                        <div class="row">
                            <div class="col">
                                <textarea class="form-control" id="txtCommentApproveRisk" style="height:150px"></textarea>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <a data-toggle="tooltip" onclick="approveRisk()" class="btn btn-outline-success">
                    Approve 
                </a>
                <a class="btn btn-outline-danger" data-bs-dismiss="modal">
                    Cancel
                </a>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="rejectRisk" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered">
        <div class="modal-content">
            <div class="container">
                @* <form asp-action="SelectPIC"> *@
                <div class="modal-body">
                    <div class="form-group">
                        <div class="row">
                            <div class="col">
                                <textarea class="form-control" id="txtCommentRejectRisk" style="height:150px"></textarea>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <a data-toggle="tooltip" onclick="rejectRisk()" class="btn btn-outline-success">
                    Reject 
                </a>
                <a class="btn btn-outline-danger" data-bs-dismiss="modal">
                    Cancel
                </a>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="picProcModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="container">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="exampleModalLabel"><b>Select People</b></h1>
                    <a class="btn btn-danger" data-bs-dismiss="modal">
                        <i class="bi bi-x-lg"></i>
                    </a>
                </div>
                @* <form asp-action="SelectPIC"> *@
                <div class="modal-body">
                    <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                    <div class="form-group">
                        <div class="row">
                            <div class="table-wrapper table-responsive-lg mt-lg-4">
                                <table class="table" style="font-size:small">
                                    <thead>
                                        <tr>
                                            <th scope="col">

                                            </th>
                                            <th scope="col">NIP</th>
                                            <th scope="col">Name</th>
                                            <th scope="col">Current Group</th>
                                            <th scope="col">Employee Email</th>
                                            <th scope="col">Domain Name</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        @foreach (var item in @ViewBag.picprocs)
                                        {
                                            <tr>
                                                <td scope="col" width="50px">
                                                    <input type="checkbox" name="IsSelected" value="@item.DomainName.Replace(" ", "")" class="form-check-input checkbox checkPIC" id="singleCheck" style="border: 1px solid;">
                                                </td>
                                                <td scope="col">@item.EmployeeNip</td>
                                                <td scope="col">@item.EmployeeName</td>
                                                <td scope="col">@item.CurrentUnit</td>
                                                <td scope="col">@item.EmployeeEmail</td>
                                                <td scope="col">@item.DomainName</td>
                                            </tr>
                                        }
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-outline-success" data-bs-dismiss="modal" onclick="valueOnCheckSubmit()">Save</button>
                    <a class="btn btn-outline-danger" data-bs-dismiss="modal">
                        Cancel
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="assignCommitteeModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="container">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="exampleModalLabel"><b>Select People</b></h1>
                    <a class="btn btn-danger" data-bs-dismiss="modal">
                        <i class="bi bi-x-lg"></i>
                    </a>
                </div>
                @* <form asp-action="SelectPIC"> *@
                <div class="modal-body">
                    <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                    <div class="row">
                        <div class="col-3">
                            <input type="search" id="search" class="form-control" >
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="row">
                            <div class="table-wrapper table-responsive-lg mt-lg-4">
                                <table class="table table-striped" style="font-size:small" id="tableCommittee">
                                    <thead>
                                        <tr>
                                            <th scope="col"></th>
                                            <th scope="col">NIP</th>
                                            <th scope="col">Name</th>
                                            <th scope="col">Current Group</th>
                                            <th scope="col">Employee Email</th>
                                            <th scope="col">Domain Name</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        @foreach (var item in @ViewBag.empbaseereq)
                                        {
                                            <tr>
                                                <td scope="col" width="50px">
                                                    <input type="checkbox" name="IsSelected" value="@item.EmailAddress;@item.Nama" class="form-check-input checkbox checkCommittee" id="singleCheckCommittee" style="border: 1px solid;">
                                                </td>
                                                <td scope="col">@item.Nip</td>
                                                <td scope="col">@item.Nama</td>
                                                <td scope="col">@item.CurrentGroup</td>
                                                <td scope="col">@item.EmailAddress</td>
                                                <td scope="col">@item.Login</td>
                                            </tr>
                                        }
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-outline-success" data-bs-dismiss="modal" onclick="valueOnCheckSubmitCommittee()">Save</button>
                    <a class="btn btn-outline-danger" data-bs-dismiss="modal">
                        Cancel
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="assignPICReasonModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="container">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="exampleModalLabel"><b>Select People</b></h1>
                    <a class="btn btn-danger" data-bs-dismiss="modal">
                        <i class="bi bi-x-lg"></i>
                    </a>
                </div>
                @* <form asp-action="SelectPIC"> *@
                <div class="modal-body">
                    <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                    <div class="row">
                        <div class="col-3">
                            <input type="search" id="searchPICReason" class="form-control" >
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="row">
                            <div class="table-wrapper table-responsive-lg mt-lg-4">
                                <table class="table table-striped" style="font-size:small" id="tablePICReason">
                                    <thead>
                                        <tr>
                                            <th scope="col"></th>
                                            <th scope="col">NIP</th>
                                            <th scope="col">Name</th>
                                            <th scope="col">Current Group</th>
                                            <th scope="col">Employee Email</th>
                                            <th scope="col">Domain Name</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        @foreach (var item in @ViewBag.picreason)
                                        {
                                            <tr>
                                                <td scope="col" width="50px">
                                                    <input type="checkbox" name="IsSelected" value="@item.EmailAddress;@item.Nama" class="form-check-input checkbox checkPICReason" id="singleCheckCommittee" style="border: 1px solid;">
                                                </td>
                                                <td scope="col">@item.Nip</td>
                                                <td scope="col">@item.Nama</td>
                                                <td scope="col">@item.CurrentGroup</td>
                                                <td scope="col">@item.EmailAddress</td>
                                                <td scope="col">@item.Login</td>
                                            </tr>
                                        }
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-outline-success" data-bs-dismiss="modal" onclick="valueOnCheckSubmitPICReason()">Save</button>
                    <a class="btn btn-outline-danger" data-bs-dismiss="modal">
                        Cancel
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="UpdateRevenue" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="container">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="exampleModalLabel"><b>Update Unit Revenue</b></h1>
                    <a class="btn btn-danger" data-bs-dismiss="modal">
                        <i class="bi bi-x-lg"></i>
                    </a>
                </div>
                @* <form asp-action="SelectPIC"> *@
                <div class="modal-body">
                    <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                    <div class="form-group">
                        <div class="row">
                            <div class="table-wrapper table-responsive-lg mt-lg-4">
                                <table class="table" style="font-size:small;vertical-align:middle">
                                    <thead style="background:darkGreen;color:white">
                                        <tr>
                                            <th scope="col">ID</th>
                                            <th scope="col">Item Desc</th>
                                            <th scope="col">Curr</th>
                                            <th scope="col">Unit COGS</th>
                                            <th scope="col">Unit Revenue</th>
                                        </tr>
                                    </thead>
                                    <tbody id="bodyUpdateRevenue">
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-outline-success" data-bs-dismiss="modal" onclick="submitValueRevenue()">Save</button>
                    <a class="btn btn-outline-danger" data-bs-dismiss="modal">
                        Cancel
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modalcsdata" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="container">
                <div class="modal-body">
                    <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                    <div class="row mt-lg-4">
                        <div class="col-3">
                            <div class="row">
                                <label class="col-form-label control-label col-3">
                                    PID :
                                </label>
                                <input type="search" id="searchcs" value="@Model.Pid" class="form-control" style="width:200px">
                            </div>
                        </div>
                        <div class="col-3">
                            <div id="loadingcs" style="display:none;">
                                <div class="spinner-border" role="status">
                                    <span class="visually-hidden">Loading...</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="row">
                            <div class="table-wrapper table-responsive-lg mt-lg-4">
                                <table class="table table-striped" style="font-size:small;vertical-align:middle">
                                    <thead style="background:darkGreen;color:white">
                                        <tr>
                                            <th scope="col">
                                                <div class="custom-control custom-checkbox">
                                                    <input type="checkbox" class="form-check-input checkbox" style="border: 1px solid;font-size: small;" id="checkAllItem">
                                                    <label class="custom-control-label" for="customCheck1">
                                                        All
                                                    </label>
                                                </div>
                                            </th>
                                            <th scope="col">Sub</th>
                                            <th scope="col">Header No</th>
                                            <th scope="col">Item Description</th>
                                            <th scope="col">Qty</th>
                                            <th scope="col">Curr</th>
                                            <th scope="col">Unit COGS</th>
                                            <th scope="col">Unit Revenue</th>
                                            <th scope="col">Total  COGS</th>
                                            <th scope="col">Total Revenue</th>
                                        </tr>
                                    </thead>
                                    <tbody id="bodyCSData">
                                        
                                        @* @foreach (var item in ViewBag.datacs)
                                        {
                                            <tr>
                                                <td scope="col" class="text-center"><input type="checkbox" class="form-check-input checkbox singleCheckItem" style="border: 1px solid;font-size: small;"></td>
                                                <td scope="col" class="text-center"><input type="checkbox" value="true" class="form-check-input checkbox txtCSSub" style="border: 1px solid;font-size: small;"></td>
                                                <td scope="col" style="text-align: -webkit-center;"><input class="form-control txtCSHeaderNo" style="width:100px" type="text" value="" /></td>
                                                <td scope="col" class="tdCSDesc">@item.Description</td>
                                                <td scope="col" class="tdCSQty">@item.Qty</td>
                                                <td scope="col" class="text-center tdCSCurr">@item.CurrCode</td>
                                                <td scope="col" class="text-end tdCSCOGS">@item.UnitCogs</td>
                                                <td scope="col" class="text-end tdCSRevenue">@item.UnitRevenue</td>
                                                <td scope="col" class="text-end tdCSTotCOGS">@item.TotalCogs</td>
                                                <td scope="col" class="text-end tdCSTotRev">@item.TotalRevenue</td>
                                                <td scope="col" class="text-end tdCSPID" hidden>@item.ProjectId</td>
                                                <td scope="col" class="text-end tdCSPIDFull" hidden>@item.Pidfull</td>
                                                <td scope="col" class="text-end tdCSNKPCode" hidden>@item.Nkpcode</td>
                                            </tr>
                                        } *@
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-outline-success" data-bs-dismiss="modal" onclick="overwriteItemDetail()">Overwrite</button>
                    <button type="submit" class="btn btn-outline-success" data-bs-dismiss="modal" onclick="appendItemDetail()">Append</button>
                    <a class="btn btn-outline-danger" data-bs-dismiss="modal">
                        Cancel
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="UpdateCOGS" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="container">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="exampleModalLabel"><b>Update Unit COGS</b></h1>
                    <a class="btn btn-danger" data-bs-dismiss="modal">
                        <i class="bi bi-x-lg"></i>
                    </a>
                </div>
                @* <form asp-action="SelectPIC"> *@
                <div class="modal-body">
                    <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                    <div class="form-group">
                        <div class="row">
                            <div class="table-wrapper table-responsive-lg mt-lg-4">
                                <table class="table" style="font-size:small;vertical-align:middle">
                                    <thead style="background:darkGreen;color:white">
                                        <tr>
                                            <th scope="col">ID</th>
                                            <th scope="col">Item Desc</th>
                                            <th scope="col">Curr</th>
                                            <th scope="col">Unit COGS</th>
                                        </tr>
                                    </thead>
                                    <tbody id="bodyUpdateCOGS">
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-outline-success" data-bs-dismiss="modal" onclick="submitValueCOGS()">Save</button>
                    <a class="btn btn-outline-danger" data-bs-dismiss="modal">
                        Cancel
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="AddPO" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-fullscreen">
        <div class="modal-content">
            @* <div class="container"> *@
                <div class="modal-header" style="justify-content: center;">
                    <h1 class="modal-title fs-5" id="exampleModalLabel"><b>Add PO Data</b></h1>
                </div>
                @* <form asp-action="SelectPIC"> *@
                <div class="modal-body">
                    <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                    <div class="row">
                        <label class="col-form-label control-label" id="labelPIDModal">PID : <b></b></label>
                    </div>
                    <div class="form-group">
                        <div class="row">
                            <div class="col-4">
                                <h6 class="text-center"><b>ITEM CS</b></h6>
                                <div class="table-wrapper table-responsive-lg mt-lg-3">
                                    <table class="table table-striped" style="font-size:small;vertical-align:middle">
                                        <thead style="background:darkGreen;color:white">
                                            <tr>
                                                <th scope="col">No.</th>
                                                <th scope="col">Item Description</th>
                                                <th scope="col">Qty</th>
                                            </tr>
                                        </thead>
                                        <tbody id="bodyAddCS">
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            <div class="col">
                                <h6 class="text-center"><b>ITEM PO</b></h6>
                                <div class="table-wrapper table-responsive-lg mt-lg-3">
                                    <table class="table" style="font-size:small;vertical-align:middle">
                                        <thead style="background:darkGreen;color:white">
                                            <tr>
                                                <th scope="col"></th>
                                                <th scope="col">PO Number</th>
                                                <th scope="col">Item Description</th>
                                                <th scope="col">NKS</th>
                                                <th scope="col">Qty</th>
                                                <th scope="col">Curr</th>
                                                <th scope="col">Unit Price</th>
                                            </tr>
                                        </thead>
                                        <tbody id="bodyAddPO">
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                <div class="loading" style="display:none;">
                    <div class="spinner-border" role="status">
                        <span class="visually-hidden">Loading...</span>
                    </div>
                </div>
                    <label class="text-red">Note: Blue Item was matched before.</label>
                    <button type="submit" class="btn btn-outline-success" data-bs-dismiss="modal" onclick="addPOData()">Update</button>
                    <a class="btn btn-outline-danger" data-bs-dismiss="modal">
                        Cancel
                    </a>
                </div>
            </div>
        @* </div> *@
    </div>
</div>

<div class="modal fade" id="UpdatePO" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-fullscreen">
        <div class="modal-content">
            @* <div class="container"> *@
                <div class="modal-header" style="justify-content: center;">
                    <h1 class="modal-title fs-5" id="exampleModalLabel"><b>Update Data</b></h1>
                </div>
                @* <form asp-action="SelectPIC"> *@
                <div class="modal-body">
                    <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                    <div class="row visbileInputType" style="display:none">
                        <div class="col">
                            <label class="col-form-label control-label">Input Type<b class='text-red'>*</b> : </label>
                        </div>
                    </div>
                    <div class="col visbileInputType" style="display:none">
                        <div class="row">
                            <div class="col-2">
                                <div class='form-check'>
                                    <input class='form-check-input txtInputType' type='radio' name='inputtype' id='multiinputpo' value='Multiple' checked> 
                                    <label class='form-check-label' for='presalesrev1'>Multiple Input</label>
                                </div> 
                            </div> 
                            <div class="col-2">
                                <div class='form-check'>
                                    <input class='form-check-input txtInputType' type='radio' name='inputtype' id='singleinputpo' value='Single'>
                                    <label class='form-check-label' for='presalesrev2'>Single Input</label>
                                </div>
                            </div>
                        </div> 
                        @* <div class="col-2">
                            <div class='form-check'>
                                <input class='form-check-input txtInputType' type='radio' name='inputtype' id='singleinput' value='Single'>
                                <label class='form-check-label' for='presalesrev2'>Single Input</label>
                            </div>
                        </div> *@
                    </div>
                    <div class="form-group">
                        <div class="row">
                            <div class="col">
                                <div class="table-wrapper table-responsive-lg mt-lg-3" style="min-height:490px">
                                    <table class="table table-striped" style="font-size:small;vertical-align:middle">
                                        <thead style="background:darkGreen;color:white">
                                            <tr>
                                                <th scope="col">No</th>
                                                <th scope="col">PID</th>
                                                <th scope="col">Item Description</th>
                                                <th scope="col">Qty</th>
                                                <th scope="col">PO Data</th>
                                                <th scope="col">MLPT PO </th>
                                                <th scope="col">GRN</th>
                                            </tr>
                                        </thead>
                                        <tbody id="bodyUpdatePO">
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer footerUpdatePO">
                    <div class="col">
                        <div class="row" >
                            <div class="col-2 visGroup1" style="display:none">
                                <label class="col-form-label control-label">Expected PO Issued Date : </label>
                            </div>
                            <div class="col-2 visGroup1" style="display:none">
                                <input class="form-control" style="width:150px" type="date" value="" id="txtExpPODateSingle">
                            </div>
                            <div class="col-1 visGroup1" style="display:none">
                                <label class="col-form-label control-label">ETD : </label>
                            </div>
                            <div class="col-2 visGroup1" style="display:none">
                                <input class="form-control" style="width:150px" type="date" value="" id="txtETDSingle">
                            </div>
                            <div class="col-1 visGroup2" style="display:none">
                                <label class="col-form-label control-label">PO Qty : </label>
                            </div>
                            <div class="col-2 visGroup2" style="display:none">
                                <input class="form-control" style="width:150px" type="text" value="" id="txtPOQtySingle">
                            </div>
                            <div class="col-1 visGroup2" style="display:none">
                                <label class="col-form-label control-label">ETA : </label>
                            </div>
                            <div class="col-2 visGroup2" style="display:none">
                                <input class="form-control" style="width:150px" type="date" value="" id="txtETASingle">
                            </div>
                        </div>
                    </div>
                    <div class="loading" style="display:none;">
                        <div class="spinner-border" role="status">
                            <span class="visually-hidden">Loading...</span>
                        </div>
                    </div>
                    <button type="submit" class="btn btn-outline-secondary" onclick="showPOData('PO')" id="btn-select-item">Select Item</button>
                    <button type="submit" class="btn btn-outline-success" data-bs-dismiss="modal" onclick="updatePOData()" style="display:none" id="submit-update-po">Update</button>
                    <a class="btn btn-outline-danger" data-bs-dismiss="modal">
                        Cancel
                    </a>
                </div>
            </div>
        @* </div> *@
    </div>
</div>

<div class="modal fade" id="UpdateGR" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-fullscreen">
        <div class="modal-content">
            @* <div class="container"> *@
                <div class="modal-header" style="justify-content: center;">
                    <h1 class="modal-title fs-5" id="exampleModalLabel"><b>Update Data</b></h1>
                </div>
                @* <form asp-action="SelectPIC"> *@
                <div class="modal-body">
                    <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                    <div class="row visbileInputType" style="display:none">
                        <div class="col">
                            <label class="col-form-label control-label">Input Type<b class='text-red'>*</b> : </label>
                        </div>
                    </div>
                    <div class="col visbileInputType" style="display:none">
                        <div class="row">
                            <div class="col-2">
                                <div class='form-check'>
                                    <input class='form-check-input txtInputType' type='radio' name='inputtype' id='multiinputgr' value='Multiple' checked> 
                                    <label class='form-check-label' for='presalesrev1'>Multiple Input</label>
                                </div> 
                            </div> 
                            <div class="col-2">
                                <div class='form-check'>
                                    <input class='form-check-input txtInputType' type='radio' name='inputtype' id='singleinputgr' value='Single'>
                                    <label class='form-check-label' for='presalesrev2'>Single Input</label>
                                </div>
                            </div>
                        </div> 
                        @* <div class="col-2">
                            <div class='form-check'>
                                <input class='form-check-input txtInputType' type='radio' name='inputtype' id='singleinput' value='Single'>
                                <label class='form-check-label' for='presalesrev2'>Single Input</label>
                            </div>
                        </div> *@
                    </div>
                    <div class="form-group">
                        <div class="row">
                            <div class="col">
                                <div class="table-wrapper table-responsive-lg mt-lg-3" style="min-height:490px">
                                    <table class="table table-striped" style="font-size:small;vertical-align:middle">
                                        <thead style="background:darkGreen;color:white">
                                            <tr>
                                                <th scope="col">No</th>
                                                <th scope="col">PID</th>
                                                <th scope="col">Item Description</th>
                                                <th scope="col">Qty</th>
                                                <th scope="col">PO Data</th>
                                                <th scope="col">MLPT PO </th>
                                                <th scope="col">GRN</th>
                                            </tr>
                                        </thead>
                                        <tbody id="bodyUpdateGR">
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer footerUpdateGR">
                    <div class="col">
                        <div class="row" >
                            <div class="col-1 visGroup1" style="display:none">
                                <label class="col-form-label control-label">GR Date : </label>
                            </div>
                            <div class="col-2 visGroup1" style="display:none">
                                <input class="form-control" style="width:150px" type="date" value="" id="txtGRDateSingle">
                            </div>
                            <div class="col-1 visGroup1" style="display:none">
                                <label class="col-form-label control-label">GR Qty : </label>
                            </div>
                            <div class="col-2 visGroup1" style="display:none">
                                <input class="form-control" style="width:150px" type="text" value="" id="txtGRQtySingle">
                            </div>
                        </div>
                    </div>
                    <div class="loading" style="display:none;">
                        <div class="spinner-border" role="status">
                            <span class="visually-hidden">Loading...</span>
                        </div>
                    </div>
                    <button type="submit" class="btn btn-outline-secondary" onclick="showPOData('GR')" id="btn-select-item">Select Item</button>
                    <button type="submit" class="btn btn-outline-success" data-bs-dismiss="modal" onclick="updateGRData()" style="display:none" id="submit-update-gr">Update</button>
                    <a class="btn btn-outline-danger" data-bs-dismiss="modal">
                        Cancel
                    </a>
                </div>
            </div>
        @* </div> *@
    </div>
</div>

<div class="modal fade" id="BrowsePO" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered">
        <div class="modal-content">
            <div class="container">
                @* <form asp-action="SelectPIC"> *@
                <div class="modal-body">
                    <div class="form-group">
                        <div class="row">
                            <div class="col">
                                <div class="table-wrapper table-responsive-lg mt-lg-3" style="min-height:350px">
                                    <table class="table table-striped" style="font-size:small;vertical-align:middle">
                                        <thead style="background:darkGreen;color:white">
                                            <tr>
                                                <th scope="col"></th>
                                                <th scope="col">PID</th>
                                                <th scope="col">PO Number</th>
                                                <th scope="col">Item Description</th>
                                                <th scope="col">PO Date</th>
                                            </tr>
                                        </thead>
                                        <tbody id="bodyBrowsePO">
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <a class="btn btn-outline-danger" data-bs-dismiss="modal">
                    Cancel
                </a>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="UpdateRisk" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="container">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="exampleModalLabel"><b>Update Risk</b></h1>
                    <a class="btn btn-danger" data-bs-dismiss="modal">
                        <i class="bi bi-x-lg"></i>
                    </a>
                </div>
                @* <form asp-action="SelectPIC"> *@
                <div class="modal-body">
                    <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                    <div class="form-group">
                        <div class="row">
                            <div class="table-wrapper table-responsive-lg mt-lg-4">
                                <table class="table" style="font-size:small;vertical-align:middle">
                                    <thead style="background:darkGreen;color:white">
                                        <tr>
                                            <th scope="col">ID</th>
                                            <th scope="col">Item Desc</th>
                                            <th scope="col">Risk</th>
                                        </tr>
                                    </thead>
                                    <tbody id="bodyUpdateRisk">
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-outline-success" data-bs-dismiss="modal" onclick="submitValueRisk()">Update</button>
                    <a class="btn btn-outline-danger" data-bs-dismiss="modal">
                        Cancel
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="UpdateReview" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="container">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="exampleModalLabel"><b>Review Items</b></h1>
                    <a class="btn btn-danger" data-bs-dismiss="modal">
                        <i class="bi bi-x-lg"></i>
                    </a>
                </div>
                @* <form asp-action="SelectPIC"> *@
                <div class="modal-body">
                    <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                    <div class="form-group">
                        <div class="row">
                            <div class="table-wrapper table-responsive-lg mt-lg-4">
                                <table class="table" style="font-size:small;vertical-align:middle">
                                    <thead style="background:darkGreen;color:white">
                                        <tr>
                                            <th scope="col">ID</th>
                                            <th scope="col">Item Desc</th>
                                            <th scope="col">Review</th>
                                        </tr>
                                    </thead>
                                    <tbody id="bodyUpdateReview">
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-outline-success" data-bs-dismiss="modal" onclick="submitValueReview()">Review</button>
                    <a class="btn btn-outline-danger" data-bs-dismiss="modal">
                        Cancel
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="AssignPM" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="container">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="exampleModalLabel"><b>Assign Product Manager</b></h1>
                    <a class="btn btn-danger" data-bs-dismiss="modal">
                        <i class="bi bi-x-lg"></i>
                    </a>
                </div>
                @* <form asp-action="SelectPIC"> *@
                <div class="modal-body">
                    <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                    <div class="form-group">
                        <div class="row">
                            <div class="table-wrapper table-responsive-lg mt-lg-4">
                                <table class="table" style="font-size:small;vertical-align:middle">
                                    <thead style="background:darkGreen;color:white">
                                        <tr>
                                            <th scope="col">ID</th>
                                            <th scope="col">Item Desc</th>
                                            <th scope="col">Product Manager</th>
                                        </tr>
                                    </thead>
                                    <tbody id="bodyAssignPM">
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-outline-success" data-bs-dismiss="modal" onclick="submitValuePM()">Assign</button>
                    <a class="btn btn-outline-danger" data-bs-dismiss="modal">
                        Cancel
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="uploadExcelItems" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="container">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="exampleModalLabel"><b>Upload Items</b></h1>
                    <a class="btn btn-danger" id="closeModalUpload" data-bs-dismiss="modal">
                        <i class="bi bi-x-lg"></i>
                    </a>
                </div>
                @* <form asp-action="SelectPIC"> *@
                <div class="modal-body">
                    <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                    <div class="form-group">
                        <div class="row">
                            <label class="col-form-label control-label">Please upload item based on template only</label>
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="row">
                            <div class="col-6">
                                <input type="file" name="fileUpload" class="form-control" id="fileUpload" aria-describedby="inputGroupFileAddon04" aria-label="Upload">
                                <input type="hidden" name="preprocid" class="form-control" id="preprocid" aria-describedby="inputGroupFileAddon04" value="@Model.Id">
                            </div>
                            <div class="col-6">
                                <label class="col-form-label control-label">
                                    Or Download
                                    @Html.ActionLink("Template", "GetTemplate", new { controller = "PreProcs"}, new { target = "_blank", @class="btn-outline-primary" })
                                </label>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-6">
                                <label id="errorFormatExt" hidden class="col-form-label control-label text-danger">
                                    Error! File must be using format template
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                
                <a data-toggle="tooltip" onclick="uploadexcelfile()" class="btn btn-outline-success">
                    Upload 
                    
                </a>
                <div id="myLoadingElement" style="display:none;">
                    <div class="spinner-border" role="status">
                        <span class="visually-hidden">Loading...</span>
                    </div>
                </div>
                @*  <a asp-area="" data-toggle="tooltip" asp-controller="PreProcs" asp-action="ExcelToDataTable" asp-route-id="@Model.Id" class="btn btn-outline-secondary">
                Upload
                </a> *@
                <a class="btn btn-outline-danger" data-bs-dismiss="modal">
                    Cancel
                </a>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modalassignpmo" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="container">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="exampleModalLabel"><b>Assign PMO</b></h1>
                    <a class="btn btn-danger" id="closeModalUpload" data-bs-dismiss="modal">
                        <i class="bi bi-x-lg"></i>
                    </a>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <div class="row">
                            <div class="col">
                                <textarea class="form-control" id="txtNoteAssignPMPC" style="height:150px" placeholder="Please note ..."></textarea>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <a data-toggle="tooltip" onclick="sendNotiftoPMPC()" class="btn btn-outline-success">
                    Send 
                </a>
                <a class="btn btn-outline-danger" data-bs-dismiss="modal">
                    Cancel
                </a>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modalremindprocwh" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="container">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="exampleModalLabel"><b>Reminder to Procurement and/or Warehouse</b></h1>
                    <a class="btn btn-danger" id="closeModalUpload" data-bs-dismiss="modal">
                        <i class="bi bi-x-lg"></i>
                    </a>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <div class="row">
                            <div class="col-2" id="divRemindProcWH">
                                <label class="col-form-label control-label" id="labelToProcWH">
                                    To : 
                                </label>
                                <span class="text-danger"></span>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-8">
                                 <textarea class="form-control" id="resultSelectedProcWH" style="width:500px;height:80px">@ViewBag.picname</textarea>
                            </div>
                            <div class="col-3">
                                <a class="btn btn-outline-secondary" id="btnSelectRecipientProcWHModal" data-bs-toggle="modal" data-bs-target="#SelectRecipientProcWHModal">
                                    Select Recipient
                                </a>
                            </div>
                            <div class="col-4" hidden id="divResultSelectedProcWHEmail">
                                <textarea class="form-control" id="resultSelectedProcWHEmail">@Model.PicProc
                                </textarea>
                            </div>
                        </div>
                        <div class="row mt-lg-4">
                            <div class="col">
                                <textarea class="form-control" id="txtNoteRemindProcWH" style="height:150px"></textarea>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <a data-toggle="tooltip" onclick="sendNotifbyType('RemindProcWH')" class="btn btn-outline-success">
                    Send 
                </a>
                <a class="btn btn-outline-danger" data-bs-dismiss="modal">
                    Cancel
                </a>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modalexcpttofinance" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="container">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="exampleModalLabel"><b>Exception To Finance</b></h1>
                    <a class="btn btn-danger" id="closeModalUpload" data-bs-dismiss="modal">
                        <i class="bi bi-x-lg"></i>
                    </a>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <div class="row">
                            <div class="col-2" id="divExcptToFinance">
                                <label class="col-form-label control-label" id="labelToExcptFinance">
                                    To :
                                </label>
                                <span class="text-danger"></span>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-8">
                                <textarea class="form-control" id="resultSelectedExcptFinance" style="width:500px;height:80px">
                                    @foreach (var item in @ViewBag.financehead)
                                        {
                                            @item.Nama <text>;</text>
                                        }
                                </textarea>
                            </div>
                            <div class="col-3">
                                <a class="btn btn-outline-secondary" id="btnSelectRecipientExcptFinanceModal" data-bs-toggle="modal" data-bs-target="#SelectRecipientExcptFinanceModal">
                                    Select Recipient
                                </a>
                            </div>
                            <div class="col-4" hidden id="divResultSelectedtExcptFinanceEmail">
                                <textarea class="form-control" id="resultSelectedtExcptFinanceEmail">
                                    @foreach (var item in @ViewBag.financehead)
                                        {
                                            @item.EmailAddress<text>;</text>
                                        }
                                </textarea>
                            </div>
                        </div>
                        <div class="row mt-lg-4">
                            <div class="col">
                                <textarea class="form-control" id="txtNoteExcptFinance" style="height:150px"></textarea>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <a data-toggle="tooltip" onclick="sendNotifStagePresales('Parameter Email Excpt To Finance')" class="btn btn-outline-success">
                    Send
                </a>
                <a class="btn btn-outline-danger" data-bs-dismiss="modal">
                    Cancel
                </a>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modalpurchasereq" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="container">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="exampleModalLabel"><b>Purchase Requisition</b></h1>
                    <a class="btn btn-danger" id="closeModalUpload" data-bs-dismiss="modal">
                        <i class="bi bi-x-lg"></i>
                    </a>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <div class="row">
                            <div class="col-2" id="divPurchaseReq">
                                <label class="col-form-label control-label" id="labelToPurchaseReq">
                                    To : 
                                </label>
                                <span class="text-danger"></span>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-8">
                                 <textarea class="form-control" id="resultSelectedPurchaseReq" style="width:500px;height:80px">@ViewBag.picname</textarea>
                            </div>
                            <div class="col-3">
                                <a class="btn btn-outline-secondary" id="btnSelectRecipientPurchaseReqModal" data-bs-toggle="modal" data-bs-target="#SelectRecipientPurchaseReqModal">
                                    Select Recipient
                                </a>
                            </div>
                            <div class="col-4" hidden id="divResultSelectedPurchaseReqEmail">
                                <textarea class="form-control" id="resultSelectedPurchaseReqEmail">@Model.PicProc
                                </textarea>
                            </div>
                        </div>
                        <div class="row mt-lg-4">
                            <div class="col">
                                <textarea class="form-control" id="txtNoteRemindPurchaseReq" style="height:150px"></textarea>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <a data-toggle="tooltip" onclick="sendNotifbyType('PurchaseReq')" class="btn btn-outline-success">
                    Send 
                </a>
                <a class="btn btn-outline-danger" data-bs-dismiss="modal">
                    Cancel
                </a>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="uploadSpec" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="container">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="exampleModalLabel"><b>Upload Specification</b></h1>
                    <a class="btn btn-danger" id="closeModalUpload" data-bs-dismiss="modal">
                        <i class="bi bi-x-lg"></i>
                    </a>
                </div>
                @* <form asp-action="SelectPIC"> *@
                <div class="modal-body">
                    <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                    <div class="form-group">
                        <div class="row">
                            <div class="col-6" id="idAttachSpec">
                                <input type="file" name="fileUploadspec" class="form-control" id="fileUploadspec" aria-describedby="inputGroupFileAddon04" aria-label="Upload" multiple>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                @*  <button type="submit" class="btn btn-outline-success" data-bs-dismiss="modal" onclick="uploadcsvfile()">Upload</button> *@
                <a data-toggle="tooltip" data-id="wqewqeqwe" onclick="uploadspecfile()" data-bs-dismiss="modal" class="btn btn-outline-success">
                    Upload
                </a>
                @*  <a asp-area="" data-toggle="tooltip" asp-controller="PreProcs" asp-action="ExcelToDataTable" asp-route-id="@Model.Id" class="btn btn-outline-secondary">
                Upload
                </a> *@
                <a class="btn btn-outline-danger" data-bs-dismiss="modal">
                    Cancel
                </a>
            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="uploadSurDuk" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="container">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="exampleModalLabel"><b>Upload Surat Dukungan</b></h1>
                    <a class="btn btn-danger" id="closeModalUpload" data-bs-dismiss="modal">
                        <i class="bi bi-x-lg"></i>
                    </a>
                </div>
                @* <form asp-action="SelectPIC"> *@
                <div class="modal-body">
                    <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                    <div class="form-group">
                        <div class="row">
                            <div class="col-6" id="idAttachSurDuk">
                                <input type="file" name="fileUploadsurduk" class="form-control" id="fileUploadsurduk" aria-describedby="inputGroupFileAddon04" aria-label="Upload" multiple>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                @*  <button type="submit" class="btn btn-outline-success" data-bs-dismiss="modal" onclick="uploadcsvfile()">Upload</button> *@
                <a data-toggle="tooltip" data-id="sadsada" onclick="uploadsurdukfile()" data-bs-dismiss="modal" class="btn btn-outline-success">
                    Upload
                </a>
                @*  <a asp-area="" data-toggle="tooltip" asp-controller="PreProcs" asp-action="ExcelToDataTable" asp-route-id="@Model.Id" class="btn btn-outline-secondary">
                Upload
                </a> *@
                <a class="btn btn-outline-danger" data-bs-dismiss="modal">
                    Cancel
                </a>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="uploadVendorQuot" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="container">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="exampleModalLabel"><b>Upload Vendor Quotation</b></h1>
                    <a class="btn btn-danger" id="closeModalUpload" data-bs-dismiss="modal">
                        <i class="bi bi-x-lg"></i>
                    </a>
                </div>
                @* <form asp-action="SelectPIC"> *@
                <div class="modal-body">
                    <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                    <div class="form-group">
                        <div class="row">
                            <div class="col-6" id="idAttachVendorQuot">
                                <input type="file" name="fileUploadvendorquot" class="form-control" id="fileUploadvendorquot" aria-describedby="inputGroupFileAddon04" aria-label="Upload" multiple>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                @*  <button type="submit" class="btn btn-outline-success" data-bs-dismiss="modal" onclick="uploadcsvfile()">Upload</button> *@
                <a data-toggle="tooltip" data-id="wqewqeqwe" onclick="uploadvendorquotfile()" data-bs-dismiss="modal" class="btn btn-outline-success">
                    Upload
                </a>
                @*  <a asp-area="" data-toggle="tooltip" asp-controller="PreProcs" asp-action="ExcelToDataTable" asp-route-id="@Model.Id" class="btn btn-outline-secondary">
                Upload
                </a> *@
                <a class="btn btn-outline-danger" data-bs-dismiss="modal">
                    Cancel
                </a>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="uploadGRN" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="container">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="exampleModalLabel"><b>Upload GRN</b></h1>
                    <a class="btn btn-danger" id="closeModalUpload" data-bs-dismiss="modal">
                        <i class="bi bi-x-lg"></i>
                    </a>
                </div>
                @* <form asp-action="SelectPIC"> *@
                <div class="modal-body">
                    <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                    <div class="form-group">
                        <div class="row">
                            <div id="idAttachGRN">
                               
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <a data-toggle="tooltip" data-id="sadsada" onclick="uploadgrnfile()" data-bs-dismiss="modal" class="btn btn-outline-success">
                    Upload
                </a>
                <a class="btn btn-outline-danger" data-bs-dismiss="modal">
                    Cancel
                </a>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="bodModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="container">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="exampleModalLabel"><b>Select People</b></h1>
                    <a class="btn btn-danger" data-bs-dismiss="modal">
                        <i class="bi bi-x-lg"></i>
                    </a>
                </div>
                <div class="modal-body">
                    <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                    <div class="form-group">
                        <div class="row">
                            <div class="table-wrapper table-responsive-lg mt-lg-4">
                                <table class="table" style="font-size:small">
                                    <thead>
                                        <tr>
                                            <th scope="col">

                                            </th>
                                            <th scope="col">NIP</th>
                                            <th scope="col">Name</th>
                                            <th scope="col">Current Group</th>
                                            <th scope="col">Employee Email</th>
                                            <th scope="col">Domain Name</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        @foreach (var item in @ViewBag.bod)
                                        {
                                            <tr>
                                                <td scope="col" width="50px">
                                                    <input type="checkbox" name="IsSelected" value="@item.EmailAddress;@item.Nama" class="form-check-input checkbox checkBOD" id="singleCheckBOD" style="border: 1px solid;">
                                                </td>
                                                <td scope="col">@item.Nip</td>
                                                <td scope="col">@item.Nama</td>
                                                <td scope="col">@item.CurrentGroup</td>
                                                <td scope="col">@item.EmailAddress</td>
                                                <td scope="col">@item.Login</td>
                                            </tr>
                                        }
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-outline-success" data-bs-dismiss="modal" onclick="valueOnCheckSubmitBOD()">Save</button>
                    <a class="btn btn-outline-danger" data-bs-dismiss="modal">
                        Cancel
                    </a>
                </div>
                @* </form> *@
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="SelectRecipientProcWHModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="container">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="exampleModalLabel"><b>Select People</b></h1>
                    <a class="btn btn-danger" data-bs-dismiss="modal">
                        <i class="bi bi-x-lg"></i>
                    </a>
                </div>
                <div class="modal-body">
                    <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                    <div class="form-group">
                        <div class="row">
                            <div class="table-wrapper table-responsive-lg mt-lg-4">
                                <table class="table" style="font-size:small">
                                    <thead>
                                        <tr>
                                            <th scope="col">

                                            </th>
                                            <th scope="col">NIP</th>
                                            <th scope="col">Name</th>
                                            <th scope="col">Current Group</th>
                                            <th scope="col" >Employee Email</th>
                                            <th scope="col" >Domain Name</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        @foreach (var item in @ViewBag.picprocs)
                                        {
                                            <tr>
                                                <td scope="col" width="50px">
                                                    <input type="checkbox" name="IsSelected" value="@item.EmployeeEmail;@item.EmployeeName" class="form-check-input checkbox checkProcWH" id="singleCheckProcWH" style="border: 1px solid;">
                                                </td>
                                                <td scope="col">@item.EmployeeNip</td>
                                                <td scope="col">@item.EmployeeName</td>
                                                <td scope="col">@item.CurrentUnit</td>
                                                <td scope="col" class="Email">@item.EmployeeEmail</td>
                                                <td scope="col" class="Domain">@item.DomainName</td>
                                            </tr>
                                        }
                                        @foreach (var item in @ViewBag.warehouse)
                                        {
                                            <tr>
                                                <td scope="col" width="50px">
                                                    <input type="checkbox" name="IsSelected" value="@item.EmployeeEmail;@item.EmployeeName" class="form-check-input checkbox checkProcWH" id="singleCheckProcWH" style="border: 1px solid;">
                                                </td>
                                                <td scope="col">@item.EmployeeNip</td>
                                                <td scope="col">@item.EmployeeName</td>
                                                <td scope="col">@item.CurrentUnit</td>
                                                <td scope="col" class="Email">@item.EmployeeEmail</td>
                                                <td scope="col" class="Domain">@item.DomainName</td>
                                            </tr>
                                        }
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-outline-success" data-bs-dismiss="modal" onclick="valueOnCheckProcWH()">Save</button>
                    <a class="btn btn-outline-danger" data-bs-dismiss="modal">
                        Cancel
                    </a>
                </div>
                @* </form> *@
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="SelectRecipientPurchaseReqModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="container">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="exampleModalLabel"><b>Select People</b></h1>
                    <a class="btn btn-danger" data-bs-dismiss="modal">
                        <i class="bi bi-x-lg"></i>
                    </a>
                </div>
                <div class="modal-body">
                    <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                    <div class="form-group">
                        <div class="row">
                            <div class="table-wrapper table-responsive-lg mt-lg-4">
                                <table class="table" style="font-size:small">
                                    <thead>
                                        <tr>
                                            <th scope="col">

                                            </th>
                                            <th scope="col">NIP</th>
                                            <th scope="col">Name</th>
                                            <th scope="col">Current Group</th>
                                            <th scope="col" >Employee Email</th>
                                            <th scope="col" >Domain Name</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        @foreach (var item in @ViewBag.picprocs)
                                        {
                                            <tr>
                                                <td scope="col" width="50px">
                                                    <input type="checkbox" name="IsSelected" value="@item.EmployeeEmail;@item.EmployeeName" class="form-check-input checkbox checkProcPS" id="singleCheckProcPS" style="border: 1px solid;">
                                                </td>
                                                <td scope="col">@item.EmployeeNip</td>
                                                <td scope="col">@item.EmployeeName</td>
                                                <td scope="col">@item.CurrentUnit</td>
                                                <td scope="col" class="Email">@item.EmployeeEmail</td>
                                                <td scope="col" class="Domain">@item.DomainName</td>
                                            </tr>
                                        }
                                        @foreach (var item in @ViewBag.projectsupp)
                                        {
                                            <tr>
                                                <td scope="col" width="50px">
                                                    <input type="checkbox" name="IsSelected" value="@item.EmployeeEmail;@item.EmployeeName" class="form-check-input checkbox checkProcPS" id="singleCheckProcPS" style="border: 1px solid;">
                                                </td>
                                                <td scope="col">@item.EmployeeNip</td>
                                                <td scope="col">@item.EmployeeName</td>
                                                <td scope="col">@item.CurrentUnit</td>
                                                <td scope="col" class="Email">@item.EmployeeEmail</td>
                                                <td scope="col" class="Domain">@item.DomainName</td>
                                            </tr>
                                        }
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-outline-success" data-bs-dismiss="modal" onclick="valueOnCheckPurchaseReq()">Save</button>
                    <a class="btn btn-outline-danger" data-bs-dismiss="modal">
                        Cancel
                    </a>
                </div>
                @* </form> *@
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="SelectRecipientExcptFinanceModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="container">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="exampleModalLabel"><b>Select People</b></h1>
                    <a class="btn btn-danger" data-bs-dismiss="modal">
                        <i class="bi bi-x-lg"></i>
                    </a>
                </div>
                <div class="modal-body">
                    <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                    <div class="form-group">
                        <div class="row">
                            <div class="table-wrapper table-responsive-lg mt-lg-4">
                                <table class="table" style="font-size:small">
                                    <thead>
                                        <tr>
                                            <th scope="col">

                                            </th>
                                            <th scope="col">NIP</th>
                                            <th scope="col">Name</th>
                                            <th scope="col">Current Group</th>
                                            <th scope="col" >Employee Email</th>
                                            <th scope="col" >Domain Name</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        @foreach (var item in @ViewBag.finance)
                                        {
                                            <tr>
                                                <td scope="col" width="50px">
                                                    <input type="checkbox" name="IsSelected" value="@item.EmailAddress;@item.Nama" class="form-check-input checkbox checkFinance" id="singlecheckFinance" style="border: 1px solid;">
                                                </td>
                                                <td scope="col">@item.Nip</td>
                                                <td scope="col">@item.Nama</td>
                                                <td scope="col">@item.CurrentGroup</td>
                                                <td scope="col" class="Email">@item.EmailAddress</td>
                                                <td scope="col" class="Domain">@item.Login</td>
                                            </tr>
                                        }
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-outline-success" data-bs-dismiss="modal" onclick="valueOnCheckFinance()">Save</button>
                    <a class="btn btn-outline-danger" data-bs-dismiss="modal">
                        Cancel
                    </a>
                </div>
                @* </form> *@
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="attachmentModalRFP" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content">
            <div class="container">
                @* <form asp-action="SelectPIC"> *@
                <div class="modal-body">
                    <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                    <div class="form-group">
                        <div class="row">
                            <div class="col">
                                <label class="col-form-label control-label" id="labelToPurchaseReq">
                                    To download latest version of this document, click on the button below
                                </label>
                                <span class="text-danger"></span>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col">
                                @* @Html.ActionLink(FileNameQuot, "GetFileAttachment", new { controller = "PreProcs",
                                target =  @ViewBag.attachQuot.StrictedFileName + ";" + FileNameQuot }, new { target = "_blank", @class="btn-outline-primary" }) *@
                                @if (FileNameRFP != null)
                                {
                                    <a class="btn btn-outline-secondary" asp-controller="PreProcs" asp-action="GetFileAttachment" asp-route-target="@ViewBag.attachRFP[0].StrictedFileName;@FileNameRFP">
                                        Download
                                    </a>
                                }

                            </div>
                        </div>
                        <form asp-action="GetFileAttachment" asp-controller="PreProcs" method="get">
                            <div class="row">
                                <div class="col">
                                    <label class="col-form-label control-label" id="labelToPurchaseReq">
                                        To download specified version. Choose the version you want <i class="bi bi-caret-down-square"></i> and click on Download Version below
                                    </label>
                                    <span class="text-danger"></span>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-1">
                                    @{
                                        var countrfp = @ViewBag.attachRFP.Count;
                                    }
                                    <select class='form-select form-control' style='width: 63px' id='downVerRFP' runat='server' name='downVerRFP'>
                                        @foreach (var item in @ViewBag.attachRFP)
                                        {
                                            <option value='@item.StrictedFileName'> @countrfp</option>
                                            countrfp--;
                                        }
                                    </select>
                                </div>
                                <div class="col-4">
                                    @* <a class="btn btn-outline-secondary" id="btn-down-ver-rfp" style="width: 200px">
                                    Download Version
                                    </a>  *@
                                    <button type="submit" class="btn btn-outline-secondary" style="width: 200px">Download Version</button>
                                </div>
                            </div>
                        </form>
                    </div>

                </div>
                <div class="modal-footer">
                </div>
                @* </form> *@
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="attachmentModalBOQ" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content">
            <div class="container">
                <div class="modal-body">
                    <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                    <div class="form-group">
                        <div class="row">
                            <div class="col">
                                <label class="col-form-label control-label" id="labelToPurchaseReq">
                                    To download latest version of this document, click on the button below
                                </label>
                                <span class="text-danger"></span>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col">
                                @if (FileNameBOQ != null)
                                {
                                    <a class="btn btn-outline-secondary" asp-controller="PreProcs" asp-action="GetFileAttachment" asp-route-target="@ViewBag.attachBOQ[0].StrictedFileName;@FileNameBOQ">
                                        Download
                                    </a>
                                }

                            </div>
                        </div>
                        <form asp-action="GetFileAttachment" asp-controller="PreProcs" method="get">
                            <div class="row">
                                <div class="col">
                                    <label class="col-form-label control-label" id="labelToPurchaseReq">
                                        To download specified version. Choose the version you want <i class="bi bi-caret-down-square"></i> and click on Download Version below
                                    </label>
                                    <span class="text-danger"></span>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-1">
                                    @{
                                        var countboq = @ViewBag.attachBOQ.Count;
                                    }
                                    <select class='form-select form-control' style='width: 63px' id='downVerRFP' runat='server' name='downVerBOQ'>
                                        @foreach (var item in @ViewBag.attachBOQ)
                                        {
                                            <option value='@item.StrictedFileName'> @countboq</option>
                                            countboq--;
                                        }
                                    </select>
                                </div>
                                <div class="col-4">
                                    @* <a class="btn btn-outline-secondary" id="btn-down-ver-rfp" style="width: 200px">
                                    Download Version
                                    </a>  *@
                                    <button type="submit" class="btn btn-outline-secondary" style="width: 200px">Download Version</button>
                                </div>
                            </div>
                        </form>
                    </div>

                </div>
                <div class="modal-footer">
                </div>
                @* </form> *@
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="attachmentModalQuot" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content">
            <div class="container">
                @* <form asp-action="SelectPIC"> *@
                <div class="modal-body">
                    <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                    <div class="form-group">
                        <div class="row">
                            <div class="col">
                                <label class="col-form-label control-label" id="labelToPurchaseReq">
                                    To download latest version of this document, click on the button below
                                </label>
                                <span class="text-danger"></span>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col">
                                @* @Html.ActionLink(FileNameQuot, "GetFileAttachment", new { controller = "PreProcs",
                                target =  @ViewBag.attachQuot.StrictedFileName + ";" + FileNameQuot }, new { target = "_blank", @class="btn-outline-primary" }) *@
                                @if (FileNameQuot != null)
                                {
                                    <a class="btn btn-outline-secondary" asp-controller="PreProcs" asp-action="GetFileAttachment" asp-route-target="@ViewBag.attachQuot[0].StrictedFileName;@FileNameQuot">
                                        Download
                                    </a>
                                }

                            </div>
                        </div>
                        <form asp-action="GetFileAttachment" asp-controller="PreProcs" method="get">
                            <div class="row">
                                <div class="col">
                                    <label class="col-form-label control-label" id="labelToPurchaseReq">
                                        To download specified version. Choose the version you want <i class="bi bi-caret-down-square"></i> and click on Download Version below
                                    </label>
                                    <span class="text-danger"></span>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-1">
                                    @{
                                        var countquot = @ViewBag.attachQuot.Count;
                                    }
                                    <select class='form-select form-control' style='width: 63px' id='downVerQuot' runat='server' name='downVerQuot'>
                                        @foreach (var item in @ViewBag.attachQuot)
                                        {
                                            <option value='@item.StrictedFileName'> @countquot</option>
                                            countquot--;
                                        }
                                    </select>
                                </div>
                                <div class="col-4">
                                    <button type="submit" class="btn btn-outline-secondary" style="width: 200px">Download Version</button>
                                </div>
                            </div>
                        </form>
                    </div>

                </div>
                <div class="modal-footer">
                </div>
                @* </form> *@
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="attachmentModalGP" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content">
            <div class="container">
                @* <form asp-action="SelectPIC"> *@
                <div class="modal-body">
                    <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                    <div class="form-group">
                        <div class="row">
                            <div class="col">
                                <label class="col-form-label control-label" id="labelToPurchaseReq">
                                    To download latest version of this document, click on the button below
                                </label>
                                <span class="text-danger"></span>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col">
                                @* @Html.ActionLink(FileNameQuot, "GetFileAttachment", new { controller = "PreProcs",
                                target =  @ViewBag.attachQuot.StrictedFileName + ";" + FileNameQuot }, new { target = "_blank", @class="btn-outline-primary" }) *@
                                @if (FileNameGP != null)
                                {
                                    <a class="btn btn-outline-secondary" asp-controller="PreProcs" asp-action="GetFileAttachment" asp-route-target="@ViewBag.attachGP[0].StrictedFileName;@FileNameGP">
                                        Download
                                    </a>
                                }

                            </div>
                        </div>
                        <form asp-action="GetFileAttachment" asp-controller="PreProcs" method="get">
                            <div class="row">
                                <div class="col">
                                    <label class="col-form-label control-label" id="labelToPurchaseReq">
                                        To download specified version. Choose the version you want <i class="bi bi-caret-down-square"></i> and click on Download Version below
                                    </label>
                                    <span class="text-danger"></span>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-1">
                                    @{
                                        var countgp = @ViewBag.attachGP.Count;
                                    }
                                    <select class='form-select form-control' style='width: 63px' id='downVerGP' runat='server' name='downVerGP'>
                                        @foreach (var item in @ViewBag.attachGP)
                                        {
                                            <option value='@item.StrictedFileName'> @countgp</option>
                                            countgp--;
                                        }
                                    </select>
                                </div>
                                <div class="col-4">
                                    @* <a class="btn btn-outline-secondary" id="btn-down-ver-rfp" style="width: 200px">
                                    Download Version
                                    </a>  *@
                                    <button type="submit" class="btn btn-outline-secondary" style="width: 200px">Download Version</button>
                                </div>
                            </div>
                        </form>
                    </div>

                </div>
                <div class="modal-footer">
                </div>
                @* </form> *@
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="attachmentModalPropo" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content">
            <div class="container">
                @* <form asp-action="SelectPIC"> *@
                <div class="modal-body">
                    <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                    <div class="form-group">
                        <div class="row">
                            <div class="col">
                                <label class="col-form-label control-label" id="labelToPurchaseReq">
                                    To download latest version of this document, click on the button below
                                </label>
                                <span class="text-danger"></span>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col">
                                @* @Html.ActionLink(FileNameQuot, "GetFileAttachment", new { controller = "PreProcs",
                                target =  @ViewBag.attachQuot.StrictedFileName + ";" + FileNameQuot }, new { target = "_blank", @class="btn-outline-primary" }) *@
                                @if (FileNamePropo != null)
                                {
                                    <a class="btn btn-outline-secondary" asp-controller="PreProcs" asp-action="GetFileAttachment" asp-route-target="@ViewBag.attachPropo[0].StrictedFileName;@FileNamePropo">
                                        Download
                                    </a>
                                }

                            </div>
                        </div>
                        <form asp-action="GetFileAttachment" asp-controller="PreProcs" method="get">
                            <div class="row">
                                <div class="col">
                                    <label class="col-form-label control-label" id="labelToPurchaseReq">
                                        To download specified version. Choose the version you want <i class="bi bi-caret-down-square"></i> and click on Download Version below
                                    </label>
                                    <span class="text-danger"></span>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-1">
                                    @{
                                        var countpropo = @ViewBag.attachPropo.Count;
                                    }
                                    <select class='form-select form-control' style='width: 63px' id='downVerPropo' runat='server' name='downVerPropo'>
                                        @foreach (var item in @ViewBag.attachPropo)
                                        {
                                            <option value='@item.StrictedFileName'> @countpropo</option>
                                            countpropo--;
                                        }
                                    </select>
                                </div>
                                <div class="col-4">
                                    @* <a class="btn btn-outline-secondary" id="btn-down-ver-rfp" style="width: 200px">
                                    Download Version
                                    </a>  *@
                                    <button type="submit" class="btn btn-outline-secondary" style="width: 200px">Download Version</button>
                                </div>
                            </div>
                        </form>
                    </div>

                </div>
                <div class="modal-footer">
                </div>
                @* </form> *@
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="attachmentModalOthers" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content">
            <div class="container">
                @* <form asp-action="SelectPIC"> *@
                <div class="modal-body">
                    <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                    <div class="form-group">
                        <div class="row">
                            <div class="col">
                                <label class="col-form-label control-label" id="labelToPurchaseReq">
                                    To download latest version of this document, click on the button below
                                </label>
                                <span class="text-danger"></span>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col">
                                @* @Html.ActionLink(FileNameQuot, "GetFileAttachment", new { controller = "PreProcs",
                                target =  @ViewBag.attachQuot.StrictedFileName + ";" + FileNameQuot }, new { target = "_blank", @class="btn-outline-primary" }) *@
                                @if (FileNameOthers != null)
                                {
                                    <a class="btn btn-outline-secondary" asp-controller="PreProcs" asp-action="GetFileAttachment" asp-route-target="@ViewBag.attachOthers[0].StrictedFileName;@FileNameOthers">
                                        Download
                                    </a>
                                }

                            </div>
                        </div>
                        <form asp-action="GetFileAttachment" asp-controller="PreProcs" method="get">
                            <div class="row">
                                <div class="col">
                                    <label class="col-form-label control-label" id="labelToPurchaseReq">
                                        To download specified version. Choose the version you want <i class="bi bi-caret-down-square"></i> and click on Download Version below
                                    </label>
                                    <span class="text-danger"></span>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-1">
                                    @{
                                        var countothers = @ViewBag.attachOthers.Count;
                                    }
                                    <select class='form-select form-control' style='width: 63px' id='downVerOthers' runat='server' name='downVerOthers'>
                                        @foreach (var item in @ViewBag.attachOthers)
                                        {
                                            <option value='@item.StrictedFileName'> @countothers</option>
                                            countothers--;
                                        }
                                    </select>
                                </div>
                                <div class="col-4">
                                    @* <a class="btn btn-outline-secondary" id="btn-down-ver-rfp" style="width: 200px">
                                    Download Version
                                    </a>  *@
                                    <button type="submit" class="btn btn-outline-secondary" style="width: 200px">Download Version</button>
                                </div>
                            </div>
                        </form>
                    </div>

                </div>
                <div class="modal-footer">
                </div>
                @* </form> *@
            </div>
        </div>
    </div>
</div>

<script>
    var modalBackdrop = document.getElementsByClassName("modalBackdrop")[0];
    var selDiv = "";
    let arr = []

    var notFoundCount = -3;

    $("#search").on("keyup", function() {
      var value = $(this).val().toLowerCase(),
         $tr =  $("#tableCommittee tbody tr");
      $tr.each(function(){
        var found = 0;
        $(this).find("td").each(function(){
           found += $(this).html().toLowerCase().indexOf(value)
        });
        if (found > notFoundCount){
            $(this).closest('tr').show();
        }else{
            $(this).closest('tr').hide();
        }
      });
    });

    $("#searchPICReason").on("keyup", function() {
      var value = $(this).val().toLowerCase(),
      $tr =  $("#tablePICReason tbody tr");
      $tr.each(function(){
        var found = 0;
        $(this).find("td").each(function(){
           found += $(this).html().toLowerCase().indexOf(value)
        });
        if (found > notFoundCount){
            $(this).closest('tr').show();
        }else{
            $(this).closest('tr').hide();
        }
      });
    });

    function CheckExistingCSData(pid, callback){
        var pidfull = new FormData();
        pidfull.append("pidfull", pid);

        $.ajax({
            url: "/PreProcs/CheckExistingCSData/",
            type: "POST",
            dataType: "json",
            data: pidfull,
            contentType: false,
            processData: false,
            success: function (datas) {
                callback(datas)
                return
            },
            error: function (data) {
                console.log("error" + data[0]);
                callback(null);
            }
        })
    }

    function CheckExistingPOData(polineid, callback){
        var poline = new FormData();
        poline.append("poline", polineid);

        $.ajax({
            url: "/PreProcs/CheckExistingPOData/",
            type: "POST",
            dataType: "json",
            data: poline,
            contentType: false,
            processData: false,
            success: function (datas) {
                callback(datas)
                return
            },
            error: function (data) {
                console.log("error" + data[0]);
                callback(null);
            }
        })
    }

    $('#btn-get-cs').on("click", function (e) {
        var value = $("#txtPID").val().toLowerCase();
        
        $("#loadingcs").show();
        var body = $('#bodyCSData').html("");

        var pid = new FormData();
        pid.append("pid", value);

        let execfunc = true

        $.ajax({
            url: "/PreProcs/GetCSDataFromSearch/",
            type: "POST",
            dataType: "json",
            data: pid,
            contentType: false,
            processData: false,
            success: function (datas) {
                if(datas.length > 0){
                    for(var i =0; i < datas.length;i++){
                        let tempexistpid
                        let tempcount = i
                        
                        if(i > 0 && datas[i].pidfull == datas[i-1].pidfull) {
                            execfunc = false
                        }

                        if(execfunc == true){
                            CheckExistingCSData(datas[i].pidfull, function(itemcs) {
                                tempexistpid = itemcs
                                if(tempexistpid.length > 0){
                                    for(var i =0; i < tempexistpid.length;i++){
                                        if(tempexistpid[i].nkpcode == datas[tempcount].nkpcode && tempexistpid[i].unitPrice == datas[tempcount].unitRevenue && tempexistpid[i].unitCogs == datas[tempcount].unitCogs && tempexistpid[i].qty == datas[tempcount].qty && tempexistpid[i].remarkOnItem == datas[tempcount].description){
                                            if(datas[tempcount].description == null){
                                                datas[tempcount].description = "";
                                            }
                                            if(datas[tempcount].qty == null){
                                                datas[tempcount].qty = "";
                                            }
                                            if(datas[tempcount].currCode == null){
                                                datas[tempcount].currCode = "";
                                            }
                                            if(datas[tempcount].unitCogs == null){
                                                datas[tempcount].unitCogs = "";
                                            }
                                            if(datas[tempcount].unitRevenue == null){
                                                datas[tempcount].unitRevenue = "";
                                            }
                                            if(datas[tempcount].totalCogs == null){
                                                datas[tempcount].totalCogs = "";
                                            }
                                            if (datas[tempcount].totalRevenue == null) {
                                                datas[tempcount].totalRevenue = "";
                                            }

                                            body.append("<tr style='background-color: cyan;'><td scope='col' class='text-center'><input type='checkbox' class='form-check-input checkbox singleCheckItem' style='border: 1px solid;font-size: small;'></td><td scope='col' class='text-center'><input type='checkbox' class='form-check-input checkbox txtCSSub' value='true' style='border: 1px solid;font-size: small;'></td><td scope='col' style='text-align: -webkit-center;'><input style='width:100px' type='text' value='' class='txtCSHeaderNo form-control'/></td><td scope='col' class='tdCSDesc'>" + datas[tempcount].description + "</td><td scope='col' class='tdCSQty'>" + datas[tempcount].qty + "</td> <td scope='col' class='text-center tdCSCurr'>" + datas[tempcount].currCode + "</td><td scope='col' class='text-end tdCSCOGS'>" + datas[tempcount].unitCogs + "</td><td scope='col' class='text-end tdCSRevenue' >" + datas[tempcount].unitRevenue + "</td><td scope='col' class='text-end tdCSTotCOGS' >" + datas[tempcount].totalCogs + "</td><td scope='col' class='text-end tdCSTotRev'>" + datas[tempcount].totalRevenue + "</td><td scope='col' class='text-end txtCSNKPCode' hidden>" + datas[tempcount].nkpcode + "</td><td scope='col' class='text-end tdCSPID' hidden >" + datas[tempcount].projectId + "</td><td scope='col' class='text-end tdCSPIDFull' hidden>" + datas[tempcount].pidfull + "</td></tr>");
                                        }
                                        else{
                                            if(datas[i].description == null){
                                                datas[i].description = "";
                                            }
                                            if(datas[i].qty == null){
                                                datas[i].qty = "";
                                            }
                                            if(datas[i].currCode == null){
                                                datas[i].currCode = "";
                                            }
                                            if(datas[i].unitCogs == null){
                                                datas[i].unitCogs = "";
                                            }
                                            if(datas[i].unitRevenue == null){
                                                datas[i].unitRevenue = "";
                                            }
                                            if(datas[i].totalCogs == null){
                                                datas[i].totalCogs = "";
                                            }
                                            if (datas[i].totalRevenue == null) {
                                                datas[i].totalRevenue = "";
                                            }

                                            body.append("<tr><td scope='col' class='text-center'><input type='checkbox' class='form-check-input checkbox singleCheckItem' style='border: 1px solid;font-size: small;'></td><td scope='col' class='text-center'><input type='checkbox' class='form-check-input checkbox txtCSSub' value='true' style='border: 1px solid;font-size: small;'></td><td scope='col' style='text-align: -webkit-center;'><input style='width:100px' type='text' value='' class='txtCSHeaderNo form-control'/></td><td scope='col' class='tdCSDesc'>" + datas[i].description + "</td><td scope='col' class='tdCSQty'>" + datas[i].qty + "</td> <td scope='col' class='text-center tdCSCurr'>" + datas[i].currCode + "</td><td scope='col' class='text-end tdCSCOGS'>" + datas[i].unitCogs + "</td><td scope='col' class='text-end tdCSRevenue' >" + datas[i].unitRevenue + "</td><td scope='col' class='text-end tdCSTotCOGS' >" + datas[i].totalCogs + "</td><td scope='col' class='text-end tdCSTotRev'>" + datas[i].totalRevenue + "</td><td scope='col' class='text-end txtCSNKPCode' hidden>" + datas[i].nkpcode + "</td><td scope='col' class='text-end tdCSPID' hidden >" + datas[i].projectId + "</td><td scope='col' class='text-end tdCSPIDFull' hidden>" + datas[i].pidfull + "</td></tr>");
                                        }
                                    }
                                }
                                else{
                                    
                                        if(datas[tempcount].description == null){
                                            datas[tempcount].description = "";
                                        }
                                        if(datas[tempcount].qty == null){
                                            datas[tempcount].qty = "";
                                        }
                                        if(datas[tempcount].currCode == null){
                                            datas[tempcount].currCode = "";
                                        }
                                        if(datas[tempcount].unitCogs == null){
                                            datas[tempcount].unitCogs = "";
                                        }
                                        if(datas[tempcount].unitRevenue == null){
                                            datas[tempcount].unitRevenue = "";
                                        }
                                        if(datas[tempcount].totalCogs == null){
                                            datas[tempcount].totalCogs = "";
                                        }
                                        if (datas[tempcount].totalRevenue == null) {
                                            datas[tempcount].totalRevenue = "";
                                        }

                                        body.append("<tr><td scope='col' class='text-center'><input type='checkbox' class='form-check-input checkbox singleCheckItem' style='border: 1px solid;font-size: small;'></td><td scope='col' class='text-center'><input type='checkbox' class='form-check-input checkbox txtCSSub' value='true' style='border: 1px solid;font-size: small;'></td><td scope='col' style='text-align: -webkit-center;'><input style='width:100px' type='text' value='' class='txtCSHeaderNo form-control'/></td><td scope='col' class='tdCSDesc'>" + datas[tempcount].description + "</td><td scope='col' class='tdCSQty'>" + datas[tempcount].qty + "</td> <td scope='col' class='text-center tdCSCurr'>" + datas[tempcount].currCode + "</td><td scope='col' class='text-end tdCSCOGS'>" + datas[tempcount].unitCogs + "</td><td scope='col' class='text-end tdCSRevenue' >" + datas[tempcount].unitRevenue + "</td><td scope='col' class='text-end tdCSTotCOGS' >" + datas[tempcount].totalCogs + "</td><td scope='col' class='text-end tdCSTotRev'>" + datas[tempcount].totalRevenue + "</td><td scope='col' class='text-end txtCSNKPCode' hidden>" + datas[tempcount].nkpcode + "</td><td scope='col' class='text-end tdCSPID' hidden >" + datas[tempcount].projectId + "</td><td scope='col' class='text-end tdCSPIDFull' hidden>" + datas[tempcount].pidfull + "</td></tr>");
                                    
                                }

                            }.bind(this));
                        }

                        
                    
                    }
                }
                
            },
            complete: function () {
                $("#loadingcs").hide();
            },
            error: function (data) {
                console.log("error" + data[0]);
            }
        })
    });   

    $('#searchcs').keypress(function (e) {
        var value = $(this).val().toLowerCase();
        var key = e.which;
        if(key == 13)  // the enter key code
        {
            $("#loadingcs").show();
            var body = $('#bodyCSData').html("");

            var pid = new FormData();
            pid.append("pid", value);

            $.ajax({
                url: "/PreProcs/GetCSDataFromSearch/",
                type: "POST",
                dataType: "json",
                data: pid,
                contentType: false,
                processData: false,
                success: function (datas) {
                    for(var i =0; i < datas.length;i++){
                        let tempexistpid
                        CheckExistingCSData(datas[i].pidfull, function(itemcs) {
                            tempexistpid = itemcs
                            if(tempexistpid.length > 0){
                                console.log(tempexistpid)
                                console.log(datas)
                                for(var i =0; i < tempexistpid.length;i++){
                                    console.log(tempexistpid[i].nkpcode);
                                    console.log(datas[i].nkpcode);
                                    if(tempexistpid[i].nkpcode == datas[i].nkpcode && tempexistpid[i].unitPrice == datas[i].unitRevenue && tempexistpid[i].unitCogs == datas[i].unitCogs && tempexistpid[i].qty == datas[i].qty && tempexistpid[i].remarkOnItem == datas[i].description){
                                        if(datas[i].description == null){
                                            datas[i].description = "";
                                        }
                                        if(datas[i].qty == null){
                                            datas[i].qty = "";
                                        }
                                        if(datas[i].currCode == null){
                                            datas[i].currCode = "";
                                        }
                                        if(datas[i].unitCogs == null){
                                            datas[i].unitCogs = "";
                                        }
                                        if(datas[i].unitRevenue == null){
                                            datas[i].unitRevenue = "";
                                        }
                                        if(datas[i].totalCogs == null){
                                            datas[i].totalCogs = "";
                                        }
                                        if (datas[i].totalRevenue == null) {
                                            datas[i].totalRevenue = "";
                                        }

                                        body.append("<tr style='background-color: cyan;'><td scope='col' class='text-center'><input type='checkbox' class='form-check-input checkbox singleCheckItem' style='border: 1px solid;font-size: small;'></td><td scope='col' class='text-center'><input type='checkbox' class='form-check-input checkbox txtCSSub' value='true' style='border: 1px solid;font-size: small;'></td><td scope='col' style='text-align: -webkit-center;'><input style='width:100px' type='text' value='' class='txtCSHeaderNo form-control'/></td><td scope='col' class='tdCSDesc'>" + datas[i].description + "</td><td scope='col' class='tdCSQty'>" + datas[i].qty + "</td> <td scope='col' class='text-center tdCSCurr'>" + datas[i].currCode + "</td><td scope='col' class='text-end tdCSCOGS'>" + datas[i].unitCogs + "</td><td scope='col' class='text-end tdCSRevenue' >" + datas[i].unitRevenue + "</td><td scope='col' class='text-end tdCSTotCOGS' >" + datas[i].totalCogs + "</td><td scope='col' class='text-end tdCSTotRev'>" + datas[i].totalRevenue + "</td><td scope='col' class='text-end txtCSNKPCode' hidden>" + datas[i].nkpcode + "</td><td scope='col' class='text-end tdCSPID' hidden >" + datas[i].projectId + "</td><td scope='col' class='text-end tdCSPIDFull' hidden>" + datas[i].pidfull + "</td></tr>");
                                    }
                                    else{
                                        if(datas[i].description == null){
                                            datas[i].description = "";
                                        }
                                        if(datas[i].qty == null){
                                            datas[i].qty = "";
                                        }
                                        if(datas[i].currCode == null){
                                            datas[i].currCode = "";
                                        }
                                        if(datas[i].unitCogs == null){
                                            datas[i].unitCogs = "";
                                        }
                                        if(datas[i].unitRevenue == null){
                                            datas[i].unitRevenue = "";
                                        }
                                        if(datas[i].totalCogs == null){
                                            datas[i].totalCogs = "";
                                        }
                                        if (datas[i].totalRevenue == null) {
                                            datas[i].totalRevenue = "";
                                        }

                                        body.append("<tr><td scope='col' class='text-center'><input type='checkbox' class='form-check-input checkbox singleCheckItem' style='border: 1px solid;font-size: small;'></td><td scope='col' class='text-center'><input type='checkbox' class='form-check-input checkbox txtCSSub' value='true' style='border: 1px solid;font-size: small;'></td><td scope='col' style='text-align: -webkit-center;'><input style='width:100px' type='text' value='' class='txtCSHeaderNo form-control'/></td><td scope='col' class='tdCSDesc'>" + datas[i].description + "</td><td scope='col' class='tdCSQty'>" + datas[i].qty + "</td> <td scope='col' class='text-center tdCSCurr'>" + datas[i].currCode + "</td><td scope='col' class='text-end tdCSCOGS'>" + datas[i].unitCogs + "</td><td scope='col' class='text-end tdCSRevenue' >" + datas[i].unitRevenue + "</td><td scope='col' class='text-end tdCSTotCOGS' >" + datas[i].totalCogs + "</td><td scope='col' class='text-end tdCSTotRev'>" + datas[i].totalRevenue + "</td><td scope='col' class='text-end txtCSNKPCode' hidden>" + datas[i].nkpcode + "</td><td scope='col' class='text-end tdCSPID' hidden >" + datas[i].projectId + "</td><td scope='col' class='text-end tdCSPIDFull' hidden>" + datas[i].pidfull + "</td></tr>");
                                    }
                                }
                            }
                            else{
                                for(var j =0; j < datas.length;j++){
                                    if(datas[j].description == null){
                                        datas[j].description = "";
                                    }
                                    if(datas[j].qty == null){
                                        datas[j].qty = "";
                                    }
                                    if(datas[j].currCode == null){
                                        datas[j].currCode = "";
                                    }
                                    if(datas[j].unitCogs == null){
                                        datas[j].unitCogs = "";
                                    }
                                    if(datas[j].unitRevenue == null){
                                        datas[j].unitRevenue = "";
                                    }
                                    if(datas[j].totalCogs == null){
                                        datas[j].totalCogs = "";
                                    }
                                    if (datas[j].totalRevenue == null) {
                                        datas[j].totalRevenue = "";
                                    }

                                    body.append("<tr><td scope='col' class='text-center'><input type='checkbox' class='form-check-input checkbox singleCheckItem' style='border: 1px solid;font-size: small;'></td><td scope='col' class='text-center'><input type='checkbox' class='form-check-input checkbox txtCSSub' value='true' style='border: 1px solid;font-size: small;'></td><td scope='col' style='text-align: -webkit-center;'><input style='width:100px' type='text' value='' class='txtCSHeaderNo form-control'/></td><td scope='col' class='tdCSDesc'>" + datas[j].description + "</td><td scope='col' class='tdCSQty'>" + datas[j].qty + "</td> <td scope='col' class='text-center tdCSCurr'>" + datas[j].currCode + "</td><td scope='col' class='text-end tdCSCOGS'>" + datas[j].unitCogs + "</td><td scope='col' class='text-end tdCSRevenue' >" + datas[j].unitRevenue + "</td><td scope='col' class='text-end tdCSTotCOGS' >" + datas[j].totalCogs + "</td><td scope='col' class='text-end tdCSTotRev'>" + datas[j].totalRevenue + "</td><td scope='col' class='text-end txtCSNKPCode' hidden>" + datas[j].nkpcode + "</td><td scope='col' class='text-end tdCSPID' hidden >" + datas[j].projectId + "</td><td scope='col' class='text-end tdCSPIDFull' hidden>" + datas[j].pidfull + "</td></tr>");
                                }
                            }

                        }.bind(this));
                    
                    }
                },
                complete: function () {
                    $("#loadingcs").hide();
                },
                error: function (data) {
                    console.log("error" + data[0]);
                }
            })
        }
    });   

    document.addEventListener("DOMContentLoaded", init, false);

    if($("#emptyRow").html() != undefined){
        var emptyNewRow = "<tr></tr><tr class='linedetailitem'>";
        emptyNewRow += $("#emptyRow").html();
        emptyNewRow += "</tr>";
        var emptyNewRowWithoutTextAreaRemark = "<tr>";
        emptyNewRowWithoutTextAreaRemark += $("#emptyRow").html();
        emptyNewRowWithoutTextAreaRemark += "</tr>";
        emptyNewRowWithoutTextAreaRemark += "<tr><td></td><td></td><td></td><td><label class='col-form-label control-label text-red' style='min-width:120px'> Remarks on Item:</label></td><td class='tdRemark'></td></tr>";
        // alert(emptyNewRow);
        emptyNewRow += "<tr class='lineremark'><td></td><td></td><td></td><td><label class='col-form-label control-label text-red' style='min-width:120px'> Remarks on Item:</label></td><td class='tdRemark'><textarea class='form-control txtRemark mt-lg-2' placeholder='(Type remark here)' style='width:250px;height:50px'></textarea></td></tr>"
    }
     
    if (($("#currentEmailAM").val() != null && $("#currentEmailAM").val() != "") || ($("#currentEmailSuperAdmin").val() != null && $("#currentEmailSuperAdmin").val() != "")) {
        $("select#selectStage").removeClass("readonly-select");
        $("#editresultSelectedCommittee").removeClass("readonly-select");
        $("#selectCommittee").css("display", "block");
    }
    if  ($("#currentEmailBOD").val() != null && $("#currentEmailBOD").val() != "") {
        $("#editresultSelectedCommittee").removeClass("readonly-select");
        $("#selectCommittee").css("display", "block");
    }

    var rowButtons = "<a  class='btn btn-outline-success btn-edit' style='font-size: 12px; padding: 7px!important;'>E</a>" +
        "<a  class='btn btn-outline-danger btn-delete' style='font-size: 12px; padding: 7px!important;margin-right: 8px;margin-left: 10px; '>D</a>" +
        "<a  class='btn btn-outline-primary btn-copy' style='font-size: 12px; padding: 7px!important;'>C</a> ";

    var rowButtonsDeliv = "<a  class='btn btn-outline-success btn-edit' style='font-size: 12px; padding: 7px!important;'>E</a>";

    var rowUpdateButtons = "<a  class='btn btn-outline-primary btn-save' style='font-size: 12px; padding: 7px!important;'>Update  </a><br>" +
        "<a  class='btn btn-outline-danger btn-cancel mt-lg-2' style='font-size: 12px; padding: 7px!important;'>Cancel  </a>";

    var i = 0;

    function init() {
        var idStage = $('#selectStage').val();
        @* debugger; *@

        $('#btnselectbod').css("visibility", "visible");

        if ($("#tabelnewitem").children().children().length == 1) {
            $("#tabelnewitem").html("");
        }
        @* debugger; *@
        if($("#emptyRow").html() != undefined){
            console.log($("#currentEmailSuperAdmin").val());
            console.log($("#currentEmailTA").val());
            if (($("#currentEmailTA").val() != null && $("#currentEmailTA").val() != "") || $("#currentEmailSuperAdmin").val() != null && $("#currentEmailSuperAdmin").val() != "")
            {
                $("#tabelnewitem").append(emptyNewRow);
            }
        }

        if($('#txtTotSubCon').val() == 0 || $('#txtTotSubCon').val() == null || $('#txtTotSubCon').val() == ""){
            $("#visibleTableRevSharingSubCon").attr('hidden', true);
        }

        if (($("#currentEmailPMMgr").val() != null && $("#currentEmailPMMgr").val() != "") || ($("#currentEmailPMOHead").val() != null && $("#currentEmailPMOHead").val() != "")) {
            $("select#selectPM").removeClass("readonly-select");
            $("select#cvPM").removeClass("readonly-select");
            $("input#txtMandaysPM").removeClass("readonly-select");
            $("input#txtValuePM").removeClass("readonly-select");
            $("#mandaPMHRCost").css("visibility", "visible");
        }
        if(($("#currentEmailPCMgr").val() != null && $("#currentEmailPCMgr").val() != "") || ($("#currentEmailPMOHead").val() != null && $("#currentEmailPMOHead").val() != "")) {
            $("input#txtMandaysPC").removeClass("readonly-select");
            $("input#txtValuePC").removeClass("readonly-select");
            $("select#selectPC").removeClass("readonly-select");
            $("select#cvPC").removeClass("readonly-select");
            $("#mandaPCHRCost").css("visibility", "visible");
        }
        if(($("#currentEmailPSMgr").val() != null && $("#currentEmailPSMgr").val() != "") || ($("#currentEmailPMOHead").val() != null && $("#currentEmailPMOHead").val() != "")) {
            if($("select#ProjectType").val() == "Rental"){
               $("#mandaSelectPS").css("visibility", "visible");
            }
            $("select#selectPS").removeClass("readonly-select");
        }
        if ($("#currentEmailPS").val() != null && $("#currentEmailPS").val() != "" && idStage == "Delivery") {
            $("input#CheckEsc").removeClass("readonly-select");
            $("select#selectBillReason").removeClass("readonly-select");
            $("input#inputOtherBillReason").removeClass("readonly-select");
            $("a#selectPICReason").removeClass("readonly-select");
        }

        $("select#ProjectType").on("change", function() {
            var value = $(this).val();
            if(value == "Rental"){
                if((($("#currentEmailPSMgr").val() != null && $("#currentEmailPSMgr").val() != "") || ($("#currentEmailPMOHead").val() != null && $("#currentEmailPMOHead").val() != ""))) {
                    $("select#selectPS").removeClass("readonly-select");
                    $("#mandaSelectPS").css("visibility", "visible");
                }
            }
            else {
                $("#mandaSelectPS").css("visibility", "hidden");
            }
        });

        document.querySelector('#selectStage').addEventListener('change', changeStage, false);
        
        selDiv = document.querySelector("div #divEstGP");
        selDiv2 = document.querySelector("div #divPICProc");
        selDiv3 = document.querySelector("div #divProposalNo");
        selDiv4 = document.querySelector("div #divQuotationNo");
        selDiv5 = document.querySelector("div #divProposalDate");
        selDiv6 = document.querySelector("div #divAttachRFP");
        selDiv7 = document.querySelector("div .divAttachQuotCustomer");
        selDiv8 = document.querySelector("div .divAttachProposal");


        $('.inputAll').removeClass("readonly-select"); //RFPID, ProposalNo, QuotationNo, Tender, SubconQuotDeadline, Hedging, Warranty

        selDiv.innerHTML = "<label class=\"col-form-label control-label\" >" + "Est. % GP" + "<b class=\"text-red\" > * </b> (Ex: 8.20)" + "</label>" + "<span class=\"text-danger\" > </span>";
        selDiv2.innerHTML = "<label class=\"col-form-label control-label\" >" + "PIC Procurement" + "<b class=\"text-red\"> * </b>" + "</label>" + "<span class=\"text-danger\" > </span > ";
        selDiv3.innerHTML = "<label class=\"col-form-label control-label\" >" + "Proposal No." + "</label>" + "<span class=\"text-danger\" > </span>";
        selDiv4.innerHTML = "<label class=\"col-form-label control-label\" >" + "Quotation No." + "</label>" + "<span class=\"text-danger\" > </span>";
        selDiv6.innerHTML = "<label class=\"col-form-label control-label\" >" + "1. RFP / RKS" + "<span class=\"text-danger\" > </span>";
        selDiv7.innerHTML = "<label class=\"col-form-label control-label\" >" + "2. Quotation to Customer" + "<span class=\"text-danger\" > </span>";
        selDiv8.innerHTML = "<label class=\"col-form-label control-label\" >" + "3. Proposal" + "<span class=\"text-danger\" > </span>";

        if (idStage == 'RiskAssessment' || idStage == 'Risk Assessment') { //RISK ASSESSMENT
            $('.inputAll').addClass("readonly-select");
            $('.visiblePID').css("display", "none");
            $('.visiblePreID').css("display", "block");
            selDiv2.innerHTML = "<label class=\"col-form-label control-label\" >" + "PIC Procurement" + "</label>" + "<span class=\"text-danger\" > </span>";
            selDiv5.innerHTML = "<label class=\"col-form-label control-label\" >" + "Proposal Submission Date" + "<b class=\"text-red\" > * </b>" + "</label>" + "<span class=\"text-danger\" > </span>";
        }
        else if (idStage == 'Presales') { //PRESALES
            $('.visiblePID').css("display", "none");
            $('.visiblePreID').css("display", "block");
            selDiv5.innerHTML = "<label class=\"col-form-label control-label\" >" + "Proposal Submission Date" + "<b class=\"text-red\" > * </b>" + "</label>" + "<span class=\"text-danger\" > </span>";
            selDiv6.innerHTML = "<label class=\"col-form-label control-label\" >" + "1. RFP / RKS" + "<b class=\"text-red\" > * </b>" + "</label>" + "<span class=\"text-danger\" > </span>";
            $('#btnselectbod').css("visibility", "hidden");
        }
        else { //DELIVERY
            $('.visiblePID').css("display", "block");
            $('.visiblePreID').css("display", "none");
            selDiv.innerHTML = "<label class=\"col-form-label control-label\" >" + "Est. % GP (Ex: 8.20)" + "</label>" + "<span class=\"text-danger\" > </span>";
            selDiv3.innerHTML = "<label class=\"col-form-label control-label\" >" + "Proposal No." + "<b class=\"text-red\"> ** </b>" + "</label>" + "<span class=\"text-danger\" > </span>";
            selDiv4.innerHTML = "<label class=\"col-form-label control-label\" >" + "Quotation No." + "<b class=\"text-red\"> ** </b>" + "</label>" + "<span class=\"text-danger\" > </span>";
            selDiv5.innerHTML = "<label class=\"col-form-label control-label\" >" + "Proposal Submission Date" + "</label>" + "<span class=\"text-danger\"> </span>";
            selDiv7.innerHTML = "<label class=\"col-form-label control-label\" >" + "2. Quotation to Customer" + "<b class=\"text-red\"> ** </b>" + "<span class=\"text-danger\" > </span>";
            selDiv8.innerHTML = "<label class=\"col-form-label control-label\" >" + "3. Proposal" + "<b class=\"text-red\"> ** </b>" + "<span class=\"text-danger\" > </span>";
            $('#btnselectbod').css("visibility", "hidden");
        }
    }

    $('#tblData').on('click', 'a.btn-submit', function () {
        $(this).parent().parent().find("td.tdControl").html(rowButtons);
        const procid = $("input.txtPreProcId").last().val();
        const nkpcode = $("select.txtItemDesc option:selected").last().val();
        $("input.txtNKPCode").last().val(nkpcode);
        const no = $("input.txtNo").last().val();
        $("td.tdNo").last().html("" + no + "");
        const principal = $("select.txtPrincipal").last().val();
        $("td.tdPrincipal").last().html("" + principal + "");
        const itemdesc = $("select.txtItemDesc option:selected").last().text();
        $("td.tdItemDesc").last().html("" + itemdesc + "");
        const insurance = $("input.txtInsurance").last().prop("checked");
        if (insurance == true) {
            $("td.tdInsurance").last().html("Y");
        }else{
            $("td.tdInsurance").last().html("N");
        }
        const warranty = $("input.txtWarranty").last().val();
        $("td.tdWarranty").last().html("" + warranty + "");
        // const specrks = $("input.txtSpecRKS").last().val();
        // $("td.tdSpecRKS").last().html("" + specrks + "");
        const spec = $("td.tdSpecRKS").last().html().trim();
        $("td.tdSpecRKS").last().html(spec);

        let btnattachspec = $("td.tdSpecRKS").last().find("a.AttachSpecRKS").css("visibility", "hidden");
        
        let btnremovespec = $("td.tdSpecRKS").last().find("a.btn-remove-spec").css("visibility", "hidden");

        let btnattachsurduk = $("td.tdSurDuk").last().find("a.AttachSurDuk").css("visibility", "hidden");
        
        let btnremovesurduk = $("td.tdSurDuk").last().find("a.btn-remove-surduk").css("visibility", "hidden");

        let btnchecksurduk = $("td.tdSurDuk").last().find("input.txtSurDuk").css("visibility", "hidden");

        $("td.tdCheckItem").last().html("<input type='checkbox' class='form-check-input' style='border: 1px solid;font-size:large;'>");
        const surduk = $("input.txtSurDuk").last().prop("checked");
        if (surduk == true) {
            // $(this).parent().parent().find("td.tdSurDuk").html("Y");
        } else {
            $("td.tdSurDuk").last().html("N");
        }
        
        const qty = $("input.txtQty").last().val();
        $("td.tdQty").last().html("" + qty + "");

        const detail = $("input.txtDetailId").last().val("0");
        
        const remark = $("textarea.txtRemark").last().val();
        let remarkhtml = $("td.tdRemark").last().html(remark);
        $("td.tdRemark").last().addClass("text-red")

        var preprocid = new FormData();
        preprocid.append("preprocid", procid);
        preprocid.append("no", no);
        preprocid.append("principal", principal);
        preprocid.append("itemdesc", itemdesc);
        preprocid.append("nkpcode", nkpcode);
        preprocid.append("insurance", insurance);
        preprocid.append("warranty", warranty);
        preprocid.append("surduk", surduk);
        preprocid.append("qty", qty);
        preprocid.append("remark", remark);
        if(detail != null || detail != ""){
            preprocid.append("detailid", detail);
        }

        var nkpcodeinput = $("input.txtNKPCode").last();
        var detailidinput = $("input.txtDetailId").last();

        $("#tabelnewitem").append("<tr></tr>");
        $("#tabelnewitem").append(emptyNewRow);

        // $.ajax({
        //     url: "/PreProcs/SaveorUpdateDetail/",
        //     type: "POST",
        //     dataType: "json",
        //     data: preprocid,
        //     contentType: false,
        //     processData: false,
        //     success: function (data) {
        //         nkpcodeinput.val(nkpcode);
        //         if(detail == null || detail == ""){
        //             detailidinput.val(data.detailId);
        //         };
        //         var detailid = new FormData();
        //         detailid.append("procid", procid);
        //         detailid.append("name", "temp");
        //         detailid.append("detailid", data.detailId);

        //         $.ajax({
        //             url: "/PreProcs/GetAttachmentDetails/",
        //             type: "POST",
        //             dataType: "json",
        //             data: detailid,
        //             contentType: false,
        //             processData: false,
        //             success: function (datas) {
        //                 $("td.tdSpecRKS").last().html("");
        //                 $("td.tdSurDuk").last().html("");
        //                 for(var i =0; i < datas.length;i++){
        //                     if(datas[i].documentTypeId == 11){//attach spec
        //                         $("td.tdSpecRKS").last().append("<a  class='btn-down-spec' style='font-size: 12px; padding: 7px!important;margin-right: 5px;margin-left: 5px;' href='/Preprocs/GetFileAttachment?target="+ datas[i].strictedFileName + ";" + datas[i].fileName  +"'>" + datas[i].fileName +"</a><br>");
        //                     }
        //                     else{
        //                         $("td.tdSurDuk").last().append("<a  class='btn-down-surduk' style='font-size: 12px; padding: 7px!important;margin-right: 5px;margin-left: 5px;' href='/Preprocs/GetFileAttachment?target="+ datas[i].strictedFileName + ";" + datas[i].fileName  +"'>" + datas[i].fileName +"</a><br>");
        //                     }

        //                 }
        //                 if (surduk == true){
        //                     $("td.tdSurDuk").last().html("Y");
        //                 }else{
        //                     $("td.tdSurDuk").last().html("N");
        //                 }
        //                 $("#tabelnewitem").append(emptyNewRow);
        //             },
        //             error: function (data) {
        //                 console.log("error" + data[0]);
        //             }
        //         })
                
        //     },
        //     error: function (data) {
        //         console.log("error" + data[0]);
        //     }
        // })

        
    });

    $('#checkAllItem').on('click', function () { // registering function for delete button
        if(this.checked == true){
            $('input:checkbox.singleCheckItem').prop("checked", true);
        }
        else{
            $('input:checkbox.singleCheckItem').prop("checked", false);
        }
        // $('input:checkbox.singleCheckItem').each(function () {
        //     if(this.checked == true){
        //         detailid.append("procid", procid);
        //         detailid.append("detailid", $(this).val());
        //     }
        // });

    });

    $('#tblData').on('click', 'a.btn-delete', function () { // registering function for delete button
        $(this).parent().parent().remove();
    });


    $('#tblData').on('click', 'a.btn-save', function () {
        const commentpresales = $(this).parent().parent().find(".txtCommentPresales").val();
        const commentam = $(this).parent().parent().find("textarea.txtCommentAM").val();

        let commpresaleshtml = $(this).parent().parent().find("input.txtCommentPresalesHidden").val(commentpresales);
        let commamhtml = $(this).parent().parent().find("input.txtCommentAMHidden").val(commentam);

        const no = $(this).parent().parent().find("input.txtNo").val();
        $(this).parent().parent().find("td.tdNo").html("" + no + "");

        $(this).parent().parent().find("td.tdCheckItem").html("<input type='checkbox' class='form-check-input' style='border: 1px solid;font-size:large;'>");

        const principal = $(this).parent().parent().find("select.txtPrincipal option:selected").val();
        $(this).parent().parent().find("td.tdPrincipal").html("" + principal + "");

        let vendor = $(this).parent().parent().find("select.txtVendor option:selected").text();
        
        if(vendor == null || vendor == "" || vendor == "(Please Select)"){
            vendor = ""
        }

        $(this).parent().parent().find("td.tdVendor").html("" + vendor + "");

        const itemdesc = $(this).parent().parent().find("select.txtItemDesc option:selected").text();
        const itemdescval = $(this).parent().parent().find("select.txtItemDesc option:selected").val();
      
        $(this).parent().parent().find("td.tdItemDesc").html("" + itemdesc + "");

        const insurance = $(this).parent().parent().find("input.txtInsurance").prop("checked");
        if (insurance == true) {
            $(this).parent().parent().find("td.tdInsurance").html("Y");
        } else {
            $(this).parent().parent().find("td.tdInsurance").html("N");
        }
        const nkpcode = $(this).parent().parent().find("input.txtNKPCode").val();

        let btnattachspec = $(this).parent().parent().find("a.AttachSpecRKS").css("visibility", "hidden");
        
        let btnremovespec = $(this).parent().parent().find("a.btn-remove-spec").css("visibility", "hidden");

        let btnattachvendorquot = $(this).parent().parent().find("a.AttachVendorQuot").css("visibility", "hidden");
        
        let btnremovevendorquot = $(this).parent().parent().find("a.btn-remove-vendorquot").css("visibility", "hidden");

        let btnattachsurduk = $(this).parent().parent().find("a.AttachSurDuk").css("visibility", "hidden");
        
        let btnremovesurduk = $(this).parent().parent().find("a.btn-remove-surduk").css("visibility", "hidden");

        let btnchecksurduk = $(this).parent().parent().find("input.txtSurDuk").css("visibility", "hidden");

        const warranty = $(this).parent().parent().find("input.txtWarranty").val();
        $(this).parent().parent().find("td.tdWarranty").html("" + warranty + "");

        const surduk = $(this).parent().parent().find("input.txtSurDuk").prop("checked");
        if (surduk == true) {
            // $(this).parent().parent().find("td.tdSurDuk").html("Y");
        } else {
            $(this).parent().parent().find("td.tdSurDuk").html("N");
        }
        const qty = $(this).parent().parent().find("input.txtQty").val();
        $(this).parent().parent().find("td.tdQty").html("" + qty + "");

        let risk = $(this).parent().parent().find("select.txtRisk option:selected").val();
        let presalesrev = $(this).parent().parent().find("input.txtPresalesRev:checked").val();
        let amrev = $(this).parent().parent().find("input.txtAMRev:checked").val();

        if(presalesrev == undefined){
            presalesrev = "";
        }
        if(amrev == undefined){
            amrev = "";
        }
        if(risk == undefined){
            risk = "";
        }

        if(amrev == ""){
            amrev = $(this).parent().parent().find("td.tdAMReview").html()
        }
        if(presalesrev == ""){
            presalesrev = $(this).parent().parent().find("td.tdPresalesReview").html()
        }
        if(risk == ""){
            risk = $(this).parent().parent().find("td.tdRisk").html()
        }

        let riskhtml = $(this).parent().parent().find("td.tdRisk").html("");
        let presalesrevhtml = $(this).parent().parent().find("td.tdPresalesReview").html("");
        let amrevhtml = $(this).parent().parent().find("td.tdAMReview").html("");

        riskhtml.append(risk);
        presalesrevhtml.append(presalesrev);
        amrevhtml.append(amrev);

        const curr = $(this).parent().parent().find("select.txtCurrency option:selected").val();
        let currhtml = $(this).parent().parent().find("td.tdCurrency").html(curr);
        
        const unitcogs = $(this).parent().parent().find("input.txtUnitCOGS").val();
        let unitcogshtml = $(this).parent().parent().find("td.tdUnitCOGS").html("");
        unitcogshtml.append(unitcogs)

        const remark = $(this).parent().parent().next().find("textarea.txtRemark").val();
        let remarkhtml = $(this).parent().parent().next().find("td.tdRemark").html(remark);

        var preprocid = new FormData();
        const detailid = $(this).parent().parent().find("input.txtDetailId").val();
        const procid = $(this).parent().parent().find("input.txtPreProcId").val();

        const fileattach = $(this).parent().parent().find("div.divFileSpec").html();
        //btn-down-spec

        if(fileattach == undefined){
            const spec = $(this).parent().parent().find("td.tdSpecRKS").html("");
        }

        var preprocid = new FormData();
        preprocid.append("preprocid", procid);
        preprocid.append("no", no);
        preprocid.append("principal", principal);
        preprocid.append("itemdesc", itemdesc);
        preprocid.append("nkpcode", nkpcode);
        preprocid.append("insurance", insurance);
        preprocid.append("warranty", warranty);
        preprocid.append("surduk", surduk);
        preprocid.append("qty", qty);
        preprocid.append("detailid", detailid);
        preprocid.append("risk", risk);
        preprocid.append("presalesrev", presalesrev);
        preprocid.append("amrev", amrev);
        preprocid.append("commentam", commentam);
        preprocid.append("commentpresales", commentpresales);

        // $.ajax({
        //     url: "/PreProcs/SaveorUpdateDetail/",
        //     type: "POST",
        //     dataType: "json",
        //     data: preprocid,
        //     contentType: false,
        //     processData: false,
        //     success: function (data) {
        //         // for (var i = 0; i < data.length; i++) {
        //             // $("td.tdControl").last().html(rowButtons)
        //             // $("td.tdNo").last().html("" + data[i].id + "");
        //             // $("td.tdPrincipal").last().html("" + data[i].principle + "");
        //             // $("td.tdItemDesc").last().html("" + data[i].itemDesc + "");

        //             // if (data[i].insurance == true) {
        //             //     $("td.tdInsurance").last().html("Y");
        //             // } else {
        //             //     $("td.tdInsurance").last().html("N");
        //             // }
        //             // $("td.tdWarranty").last().html("" + data[i].warranty + "");
        //             // $("td.tdSpecRKS").last().html("");
        //             // if (data[i].surDukCheck == true) {
        //             //     $("td.tdSurDuk").last().html("Y");
        //             // } else {
        //             //     $("td.tdSurDuk").last().html("N");
        //             // }
        //             // $("td.tdQty").last().html("" + data[i].qty + "");

        //             riskhtml.append("" + data.risk + "");
        //             presalesrevhtml.append("" + presalesrev + "");
        //             amrevhtml.append("" + amrev + "");

        //         // }
        //     },
        //     error: function (data) {
        //         console.log("error" + data[0]);
        //     }
        // })

        $(this).parent().parent().find("td.tdControl").html(rowButtons);

    });

    $('#tblData').on('click', 'a.btn-cancel', function () {
        const detailid = $(this).parent().parent().find("input.txtDetailId").val();
        let thisnexthtml = $(this).parent().parent().next().html("")
        let thishtml = $(this).parent().parent().html("")
        
        let flag = 0

        arr.forEach(item => {
            if(item.detailId == detailid && item.line == 1){
                thishtml.append(item.html)
                flag += 1
            }
            else if(item.detailId == detailid && item.line == 2){
                thisnexthtml.append(item.html)
                flag += 1
            }
            if (flag == 2) {
                return false
            }
        })

        // const no = $(this).parent().parent().find("input.txtNo").val();
        // $(this).parent().parent().find("td.tdNo").html("" + no + "");

        // const principal = $(this).parent().parent().find("select.txtPrincipal option:selected").val();
        // $(this).parent().parent().find("td.tdPrincipal").html("" + principal + "");

        // const itemdesc = $(this).parent().parent().find("select.txtItemDesc option:selected").text();
        // $(this).parent().parent().find("td.tdItemDesc").html("" + itemdesc + "");

        // const insurance = $(this).parent().parent().find("input.txtInsurance").prop("checked");
        // if (insurance == true) {
        //     $(this).parent().parent().find("td.tdInsurance").html("Y");
        // } else {
        //     $(this).parent().parent().find("td.tdInsurance").html("N");
        // }

        // const warranty = $(this).parent().parent().find("input.txtWarranty").val();
        // $(this).parent().parent().find("td.tdWarranty").html("" + warranty + "");

        
        // const fileattach = $(this).parent().parent().find("div.divFileSpec").html();
        // //btn-down-spec

        // if(fileattach == undefined){
        //     const spec = $(this).parent().parent().find("td.tdSpecRKS").html("");
        // }
        // const surduk = $(this).parent().parent().find("input.txtSurDuk").prop("checked");
        // if (surduk == true) {
        //     $(this).parent().parent().find("td.tdSurDuk").html("Y");
        // } else {
        //     $(this).parent().parent().find("td.tdSurDuk").html("N");
        // }
        // const qty = $(this).parent().parent().find("input.txtQty").val();
        // $(this).parent().parent().find("td.tdQty").html("" + qty + "");

        // const curr = $(this).parent().parent().find("select.txtCurrency").val();
        // $(this).parent().parent().find("td.tdCurrency").html("" + curr + "");

        // const unitcogs = $(this).parent().parent().find("input.txtUnitCOGS").val();
        // $(this).parent().parent().find("td.tdUnitCOGS").html("" + unitcogs + "");

        // $(this).parent().parent().find("td.tdRisk").html("");
        // $(this).parent().parent().find("td.tdPresalesReview").html("");
        // $(this).parent().parent().find("td.tdAMReview").html("");

        // $(this).parent().parent().find("td.tdControl").html(rowButtons);
    });


    $('#tblData').on('click', 'a.btn-edit', function () {
            const detail = $(this).parent().parent().find("input.txtDetailId").val();
            const thishtml = $(this).parent().parent().html()
            const thisnexthtml = $(this).parent().parent().next().html()

            // if(arr.length > 0){
            //     arr = arr.map(item => {
            //         if(item.detailId == detail && item.line == 1){
            //             item.html = thishtml
            //         }
            //         else if(item.detailId == detail && item.line == 2){
            //             item.html = thisnexthtml
            //         }
            //         return item
            //     })
            // }
            // else{
            arr = []
            arr.push({detailId: detail, line: 1, html:$(this).parent().parent().html()})
            arr.push({detailId: detail, line: 2, html:$(this).parent().parent().next().html()})

            // }

            const remarkitem = $(this).parent().parent().next().find("td.tdRemark").html();
            const remarkhtml = $(this).parent().parent().next().find("td.tdRemark").html("<textarea class='form-control txtRemark' placeholder='(Type remark here)' style='width:250px;height:50px'>" + remarkitem +"</textarea>");

            const no = $(this).parent().parent().find("td.tdNo").html().trim();
            $(this).parent().parent().find("td.tdNo").html("<input type='text' value='" + no + "' class='form-control txtNo' style = 'width:70px; font-size: 13px'/>");
            $(this).parent().parent().find("td.tdCheckItem").html("");
            var principal = $(this).parent().parent().find("select.txtPrincipal option:selected").val();

            if(principal == undefined){
                principal = $(this).parent().parent().find("td.tdPrincipal").html().trim();
            }
            var principalhtml = $(this).parent().parent().find("td.tdPrincipal").html($("td.tdPrincipal").last().html());

            $(this).parent().parent().find("select.txtPrincipal").append('<option selected=' + principal + '>' + principal + '</option>');

            var vendor = new FormData();
            vendor.append("vendor", principal);
            const itemdesc = $(this).parent().parent().find("select.txtItemDesc option:selected").val();
            // const remarkitem = $(this).parent().parent().find("textarea.txtRemark").val();
            const nkpcode = $(this).parent().parent().find("input.txtNKPCode").val();

            if(($("#currentEmailPresales").val() != null && $("#currentEmailPresales").val() != "") || ($("#currentEmailSuperAdmin").val() != null && $("#currentEmailSuperAdmin").val() != "") || ($("#currentEmailProdMgr").val() != null && $("#currentEmailProdMgr").val() != "")){
                const risk = $(this).parent().parent().find("td.tdRisk").html().trim();
                let riskhtml = $(this).parent().parent().find("td.tdRisk").html("<select class='form-select form-control txtRisk' aria-label='Default select example' style='width:110px' id='selectRisk' runat='server' name='Risk'></select>");
                let selectriskhtml = $(this).parent().parent().find("select.txtRisk").html("");

                // if(risk == null && risk == ""){
                //     selectriskhtml.append("<option selected value='Low'>Low</option>");
                //     selectriskhtml.append("<option value='Medium'>Medium</option>");
                //     selectriskhtml.append("<option value='High'>High</option>");
                // }
                // else{
                    selectriskhtml.append("<option selected value=''></option>");
                    if(risk == "Low"){
                        selectriskhtml.append("<option selected value='Low'>Low</option>");
                    }
                    else{
                        selectriskhtml.append("<option value='Low'>Low</option>");
                    }

                    if(risk == "Medium"){
                        selectriskhtml.append("<option selected value='Medium'>Medium</option>");
                    }
                    else{
                        selectriskhtml.append("<option value='Medium'>Medium</option>");
                    }

                    if(risk == "High"){
                        selectriskhtml.append("<option selected value='High'>High</option>");
                    }
                    else{
                        selectriskhtml.append("<option value='High'>High</option>");
                    }
                // }

                const presalesrev = $(this).parent().parent().find("td.tdPresalesReview").html().trim();
                let presalesrevhtml = $(this).parent().parent().find("td.tdPresalesReview").html("<div class='form-check'><input class='form-check-input txtPresalesRev' type='radio' name='presalesrev' id='presalesrev1' value='Approved'> <label class='form-check-label' for='presalesrev1'>Approved</label></div> <div class='form-check'><input class='form-check-input txtPresalesRev' type='radio' name='presalesrev' id='presalesrev2' value='Rejected'><label class='form-check-label' for='presalesrev2'>Rejected</label></div>");

                if(presalesrev == "Approved"){
                    $(this).parent().parent().find("input#presalesrev1").attr("checked", true)
                }
                else if(presalesrev == "Rejected"){
                    $(this).parent().parent().find("input#presalesrev2").attr("checked", true)
                }

                var idapproval = new FormData();
                idapproval.append("idapproval", detail);
                idapproval.append("role", "Presales");

                $.ajax({
                    url: "/PreProcs/GetDetailApprovalItem/",
                    type: "POST",
                    dataType: "json",
                    data: idapproval,
                    contentType: false,
                    processData: false,
                    success: function (data) {
                        console.log(data)
                        if(data != null){
                            presalesrevhtml.append("<b>Review Comment</b><br><textarea class='txtCommentPresales form-control mt-lg-2' placeholder='(Type review here)' style='width:250px;height:50px;font-size:12px'>" + data.remark + "</textarea>");
                        }
                        else{
                            presalesrevhtml.append("<b>Review Comment</b><br><textarea class='txtCommentPresales form-control mt-lg-2' placeholder='(Type review here)' style='width:250px;height:50px;font-size:12px'></textarea>");
                        }
                        
                    },
                    error: function (data) {
                        console.log("error" + data[0]);
                    }
                })

                // const commpresales = $(this).parent().parent().find("input.txtCommentPresales").val();
                
            }


            if(($("#currentEmailAMManager").val() != null && $("#currentEmailAMManager").val() != "") || ($("#currentEmailSuperAdmin").val() != null && $("#currentEmailSuperAdmin").val() != "")){
                const amrev = $(this).parent().parent().find("td.tdAMReview").html().trim();
                var amrevhtml = $(this).parent().parent().find("td.tdAMReview").html("<div class='form-check'><input class='txtAMRev form-check-input' type='radio' name='amrev' id='amrev1' value='Approved'> <label class='form-check-label' for='amrev1'>Approved</label></div> <div class='form-check'> <input class='form-check-input txtAMRev' type='radio' name='amrev' id='amrev2' value='Rejected'><label class='form-check-label' for='amrev2'>Rejected</label></div>");

                if(amrev == "Approved"){
                    $(this).parent().parent().find("input#amrev1").attr("checked", true)
                }
                else if(amrev == "Rejected"){
                    $(this).parent().parent().find("input#amrev2").attr("checked", true)
                }

                var idapproval = new FormData();
                idapproval.append("idapproval", detail);
                idapproval.append("role", "AM Manager");

                $.ajax({
                    url: "/PreProcs/GetDetailApprovalItem/",
                    type: "POST",
                    dataType: "json",
                    data: idapproval,
                    contentType: false,
                    processData: false,
                    success: function (data) {
                        console.log(data)
                        if(data != null){
                            amrevhtml.append("<b>Review Comment</b><br><textarea class='form-control txtCommentAM mt-lg-2' placeholder='(Type review here)' style='width:250px;height:50px;font-size:12px'>" + data.remark + "</textarea>");
                        }
                        else{
                            amrevhtml.append("<b>Review Comment</b><br><textarea class='form-control txtCommentAM mt-lg-2' placeholder='(Type review here)' style='width:250px;height:50px;font-size:12px'></textarea>");
                        }
                        
                    },
                    error: function (data) {
                        console.log("error" + data[0]);
                    }
                })

                // const commam = $(this).parent().parent().find("input.txtCommentAM").val();
             
            }
        

            // class="tdAMReview"

            var itemdeschtml = $(this).parent().parent().find("td.tdItemDesc").html($("td.tdItemDesc").last().html());
            // var editremarkitem = $(this).parent().parent().find("textarea.txtRemark").val(remarkitem);
            var selectitemdeschtml = $(this).parent().parent().find("select.txtItemDesc").html('');
        
            $.ajax({
                url: "/PreProcs/ChangeListNKP/",
                type: "POST",
                dataType: "json",
                data: vendor,
                contentType: false,
                processData: false,
                success: function (data) {
                    selectitemdeschtml.append("<option value=''>(Please Select)</option>");
                    for (var i in data) {
                        if (nkpcode != data[i].nkpcodeLinkTitle) {
                            selectitemdeschtml.append('<option value=' + data[i].nkpcodeLinkTitle + '>' + data[i].nkpname + '</option>');
                        }
                        else{
                            selectitemdeschtml.append('<option selected=' + itemdesc + '>' + data[i].nkpname + '</option>');
                        }
                    }
                },
                error: function (data) {
                    console.log("error" + data[0]);
                }
            })

            const insurance = $(this).parent().parent().find("td.tdInsurance").html().trim();
            if(insurance == "Y"){
                $(this).parent().parent().find("td.tdInsurance").html("<input type='checkbox' value='' checked class='form-check-input checkbox txtInsurance' style = 'border: 1px solid;'/>");
            }
            else{
                $(this).parent().parent().find("td.tdInsurance").html("<input type='checkbox' value='' class='form-check-input checkbox txtInsurance' style = 'border: 1px solid;'/>");
            }
        
            const warranty = $(this).parent().parent().find("td.tdWarranty").html().trim();
            $(this).parent().parent().find("td.tdWarranty").html("<input type='text' value='" + warranty + "' class='form-control txtWarranty' style = 'width:100%; font-size: 13px'/>");
            const surduk = $(this).parent().parent().find("td.tdSurDuk").html().trim();

            let lenbtnattachspec = $(this).parent().parent().find("a.AttachSpecRKS").length;
            let lenbtnattachsurduk = $(this).parent().parent().find("div.divFileSurDuk").length;

            let btnremovespec = $(this).parent().parent().find("a.btn-remove-spec").css("visibility", "visible");
            let btnattachspec = $(this).parent().parent().find("a.AttachSpecRKS").css("visibility", "visible");

            let btnattachsurduk = $(this).parent().parent().find("a.AttachSurDuk").css("visibility", "visible");
            let btnremovesurduk = $(this).parent().parent().find("a.btn-remove-surduk").css("visibility", "visible");
            let btnchecksurduk = $(this).parent().parent().find("input.txtSurDuk").css("visibility", "visible");

            let surdukhtml = $(this).parent().parent().find("td.tdSurDuk");
            let spechtml = $(this).parent().parent().find("td.tdSpecRKS");

            if(lenbtnattachspec == 0){
                spechtml.html("");
            }
            if(lenbtnattachsurduk == 0){
                surdukhtml.html("");
            }
        
            const procid = $("input.txtPreProcId").last().val();
            var detailid = new FormData();
            detailid.append("procid", procid);
            detailid.append("detailid", detail);

            $.ajax({
                url: "/PreProcs/GetAttachmentDetails/",
                type: "POST",
                dataType: "json",
                data: detailid,
                contentType: false,
                processData: false,
                success: function (data) {
                    if (surduk == "N") {
                        surdukhtml.append("<input name='Hedging' type='checkbox' value='true' class='txtSurDuk form-check-input checkbox' style='border: 1px solid;' /><br>");
                        surdukhtml.append("<a class='btn btn-outline-secondary mt-lg-2 AttachSurDuk' style='min-width:80px;font-size: 12px; padding: 3px!important;visibility:hidden' data-bs-toggle='modal' data-bs-target='#uploadSurDuk'>Attach File</a>");
                    }
                    else{
                        if(surdukhtml.find("input.txtSurDuk").length == 0){
                            surdukhtml.append("<input name='Hedging' type='checkbox' value='true' class='txtSurDuk form-check-input checkbox' style='border: 1px solid;' checked /><br><br>");
                        }
                        
                    }
                    for(var i=0;i<data.length;i++){
                        if(data[i].documentTypeId == 11)//attach spec
                        {
                            if(lenbtnattachspec == 0){
                                spechtml.append("<div class='divFileSpec'><a  class='btn-down-spec' id='" + data[i].id + "' style='width:80px;font-size: 12px; padding: 7px!important;margin-right: 5px;margin-left: 5px;' href='/Preprocs/GetFileAttachment?target="+ data[i].strictedFileName + ";" + data[i].fileName  +"'>" + data[i].fileName +"</a> <a class='text-danger btn-remove-spec'><b><i class='bi bi-x-lg'></i></b></a></div><br>");
                            }
                        }
                        else{
                            if(lenbtnattachsurduk == 0){
                                surdukhtml.append("<div class='divFileSpec'><a  class='btn-down-surduk' style='font-size: 12px; padding: 7px!important;margin-right: 5px;margin-left: 5px;' href='/Preprocs/GetFileAttachment?target="+ data[i].strictedFileName + ";" + data[i].fileName  +"'>" + data[i].fileName +"</a> <a class='text-danger btn-remove-surduk'><b><i class='bi bi-x-lg'></i></b></a></div><br>");
                        
                            }
                        }
                        
                        // surdukhtml.html("<input name='Hedging' type='checkbox' class='txtSurDuk form-check-input checkbox' style='border: 1px solid;' checked /> <br>" + data[0].fileName + "<br><a class='btn btn-outline-secondary mt-lg-2 txtSurDuk' style='font-size: 12px; padding: 3px!important;' data-bs-toggle='modal' data-bs-target='#uploadSurDuk'>Attach File</a>");
                        // alert(data[0].fileName);
                    }
                    if(lenbtnattachspec == 0){
                        spechtml.append($("td.tdSpecRKS").last().html());
                    }
                    if (surduk != "N" && lenbtnattachsurduk == 0) {
                        surdukhtml.append("<a class='btn btn-outline-secondary mt-lg-2 AttachSurDuk' style='min-width:80px;font-size: 12px; padding: 3px!important;' data-bs-toggle='modal' data-bs-target='#uploadSurDuk'>Attach File</a>");
                    }
                },
                error: function (data) {
                    console.log(data.responseText)
                }
            })

            const qty = $(this).parent().parent().find("td.tdQty").html().trim();
            $(this).parent().parent().find("td.tdQty").html("<input type='text' value='" + qty + "' class='form-control txtQty' style = 'width:70px; font-size: 13px'/>");

         

            const curr = $(this).parent().parent().find("td.tdCurrency").html().trim();
            $(this).parent().parent().find("td.tdCurrency").html("<select class='form-select form-control txtCurrency' aria-label='Default select example' style='width:80px' id='selectCurrency' runat='server' name='Currency'></select>");
            if(curr == "IDR")
            {
                $(this).parent().parent().find("select.txtCurrency").append('<option value=' + curr + ' selected>' + curr + '</option>');
                $(this).parent().parent().find("select.txtCurrency").append("<option value='USD'>USD</option>");
            }
            else if(curr == "USD")
            {
                $(this).parent().parent().find("select.txtCurrency").append("<option value='IDR'>IDR</option>");
                $(this).parent().parent().find("select.txtCurrency").append('<option value=' + curr + ' selected>' + curr + '</option>');
            }
            else{
                $(this).parent().parent().find("select.txtCurrency").append("<option value='IDR'>IDR</option>");
                $(this).parent().parent().find("select.txtCurrency").append("<option value='USD'>USD</option>");
            }

            const unitcogs = $(this).parent().parent().find("td.tdUnitCOGS").html().trim();
            $(this).parent().parent().find("td.tdUnitCOGS").html("<input type='text' value='" + unitcogs + "' class='form-control txtUnitCOGS' style = 'width:150px; font-size: 13px'/>");
        

        if ($("#currentEmailProc").val() != null && $("#currentEmailProc").val() != ""){
            $(this).parent().parent().find("input.txtNo").addClass("readonly-select");
            $(this).parent().parent().find("select.txtPrincipal").addClass("readonly-select");
            $(this).parent().parent().find("select.txtItemDesc").addClass("readonly-select");
            $(this).parent().parent().find("input.txtInsurance").addClass("readonly-select");
            $(this).parent().parent().find("input.txtWarranty").addClass("readonly-select");
            $(this).parent().parent().find("input.txtQty").addClass("readonly-select");

            $(this).parent().parent().find("a.AttachSpecRKS").css("visibility", "hidden");
        
            $(this).parent().parent().find("a.btn-remove-spec").css("visibility", "hidden");

            const vendorname = $(this).parent().parent().find("td.tdVendor").html().trim();
            $(this).parent().parent().find("td.tdVendor").html("<select class='form-select form-control txtVendor' aria-label='Default select example' style='width:250px' id='selectVendor' runat='server' name='Vendor'></select>");
            var selectvendorhtml = $(this).parent().parent().find("select.txtVendor").html('');

            $.ajax({
                url: "/PreProcs/GetVendor/",
                type: "POST",
                dataType: "json",
                data: vendor,
                contentType: false,
                processData: false,
                success: function (data) {
                    selectvendorhtml.append("<option value=''>(Please Select)</option>");
                    for (var i in data) {
                        if (vendorname != data[i].vendorName) {
                            selectvendorhtml.append("<option value='" + data[i].vendorName + "'>" + data[i].vendorName + "</option>");
                        }
                        else {
                            selectvendorhtml.append("<option value='" + data[i].vendorName + "' selected>" + data[i].vendorName + "</option>");
                        }
                    }
                },
                error: function (data) {
                    console.log("error" + data[0]);
                }
            })

            let lenbtnattachvendorquot = $(this).parent().parent().find("a.AttachVendorQuot").length;

            let btnremovevendorquot = $(this).parent().parent().find("a.btn-remove-vendorquot").css("visibility", "visible");
            let btnattachvendorquot = $(this).parent().parent().find("a.AttachVendorQuot").css("visibility", "visible");

            let vendorquothtml = $(this).parent().parent().find("td.tdVendorQuot");

            if(lenbtnattachvendorquot == 0){
                vendorquothtml.html("");
            }

            $.ajax({
                url: "/PreProcs/GetAttachmentDetails/",
                type: "POST",
                dataType: "json",
                data: detailid,
                contentType: false,
                processData: false,
                success: function (data) {
                    for(var i=0;i<data.length;i++){
                        if(data[i].documentTypeId == 13)//attach spec
                        {
                            if(lenbtnattachvendorquot == 0){
                                vendorquothtml.append("<div class='divFileVendorQuot'><a  class='btn-down-vendorquot' id='" + data[i].id + "' style='width:80px;font-size: 12px; padding: 7px!important;margin-right: 5px;margin-left: 5px;' href='/Preprocs/GetFileAttachment?target="+ data[i].strictedFileName + ";" + data[i].fileName  +"'>" + data[i].fileName +"</a> <a class='text-danger btn-remove-vendorquot'><b><i class='bi bi-x-lg'></i></b></a></div><br>");
                            }
                        }
                    }
                    if(lenbtnattachvendorquot == 0){
                        vendorquothtml.append("<a class='btn btn-outline-secondary mt-lg-2 AttachVendorQuot' style='font-size: 12px; padding: 3px!important;' data-bs-toggle='modal' data-bs-target='#uploadVendorQuot'>Attach File</a>");
                    }
                },
                error: function (data) {
                    console.log(data.responseText)
                }
            })
        } 
        $(this).parent().parent().find("td.tdControl").html(rowUpdateButtons);
    });

    $('#tblData').on('click', 'a.btn-copy', function () {
        const no = $(this).parent().parent().find("td.tdNo").html();
        const principal = $(this).parent().parent().find("td.tdPrincipal").html();
        const itemdesc = $(this).parent().parent().find("td.tdItemDesc").html();
        const insurance = $(this).parent().parent().find("td.tdInsurance").html();
        const warranty = $(this).parent().parent().find("td.tdWarranty").html();
        const surduk = $(this).parent().parent().find("td.tdSurDuk").html();
        const qty = $(this).parent().parent().find("td.tdQty").html();
        const remark = $(this).parent().parent().next().find("td.tdRemark").html();

        $("td.tdNo").last().html("" + no + "");
        $("td.tdPrincipal").last().html("" + principal + "");
        $("td.tdItemDesc").last().html("" + itemdesc + "");
        $("td.tdInsurance").last().html("" + insurance + "");
        $("td.tdWarranty").last().html("" + warranty + "");
        $("td.tdSpecRKS").last().html("");
        $("td.tdSurDuk").last().html("" + surduk + "");
        $("td.tdQty").last().html("" + qty + "");
        $("td.tdRemark").last().html("" + remark + "");
        $("td.tdControl").last().html(rowButtons);
        $("#tabelnewitem").append("<tr></tr>");

        $("#tabelnewitem").append(emptyNewRow);
    });

    function changeStage() {
        var idStage = $('#selectStage').val();

        $('.inputAll').removeClass("readonly-select"); //RFPID, ProposalNo, QuotationNo, Tender, SubconQuotDeadline, Hedging, Warranty

        selDiv.innerHTML = "<label class=\"col-form-label control-label\" >" + "Est. % GP" + "<b class=\"text-red\" > * </b> (Ex: 8.20)" + "</label>" + "<span class=\"text-danger\" > </span>";
        selDiv2.innerHTML = "<label class=\"col-form-label control-label\" >" + "PIC Procurement" + "<b class=\"text-red\"> * </b>" + "</label>" + "<span class=\"text-danger\" > </span > ";
        selDiv3.innerHTML = "<label class=\"col-form-label control-label\" >" + "Proposal No." + "</label>" + "<span class=\"text-danger\" > </span>";
        selDiv4.innerHTML = "<label class=\"col-form-label control-label\" >" + "Quotation No." + "</label>" + "<span class=\"text-danger\" > </span>";
        selDiv6.innerHTML = "<label class=\"col-form-label control-label\" >" + "1. RFP / RKS" + "<span class=\"text-danger\" > </span>";
        selDiv7.innerHTML = "<label class=\"col-form-label control-label\" >" + "2. Quotation to Customer" + "<span class=\"text-danger\" > </span>";
        selDiv8.innerHTML = "<label class=\"col-form-label control-label\" >" + "3. Proposal" + "<span class=\"text-danger\" > </span>";

        $('#btnselectbod').css("visibility", "hidden");

        if (idStage == 'RiskAssessment' || idStage == 'Risk Assessment') { //RISK ASSESSMENT
            $('.inputAll').addClass("readonly-select");
            $('.visiblePID').css("display", "none");
            $('.visiblePreID').css("display", "block");
            selDiv2.innerHTML = "<label class=\"col-form-label control-label\" >" + "PIC Procurement" + "</label>" + "<span class=\"text-danger\" > </span>";
            selDiv5.innerHTML = "<label class=\"col-form-label control-label\" >" + "Proposal Submission Date" + "<b class=\"text-red\" > * </b>" + "</label>" + "<span class=\"text-danger\" > </span>";
            $('#btnselectbod').css("visibility", "visible");
        }
        else if (idStage == 'Presales') { //PRESALES
            $('.visiblePID').css("display", "none");
            $('.visiblePreID').css("display", "block");
            selDiv5.innerHTML = "<label class=\"col-form-label control-label\" >" + "Proposal Submission Date" + "<b class=\"text-red\" > * </b>" + "</label>" + "<span class=\"text-danger\" > </span>";
            selDiv6.innerHTML = "<label class=\"col-form-label control-label\" >" + "1. RFP / RKS" + "<b class=\"text-red\" > * </b>" + "</label>" + "<span class=\"text-danger\" > </span>";
        }
        else { //DELIVERY
            $('.visiblePID').css("display", "block");
            $('.visiblePreID').css("display", "none");
            selDiv.innerHTML = "<label class=\"col-form-label control-label\" >" + "Est. % GP (Ex: 8.20)" + "</label>" + "<span class=\"text-danger\" > </span>";
            selDiv3.innerHTML = "<label class=\"col-form-label control-label\" >" + "Proposal No." + "<b class=\"text-red\"> ** </b>" + "</label>" + "<span class=\"text-danger\" > </span>";
            selDiv4.innerHTML = "<label class=\"col-form-label control-label\" >" + "Quotation No." + "<b class=\"text-red\"> ** </b>" + "</label>" + "<span class=\"text-danger\" > </span>";
            selDiv5.innerHTML = "<label class=\"col-form-label control-label\" >" + "Proposal Submission Date" + "</label>" + "<span class=\"text-danger\"> </span>";
            selDiv7.innerHTML = "<label class=\"col-form-label control-label\" >" + "2. Quotation to Customer" + "<b class=\"text-red\"> ** </b>" + "<span class=\"text-danger\" > </span>";
            selDiv8.innerHTML = "<label class=\"col-form-label control-label\" >" + "3. Proposal" + "<b class=\"text-red\"> ** </b>" + "<span class=\"text-danger\" > </span>";
        }

    }

    function uploadexcelfile() {
        $("#errorFormatExt").css("visible", "none");
        var myfile = document.querySelector("#fileUpload");
        var temppreprocid = document.querySelector("#preprocid").getAttribute("value");
        var fileUpload = new FormData();

        if (myfile.files.length > 0) {
            for (var i = 0; i < myfile.files.length; i++) {
                fileUpload.append("fileUpload", myfile.files[i]);
                fileUpload.append("preprocid", temppreprocid);
            }
        }

        $("#myLoadingElement").show();

        var tempfile = myfile.files[0].name.split('.');
        $("tr.linedetailitem").last().remove();
        $("tr.lineremark").last().remove();

        if (tempfile[tempfile.length - 1] == "xls" || tempfile[tempfile.length - 1] == "xlsx") {
            

            $.ajax({
                url: "/PreProcs/ReadExcel/",
                type: "POST",
                dataType: "json",
                data: fileUpload,
                contentType: false,
                processData: false,
                success: function (data) {
                    for (var i = 0; i < data.length; i++) {
    @* $(this).parent().parent().find("td.tdControl").html(rowButtons); *@
                        
                        $("#tabelnewitem").append(emptyNewRowWithoutTextAreaRemark);
                        $("td.tdControl").last().html(rowButtons)
                        $("td.tdNo").last().html("" + data[i].idnew + "");
                        $("td.tdPrincipal").last().html("" + data[i].principle + "");
                        $("td.tdItemDesc").last().html("" + data[i].itemDesc + "");

                        $("input.txtNKPCode").last().val(data[i].nkpcode);
                        $("input.txtDetailId").last().val(data[i].detailId);

                        if (data[i].insurance == true) {
                            $("td.tdInsurance").last().html("Y");
                        } else {
                            $("td.tdInsurance").last().html("N");
                        }
                        $("td.tdWarranty").last().html("" + data[i].warranty + "");
                        $("td.tdSpecRKS").last().html("");
                        if (data[i].surDukCheck == true) {
                            $("td.tdSurDuk").last().html("Y");
                        } else {
                            $("td.tdSurDuk").last().html("N");
                        }
                        $("td.tdQty").last().html("" + data[i].qty + "");

                        
    @* alert(data[i].itemDesc + data[i].principle + data[i].nkpcode + data[i].qty + data[i].warranty + data[i].insurance + data[i].surDukCheck); *@
                    }
                },
                complete: function () {
                    // $('a#closeModalUpload').trigger("click");
                    $('a#closeModalUpload').click(function () {
                        // 'this' is not a jQuery object, so it will use
                        // the default click() function
                        this.click();
                    }).click();
                    $('#myLoadingElement').hide();
                    $("#tabelnewitem").append("<tr></tr>");
                    $("#tabelnewitem").append(emptyNewRow);
                },
                error: function (data) {
                    console.log("error" + data[0]);
                }
            })
        }
        else{
            $('#myLoadingElement').hide();
            var tes = document.querySelector('#errorFormatExt');
            tes.removeAttribute("hidden", "");
        }
        
    }

    $('#tblData').on('change', 'select.txtPrincipal', function () {
        var vendor = new FormData();

        if ($(this).parent().parent().find("a.btn-submit").html() == undefined){
            vendor.append("vendor", $(this).parent().parent().find("select.txtPrincipal").val());
            var select = $(this).parent().parent().find("select.txtItemDesc").html('');
            var textbox = $(this).parent().parent().find("input.txtItemDescOthers");

            if ($(this).parent().parent().find("select.txtPrincipal").val() == "Others") {
                textbox.css('display', 'block');
            }
            else {
                textbox.css('display', 'none');
            }

            $.ajax({
                url: "/PreProcs/ChangeListNKP/",
                type: "POST",
                dataType: "json",
                data: vendor,
                contentType: false,
                processData: false,
                success: function (data) {
                    $(select).append("<option selected=''>(Please Select)</option>");
                    for (var i in data) {
                        $(select).append('<option value=' + data[i].nkpcodeLinkTitle + '>' + data[i].nkpname + '</option>');
                    }
                },
                error: function (data) {
                    console.log("error" + data[0]);
                }
            })
        }
        else{
            vendor.append("vendor", $("select.txtPrincipal").last().val());

            var select = $("select.txtItemDesc").last().html('');
            var textbox = $("input.txtItemDescOthers").last();

            $.ajax({
                url: "/PreProcs/ChangeListNKP/",
                type: "POST",
                dataType: "json",
                data: vendor,
                contentType: false,
                processData: false,
                success: function (data) {
                    if ($("select.txtPrincipal").last().val() == "Others") {
                        textbox.css('display', 'block');
                    }
                    else {
                        textbox.css('display', 'none');
                    }
                    $(select).append("<option selected=''>(Please Select)</option>");
                    for (var i in data) {
                        $(select).append('<option value=' + data[i].nkpcodeLinkTitle + '>' + data[i].nkpname + '</option>');
                    }
                },
                error: function (data) {
                    console.log("error" + data[0]);
                }
            })
        }
        
    });

    $('#tblData').on('click', 'input.txtSurDuk', function () {
            if($(this).prop("checked") == true){
                $(this).parent().parent().find("a.AttachSurDuk").css('visibility', 'visible');
            }
            else{
                $(this).parent().parent().find("a.AttachSurDuk").css('visibility', 'hidden');
            }
    });

    $('#tblData').on('click', 'a.btn-remove-spec', function () {
        $(this).parent().remove();
    });

    $('#tblData').on('click', 'a.btn-remove-surduk', function () {
        $(this).parent().remove();
    });

    $('.tblPO').on('click', 'a.btn-remove-po', function () {
        $(this).parent().parent().remove();
    });

    $('#tblData').on('click', 'a.AttachSpecRKS', function () {
        var detailid = $(this).parent().parent().find("input.txtDetailId").val();

        $("#idAttachSpec").html("<input type='hidden' value='"+ detailid +"' class='form-control' id='modalspecdetailid'/><input type='file' name='fileUploadspec' class='form-control' id='fileUploadspec' multiple/>");
    });

    $('#tblData').on('click', 'a.AttachSurDuk', function () {
        var detailid = $(this).parent().parent().find("input.txtDetailId").val();

        $("#idAttachSurDuk").html("<input type='hidden' value='"+ detailid +"' class='form-control' id='modalsurdukdetailid'/><input type='file' name='fileUploadsurduk' class='form-control' id='fileUploadsurduk' multiple/>");
    });

    $('#tblData').on('click', 'a.AttachVendorQuot', function () {
        var detailid = $(this).parent().parent().find("input.txtDetailId").val();

        $("#idAttachVendorQuot").html("<input type='hidden' value='"+ detailid +"' class='form-control' id='modalvendorquotdetailid'/><input type='file' name='fileUploadvendorquot' class='form-control' id='fileUploadvendorquot' multiple/>");
    });

    function uploadspecfile() {
        var myfile = document.querySelector("#fileUploadspec");
        var fileUploadspec = new FormData();
        var det = $("#idAttachSpec").find("#modalspecdetailid").val();
        var temppreprocid = document.querySelector("#preprocid").getAttribute("value");

        if (myfile.files.length > 0) {
            for (var i = 0; i < myfile.files.length; i++) {
                fileUploadspec.append("fileUploadspec", myfile.files[i]);
                fileUploadspec.append("preprocid", temppreprocid);
                if(det != "" || det != null){
                    fileUploadspec.append("detailid", det);
                }
            }
        }

        $.ajax({
            url: "/PreProcs/SaveAttachSpec/",
            type: "POST",
            dataType: "json",
            data: fileUploadspec,
            contentType: false,
            processData: false,
            success: function (data) {
                if(det != null && det != ""){
                    $('input:hidden.txtDetailId').each(function () {
                        if($(this).val() == det){
                            $(this).parent().find("td.tdSpecRKS").find("a.AttachSpecRKS").remove();
                            var tes = $(this).parent().find("td.tdSpecRKS");
                            if (myfile.files.length > 0) {
                                for (var i = 0; i < myfile.files.length; i++) {
                                    tes.append("<div class='divFileSpec'>" + myfile.files[i].name + " <a class='text-danger btn-remove-spec'><b><i class='bi bi-x-lg'></i></b></a><br><br></div>");
                                }
                            }
                            tes.append("<a class='btn btn-outline-secondary mt-lg-2 AttachSpecRKS' style='font-size: 12px; padding: 3px!important;min-width:80px' data-bs-toggle='modal' data-bs-target='#uploadSpec'>Attach File</a>");
                            var idspec = $(this).parent().find("input.txtIDAttachSpec").val(data.responseText);
                            return false;
                        }
                    
                    });
                }
                else{
                    if (myfile.files.length > 0) {
                        $("td.tdSpecRKS").last().html("");
                        for (var i = 0; i < myfile.files.length; i++) {
                            $("td.tdSpecRKS").last().append("<div class='divFileSpec'>" + myfile.files[i].name + " <a class='text-danger btn-remove-spec'><b><i class='bi bi-x-lg'></i></b></a><br><br></div>");
                        }
                    }
                    $("td.tdSpecRKS").last().append("<a class='btn btn-outline-secondary mt-lg-2 AttachSpecRKS' style='min-width:80px;font-size: 12px; padding: 3px!important;' data-bs-toggle='modal' data-bs-target='#uploadSpec'>Attach File</a>");
                    $("input.txtIDAttachSpec").last().val(data.responseText);

                }
                
                // $("td.tdSpecRKS").last().html("<a  class='btn btn-outline-success btn-spec' style='font-size: 12px; padding: 7px!important;'>" + myfile.files[0].name + "</a>" + data[i].principle + "");
                alert("Successfully attached.");
            },
            statusCode: { 
                500: function(response) {
                   console.log(response)
                }
            },
            error: function (data) {
                console.log(data.responseText);
                
                if(det != null && det != ""){
                    $('input:hidden.txtDetailId').each(function () {
                        if($(this).val() == det){
                            $(this).parent().find("td.tdSpecRKS").find("a.AttachSpecRKS").remove();
                            var tes = $(this).parent().find("td.tdSpecRKS");
                            if (myfile.files.length > 0) {
                                for (var i = 0; i < myfile.files.length; i++) {
                                    tes.append("<div class='divFileSpec'>" + myfile.files[i].name + " <a class='text-danger btn-remove-spec'><b><i class='bi bi-x-lg'></i></b></a><br><br></div>");
                                }
                            }
                            tes.append("<a class='btn btn-outline-secondary mt-lg-2 AttachSpecRKS' style='font-size: 12px; padding: 3px!important;min-width:80px' data-bs-toggle='modal' data-bs-target='#uploadSpec'>Attach File</a>");
                            var idspec = $(this).parent().find("input.txtIDAttachSpec").val(data.responseText);
                            return false;
                        }
                    
                    });
                }
                else{
                    if (myfile.files.length > 0) {
                        $("td.tdSpecRKS").last().html("");
                        for (var i = 0; i < myfile.files.length; i++) {
                            $("td.tdSpecRKS").last().append("<div class='divFileSpec'>" + myfile.files[i].name + " <a class='text-danger btn-remove-spec'><b><i class='bi bi-x-lg'></i></b></a><br><br></div>");
                        }
                    }
                    $("td.tdSpecRKS").last().append("<a class='btn btn-outline-secondary mt-lg-2 AttachSpecRKS' style='min-width:80px;font-size: 12px; padding: 3px!important;' data-bs-toggle='modal' data-bs-target='#uploadSpec'>Attach File</a>");
                    $("input.txtIDAttachSpec").last().val(data.responseText);

                }
                
                alert("Successfully attached.");
            }
        })
    }

    function uploadvendorquotfile() {
        var myfile = document.querySelector("#fileUploadvendorquot");
        var fileUploadvendorquot = new FormData();
        var det = $("#idAttachVendorQuot").find("#modalvendorquotdetailid").val();
        var temppreprocid = document.querySelector("#preprocid").getAttribute("value");

        if (myfile.files.length > 0) {
            for (var i = 0; i < myfile.files.length; i++) {
                fileUploadvendorquot.append("fileUploadvendorquot", myfile.files[i]);
                fileUploadvendorquot.append("preprocid", temppreprocid);
                if(det != "" || det != null){
                    fileUploadvendorquot.append("detailid", det);
                }
            }
        }

        $.ajax({
            url: "/PreProcs/SaveAttachVendorQuot/",
            type: "POST",
            dataType: "json",
            data: fileUploadvendorquot,
            contentType: false,
            processData: false,
            success: function (data) {
                if(det != null && det != ""){
                    $('input:hidden.txtDetailId').each(function () {
                        if($(this).val() == det){
                            if (myfile.files.length > 0) {
                                var tes = $(this).parent().find("td.tdVendorQuot").html("");
                                for (var i = 0; i < myfile.files.length; i++) {
                                    tes.append("<div class='divFileVendorQuot'>" + myfile.files[i].name + " <a class='text-danger btn-remove-vendorquot'><b><i class='bi bi-x-lg'></i></b></a><br></div>");
                                }
                            }
                            tes.append("<a class='btn btn-outline-secondary mt-lg-2 AttachVendorQuot' style='font-size: 12px; padding: 3px!important;min-width:80px' data-bs-toggle='modal' data-bs-target='#uploadVendorQuot'>Attach File</a>");

                            return false;
                        }
                    
                    });
                    console.log(data);
                }
                else{
                    if (myfile.files.length > 0) {
                        $("td.tdVendorQuot").last().html("");
                        for (var i = 0; i < myfile.files.length; i++) {
                            $("td.tdVendorQuot").last().append("<div class='divFileVendorQuot'>" + myfile.files[i].name + " <a class='text-danger btn-remove-vendorquot'><b><i class='bi bi-x-lg'></i></b></a><br></div>");
                        }
                    }
                    $("td.tdVendorQuot").last().append("<a class='btn btn-outline-secondary mt-lg-2 AttachVendorQuot' style='min-width:80px;font-size: 12px; padding: 3px!important;' data-bs-toggle='modal' data-bs-target='#uploadVendorQuot'>Attach File</a>");

                    console.log(data);

                    // var detailid = $("input.txtDetailId").last().val();

                    // if(detailid == null || detailid == ""){
                    //     $("input.txtDetailId").last().val(data.detailid);

                    // }
                }
                
                // $("td.tdSpecRKS").last().html("<a  class='btn btn-outline-success btn-spec' style='font-size: 12px; padding: 7px!important;'>" + myfile.files[0].name + "</a>" + data[i].principle + "");
                alert("Successfully attached.");
            },
            statusCode: { 
                500: function(response) {
                   console.log(response)
                }
            },
            error: function (data) {
                console.log(data.responseText);
                
                if(det != null && det != ""){
                    $('input:hidden.txtDetailId').each(function () {
                        if($(this).val() == det){
                            $(this).parent().find("td.tdVendorQuot").find("a.AttachVendorQuot").remove();
                            var tes = $(this).parent().find("td.tdVendorQuot");
                            if (myfile.files.length > 0) {
                                for (var i = 0; i < myfile.files.length; i++) {
                                    tes.append("<div class='divFileVendorQuot'>" + myfile.files[i].name + " <a class='text-danger btn-remove-vendorquot'><b><i class='bi bi-x-lg'></i></b></a><br><br></div>");
                                }
                            }
                            tes.append("<a class='btn btn-outline-secondary mt-lg-2 AttachVendorQuot' style='font-size: 12px; padding: 3px!important;min-width:80px' data-bs-toggle='modal' data-bs-target='#uploadVendorQuot'>Attach File</a>");
                            var idspec = $(this).parent().find("input.txtIDAttachVendorQuot").val(data.responseText);
                            return false;
                        }
                    
                    });
                }
                else{
                    if (myfile.files.length > 0) {
                        $("td.tdVendorQuot").last().html("");
                        for (var i = 0; i < myfile.files.length; i++) {
                            $("td.tdVendorQuot").last().append("<div class='divFileVendorQuot'>" + myfile.files[i].name + " <a class='text-danger btn-remove-vendorquot'><b><i class='bi bi-x-lg'></i></b></a><br></div>");
                        }
                    }
                    $("td.tdVendorQuot").last().append("<a class='btn btn-outline-secondary mt-lg-2 AttachVendorQuot' style='min-width:80px;font-size: 12px; padding: 3px!important;' data-bs-toggle='modal' data-bs-target='#uploadVendorQuot'>Attach File</a>");
                    $("input.txtIDAttachVendorQuot").last().val(data.responseText);

                }
                
                alert("Successfully attached.");
            }
        })
    }

    $('#btn-update-revenue').on('click', function () {
        var detailid = new FormData();
        var procid = document.querySelector("#preprocid").getAttribute("value");

        $('input:checkbox.checkItem').each(function () {
            if(this.checked == true){
                detailid.append("procid", procid);
                detailid.append("detailid", $(this).val());
            }
        });

        $.ajax({
            url: "/PreProcs/GetItemCheckedDetails/",
            type: "POST",
            dataType: "json",
            data: detailid,
            contentType: false,
            processData: false,
            success: function (data) {
                $("#bodyUpdateRevenue").html("");
                if(data.length > 0){
                    for(var i =0; i< data.length; i++){
                        var unitcogs = data[i].unitCogs ?? "";
                        var unitprice = data[i].unitPrice ?? "";

                        $("#bodyUpdateRevenue").append(" <tr> <td scope='col' class='text-center'>" + data[i].idnew + "</td><td scope='col'>" + data[i].itemDesc + "</td><td scope='col' class='' style='text-align:-webkit-center'>" + "<select class='form-select form-control txtCurrency' aria-label='Default select example' style='width:80px' id='selectCurrency' runat='server' name='Currency'> <option selected='IDR'>IDR</option> <option value='USD'>USD</option></select>" + "</td><td scope='col' class='text-center'><input class='form-control txtUnitCOGS' style='width:100%; font-size: 13px; text-align:right' type='text' value='" + unitcogs + "'></td><td scope='col' class='text-center'><input class='form-control txtUnitRevenue' style='width:100%; font-size: 13px; text-align:right' type='text' value='" + unitprice + "'></td>"+ "<input class='form-control txtDetailIdRevenue' type='hidden' value='" + data[i].detailId + "'></tr>")
                    }
                }
            },
            error: function (data) {
                console.log("error" + data[0]);
            }
        })
    })

    function submitValueRevenue() {
       var tempprocid = document.querySelector("#preprocid").getAttribute("value");

       var procid = new FormData();

       $('select.txtCurrency').each(function () {
           procid.append("procid", tempprocid);
           procid.append("currency", $(this).val());
           procid.append("unitcogs", $(this).parent().parent().find("input:text.txtUnitCOGS").val());
           procid.append("unitrevenue", $(this).parent().parent().find("input:text.txtUnitRevenue").val());
           procid.append("detailid", $(this).parent().parent().find("input:hidden.txtDetailIdRevenue").val());
           
           var detailid = $(this).parent().parent().find("input:hidden.txtDetailIdRevenue").val();
           var currency = $(this).val();
           var unitcogs = $(this).parent().parent().find("input:text.txtUnitCOGS").val();
           var unitrevenue = $(this).parent().parent().find("input:text.txtUnitRevenue").val();

           $('input:hidden.txtDetailId').each(function () {
                if($(this).val() == detailid){
                    $(this).parent().find("td.tdCurrency").html(currency);
                    $(this).parent().find("td.tdUnitCOGS").html(unitcogs);
                    $(this).parent().find("td.tdTotalCOGS").html(parseFloat(unitcogs) * parseFloat($(this).parent().find("td.tdQty").html().trim()));
                    $(this).parent().find("td.tdUnitRevenue").html(unitrevenue);
                    $(this).parent().find("td.tdTotalRevenue").html(parseFloat(unitrevenue) * parseFloat($(this).parent().find("td.tdQty").html().trim()));
                }
            });
       });

       //COMMENT SEMENTARA
       $.ajax({
            url: "/PreProcs/PostUpdateRevenue/",
            type: "POST",
            dataType: "json",
            data: procid,
            contentType: false,
            processData: false,
            success: function (data) {
                for(var i =0;i<data.length;i++){
                    $('input:hidden.txtDetailId').each(function () {
                        if($(this).val() == data[i].detailId){
                            $(this).parent().find("td.tdCurrency").html(data[i].currency);
                            $(this).parent().find("td.tdUnitCOGS").html(data[i].unitCogs);
                            $(this).parent().find("td.tdTotalCOGS").html(data[i].totalCogs);
                            $(this).parent().find("td.tdUnitRevenue").html(data[i].unitPrice);
                            $(this).parent().find("td.tdTotalRevenue").html(data[i].totalPrice);
                        }
                    });
                }
            },
            error: function (data) {
                console.log("error" + data[0]);
            }
        })
    }

    $('#btn-update-cogs').on('click', function () {
        var detailid = new FormData();
        var procid = document.querySelector("#preprocid").getAttribute("value");

        $('input:checkbox.checkItem').each(function () {
            if(this.checked == true){
                detailid.append("procid", procid);
                detailid.append("detailid", $(this).val());
            }
        });

        $.ajax({
            url: "/PreProcs/GetItemCheckedDetails/",
            type: "POST",
            dataType: "json",
            data: detailid,
            contentType: false,
            processData: false,
            success: function (data) {
                $("#bodyUpdateCOGS").html("");
                if(data.length > 0){
                    for(var i =0; i< data.length; i++){
                        var unitcogs = data[i].unitCogs ?? "";

                        $("#bodyUpdateCOGS").append(" <tr> <td scope='col' class='text-center'>" + data[i].idnew + "</td><td scope='col'>" + data[i].itemDesc + "</td><td scope='col' class='' style='text-align:-webkit-center'>" + "<select class='form-select form-control txtCurrency' aria-label='Default select example' style='width:80px' id='selectCurrency' runat='server' name='Currency'> <option selected='IDR'>IDR</option> <option value='USD'>USD</option></select>" + "</td><td scope='col' class='text-center'>" + "<input class='form-control txtUnitCOGS' style='width:100%; font-size: 13px; text-align:right' type='text' value='" + unitcogs + "'>" + "</td> <input class='form-control txtDetailIdCOGS' type='hidden' value='" + data[i].detailId + "'></tr>")
                    }
                }
            },
            error: function (data) {
                console.log("error" + data[0]);
            }
        })
    })

    function submitValueCOGS() {
       var tempprocid = document.querySelector("#preprocid").getAttribute("value");

       var procid = new FormData();

       $('select.txtCurrency').each(function () {
           procid.append("procid", tempprocid);
           procid.append("currency", $(this).val());
           procid.append("unitcogs", $(this).parent().parent().find("input:text.txtUnitCOGS").val());
           procid.append("detailid", $(this).parent().parent().find("input:hidden.txtDetailIdCOGS").val());
       });

       $.ajax({
            url: "/PreProcs/PostUpdateCOGS/",
            type: "POST",
            dataType: "json",
            data: procid,
            contentType: false,
            processData: false,
            success: function (data) {
                for(var i =0;i<data.length;i++){
                    $('input:hidden.txtDetailId').each(function () {
                        if($(this).val() == data[i].detailId){
                            $(this).parent().find("td.tdCurrency").html(data[i].currency);
                            $(this).parent().find("td.tdUnitCOGS").html(data[i].unitCogs);
                            $(this).parent().find("td.tdTotalCOGS").html(data[i].totalCogs);
                        }
                    });
                }
                alert("Unit COGS has been updated.")
            },
            error: function (data) {
                console.log("error" + data[0]);
            }
        })
    }

    $('#btn-update-risk').on('click', function () {
        var detailid = new FormData();
        var procid = document.querySelector("#preprocid").getAttribute("value");

        $('input:checkbox.checkItem').each(function () {
            if(this.checked == true){
                detailid.append("procid", procid);
                detailid.append("detailid", $(this).val());
            }
        });

        $.ajax({
            url: "/PreProcs/GetItemCheckedDetails/",
            type: "POST",
            dataType: "json",
            data: detailid,
            contentType: false,
            processData: false,
            success: function (data) {
                $("#bodyUpdateRisk").html("");
                if(data.length > 0){
                    for(var i =0; i< data.length; i++){
                        $("#bodyUpdateRisk").append(" <tr> <td scope='col' class='text-center'>" + data[i].idnew + "</td><td scope='col'>" + data[i].itemDesc + "</td><td scope='col' class='' style='text-align:-webkit-center'>" + "<select class='form-select form-control txtMultiRisk' aria-label='Default select example' style='width:115px' id='selectMultiRisk' runat='server' name='MultiRisk'> <option selected=''></option> <option value='Low'>Low</option><option value='Medium'>Medium</option><option value='High'>High</option></select></td> <input class='form-control txtDetailIdRisk' type='hidden' value='" + data[i].detailId + "'></tr>")
                    }
                }
            },
            error: function (data) {
                console.log("error" + data[0]);
            }
        })
    })

    function submitValueRisk() {
       var tempprocid = document.querySelector("#preprocid").getAttribute("value");

       var procid = new FormData();

       $('select.txtMultiRisk').each(function () {
           procid.append("procid", tempprocid);
           procid.append("risk", $(this).val());
           procid.append("detailid", $(this).parent().parent().find("input:hidden.txtDetailIdRisk").val());
       });

       $.ajax({
            url: "/PreProcs/PostUpdateRisk/",
            type: "POST",
            dataType: "json",
            data: procid,
            contentType: false,
            processData: false,
            success: function (data) {
                for(var i =0;i<data.length;i++){
                    $('input:hidden.txtDetailId').each(function () {
                        if($(this).val() == data[i].detailId){
                            $(this).parent().find("td.tdRisk").html(data[i].risk);
                        }
                    });
                }
            },
            error: function (data) {
                console.log("error" + data[0]);
            }
        })
    }

    $('#btn-update-review').on('click', function () {
        var detailid = new FormData();
        var procid = document.querySelector("#preprocid").getAttribute("value");

        $('input:checkbox.checkItem').each(function () {
            if(this.checked == true){
                detailid.append("procid", procid);
                detailid.append("detailid", $(this).val());
            }
        });

        $.ajax({
            url: "/PreProcs/GetItemCheckedDetails/",
            type: "POST",
            dataType: "json",
            data: detailid,
            contentType: false,
            processData: false,
            success: function (data) {
                $("#bodyUpdateReview").html("");
                if(data.length > 0){
                    for(var i =0; i< data.length; i++){
                        $("#bodyUpdateReview").append(" <tr> <td scope='col' class='text-center'>" + data[i].idnew + "</td><td scope='col'>" + data[i].itemDesc + "</td><td scope='col' class='col-1'>" + "<div class='form-check col-1'><input class='form-check-input txtMultiReview' type='radio' name='multireview" + i + "' id='multireview1' value='Approved'> <label class='form-check-label' for='multireview1'>Approved</label></div> <div class='form-check col-1'><input class='form-check-input txtMultiReview' type='radio' name='multireview" + i + "'id='multireview2' value='Rejected'><label class='form-check-label' for='multireview2'>Rejected</label></div><b>Review Comment</b><br><textarea class='txtMultiComment form-control mt-lg-2' placeholder='(Type review here)' style='width:250px;height:50px;font-size:12px'></textarea></td> <input class='form-control txtDetailIdReview' type='hidden' value='" + data[i].detailId + "'></td></tr>")
                    }
                }
            },
            error: function (data) {
                console.log("error" + data[0]);
            }
        })
    })

    function submitValueReview() {
       var tempprocid = document.querySelector("#preprocid").getAttribute("value");

       var procid = new FormData();

       $('input:radio.txtMultiReview').each(function () {
           if(this.checked == true){
                procid.append("procid", tempprocid);
                procid.append("status", $(this).val());
                procid.append("comment", $(this).parent().parent().find("textarea.txtMultiComment").val());
                procid.append("detailid", $(this).parent().parent().parent().find("input:hidden.txtDetailIdReview").val());
           }
       });

       $.ajax({
            url: "/PreProcs/PostUpdateReview/",
            type: "POST",
            dataType: "json",
            data: procid,
            contentType: false,
            processData: false,
            success: function (data) {
                // for(var i =0;i<data.length;i++){
                //     $('input:hidden.txtDetailId').each(function () {
                //         if($(this).val() == data[i].detailId){
                //             if(data[i].approverRole == "Presales"){
                //                 $(this).parent().find("td.tdPresalesReview").html(data[i].status);
                //             }
                //             else if (data[i].approverRole == "Account Manager") {
                //                 $(this).parent().find("td.tdAMReview").html(data[i].status);
                //             }
                //         }
                //     });
                // }
                alert("Successfully reviewed.")
                $("#modalLoadingElement").show()
                $("#modalLoadingElement").addClass("show")
                modalBackdrop.style.display = "block";

                window.location.reload()
            },
            error: function (data) {
                console.log("error" + data[0]);
            }
        })
    }

    $('#btn-assign-pm').on('click', function () {
        var detailid = new FormData();
        var procid = document.querySelector("#preprocid").getAttribute("value");

        $('input:checkbox.checkItem').each(function () {
            if(this.checked == true){
                detailid.append("procid", procid);
                detailid.append("detailid", $(this).val());
            }
        });

        var count = 0;
        var abc = "";

        $.ajax({
            url: "/PreProcs/GetItemCheckedDetails/",
            type: "POST",
            dataType: "json",
            data: detailid,
            contentType: false,
            processData: false,
            success: function (data) {
                $("#bodyAssignPM").html("");
                if(data.length > 0){
                    for(var i =0; i< data.length; i++){
                        $("#bodyAssignPM").append(" <tr> <td scope='col' class='text-center'>" + data[i].idnew + "</td><td scope='col'>" + data[i].itemDesc + "</td> <td scope='col' style='text-align:-webkit-center'>" + "<select class='form-select form-control txtMultiPM' aria-label='Default select example' style='width:250px' id='selectMultiPM" + i + "' runat='server' name='MultiPM'></select><input class='form-control txtDetailIdPM' type='hidden' value='" + data[i].detailId + "'></td></tr>");
                        getPM(data[i].principle);
                    }
                }
            },
            error: function (data) {
                console.log("error" + data[0]);
            }
        })
    })

    function getPM(tempvendor){
        var selectpmhtml = $("select.txtMultiPM").last().html('');
        selectpmhtml.append("<option selected=''></option>");

        var vendor = new FormData();
        vendor.append("vendor", tempvendor);

        $.ajax({
            url: "/PreProcs/ChangeListNKP/",
            type: "POST",
            dataType: "json",
            data: vendor,
            contentType: false,
            processData: false,
            success: function (data1) {
                //Begin distinct array
                var flags = [], output = [], outputdomain = [], l = data1.length;
                
                for( i=0; i<l; i++) {
                    if( flags[data1[i].productManager]) continue;
                    flags[data1[i].productManager] = true;
                    output.push(data1[i].productManager);
                    outputdomain.push(data1[i].domain);
                }
                //end
                for(var i =0; i< output.length; i++){
                    selectpmhtml.append("<option value='" + outputdomain[i] + "'>" + output[i] + "</option>");
                }
            },
            error: function (data1) {
                console.log("error" + data1[0]);
            }
        })
    }

     function submitValuePM() {
       var tempprocid = document.querySelector("#preprocid").getAttribute("value");

       var procid = new FormData();

       $('select.txtMultiPM').each(function () {
           procid.append("procid", tempprocid);
           procid.append("pm", $(this).val());
           procid.append("detailid", $(this).parent().parent().find("input:hidden.txtDetailIdPM").val());
       });

       $.ajax({
            url: "/PreProcs/PostAssignPM/",
            type: "POST",
            dataType: "json",
            data: procid,
            contentType: false,
            processData: false,
            success: function (data) {
                for(var i =0;i<data.length;i++){
                    $('input:hidden.txtDetailId').each(function () {
                        if($(this).val() == data[i].detailId){
                            $(this).parent().find("td.tdPM").html(data[i].productManager);
                        }
                    });
                }
            },
            error: function (data) {
                $('select.txtMultiPM').each(function () {
                   var pm = $(this).val();
                   var detailid = $(this).parent().parent().find("input:hidden.txtDetailIdPM").val();

                   $('input:hidden.txtDetailId').each(function () {
                        if($(this).val() == detailid){
                            var principal = $(this).parent().find("select.txtPrincipal option:selected").val();

                            if(principal == undefined){
                                principal = $(this).parent().find("td.tdPrincipal").html().trim();
                            }
                            getProdMgrName(principal, pm, function(prodmgrname) {
                                $(this).parent().find("td.tdPM").html(prodmgrname);
                            }.bind(this));
                        }
                    });
               });
            }
        })
    }

    function getProdMgrName(tempvendor, domain, callback){
        var vendor = new FormData();
        vendor.append("vendor", tempvendor);
        var name;

        $.ajax({
            url: "/PreProcs/ChangeListNKP/",
            type: "POST",
            dataType: "json",
            data: vendor,
            contentType: false,
            processData: false,
            success: function (data1) {
                //Begin distinct array
                var flags = [], output = [], outputdomain = [], l = data1.length;
                
                for( i=0; i<l; i++) {
                    if( flags[data1[i].productManager]) continue;
                    flags[data1[i].productManager] = true;
                    output.push(data1[i].productManager);
                    outputdomain.push(data1[i].domain);
                }
                //end
                
                for (var i = 0; i < output.length; i++) {
                    if (outputdomain[i] == domain) {
                        callback(output[i]);
                        return;
                    }
                }
                callback(null);
            },
            error: function (data1) {
                console.log("error" + data1[0]);
                callback(null);
            }
        })
        
    }

    function uploadsurdukfile() {
        var myfile = document.querySelector("#fileUploadsurduk");
        var det = $("#idAttachSurDuk").find("#modalsurdukdetailid").val();
        var fileUploadsurduk = new FormData();
        var temppreprocid = document.querySelector("#preprocid").getAttribute("value");

        if (myfile.files.length > 0) {
            for (var i = 0; i < myfile.files.length; i++) {
                fileUploadsurduk.append("fileUploadsurduk", myfile.files[i]);
                fileUploadsurduk.append("preprocid", temppreprocid);
                if(det != "" || det != null){
                    fileUploadsurduk.append("detailid", det);
                }
            }
        }
        $.ajax({
            url: "/PreProcs/SaveAttachSurDuk/",
            type: "POST",
            dataType: "json",
            data: fileUploadsurduk,
            contentType: false,
            processData: false,
            success: function (data) {
                if(det != null && det != ""){
                    $('input:hidden.txtDetailId').each(function () {
                        if($(this).val() == det){
                            if (myfile.files.length > 0) {
                                var tes = $(this).parent().find("td.tdSurDuk").html("");
                                for (var i = 0; i < myfile.files.length; i++) {
                                    tes.append("<div class='divFileSurDuk'>" + myfile.files[i].name + " <a class='text-danger btn-remove-surduk'><b><i class='bi bi-x-lg'></i></b></a><br><br></div>")
                                }
                            }
                            tes.append("<a class='btn btn-outline-secondary mt-lg-2 AttachSurDuk' style='min-width:80px;font-size: 12px; padding: 3px!important;' data-bs-toggle='modal' data-bs-target='#uploadSurDuk'>Attach File</a>");
                            return false;
                        }
                    
                    });
                }
                else{
                    if (myfile.files.length > 0) {
                        for (var i = 0; i < myfile.files.length; i++) {
                            $("td.tdSurDuk").last().append("<div class='divFileSurDuk'>" + myfile.files[i].name + " <a class='text-danger btn-remove-surduk'><b><i class='bi bi-x-lg'></i></b></a><br><br></div>");
                        }
                    }
                    $("td.tdSurDuk").last().append("<a class='btn btn-outline-secondary mt-lg-2 AttachSurDuk' style='min-width:80px;font-size: 12px; padding: 3px!important;' data-bs-toggle='modal' data-bs-target='#uploadSurDuk'>Attach File</a>");
                    $("input.txtIDAttachSurduk").last().val(data.responseText);

                }
                alert("Successfully attached.");
            },
            error: function (data) {
                console.log(data.responseText);
            
                if(det != null && det != ""){
                    $('input:hidden.txtDetailId').each(function () {
                        if($(this).val() == det){
                            $(this).parent().find("td.tdSurDuk").find("a.AttachSurDuk").remove();
                            var tes = $(this).parent().find("td.tdSurDuk");
                            tes.append("<br>");
                            
                            if (myfile.files.length > 0) {
                                for (var i = 0; i < myfile.files.length; i++) {
                                    tes.append("<div class='divFileSurDuk'>" + myfile.files[i].name + " <a class='text-danger btn-remove-surduk'><b><i class='bi bi-x-lg'></i></b></a><br><br></div>");
                                }
                            }
                            tes.append("<a class='btn btn-outline-secondary mt-lg-2 AttachSurDuk' style='font-size: 12px; padding: 3px!important;min-width:80px' data-bs-toggle='modal' data-bs-target='#uploadSurDuk'>Attach File</a>");
                            var idsurduk = $(this).parent().find("input.txtIDAttachSurduk").val(data.responseText);
                            return false;
                        }
                
                    });
                }
                else{
                    if (myfile.files.length > 0) {
                        $("td.tdSurDuk").last().find("a.AttachSurDuk").remove();
                        for (var i = 0; i < myfile.files.length; i++) {
                            $("td.tdSurDuk").last().append("<div class='divFileSurDuk'>" + myfile.files[i].name + " <a class='text-danger btn-remove-surduk'><b><i class='bi bi-x-lg'></i></b></a><br><br></div>");
                        }
                    }
                    $("td.tdSurDuk").last().append("<a class='btn btn-outline-secondary mt-lg-2 AttachSurDuk' style='min-width:80px;font-size: 12px; padding: 3px!important;' data-bs-toggle='modal' data-bs-target='#uploadSurDuk'>Attach File</a>");
                    $("input.txtIDAttachSurduk").last().val(data.responseText);

                }
            
                alert("Successfully attached.");

            }
        })
    }

    function submitPMO() {
        var filespk = document.querySelector("#postedfilepmospk");
        var filerfp = document.querySelector("#postedfilepmorfp");
        var filequot = document.querySelector("#postedfilepmoquot");
        var fileproposal = document.querySelector("#postedfilepmoproposal");
        var fileboq = document.querySelector("#postedfilepmoboq");
        var filenego = document.querySelector("#postedfilepmonego");
        var fileother = document.querySelector("#postedfilepmoother");

        var procid = new FormData();
        var temppreprocid = document.querySelector("#preprocid").getAttribute("value");
        var txtCustomerPIC = $("#txtCustomerPIC").val();
        var txtHighLevelSOW = $("#txtHighLevelSOW").val();
        var txtProjectSite = $("#txtProjectSite").val();
        var txtProjectValue = $("#txtProjectValue").val();
        var txtEstStartDate = $("#txtEstStartDate").val();
        var txtEndDate = $("#txtEndDate").val();
        var txtKickOff = $("#txtKickOff").val();
        var txtKickOffDate = $("#txtKickOffDate").val();
        var txtProductTeamPIC = $("#txtProductTeamPIC").val();
        var txtSpecTerm = $("#txtSpecTerm").val();

        var checkCustPIC = $("#checkCustPIC").prop("checked");
        var checkHighLvlSOW = $("#checkHighLvlSOW").prop("checked");
        var checkProjectSite = $("#checkProjectSite").prop("checked");
        var checkProjectValue = $("#checkProjectValue").prop("checked");
        var checkEstStartDate = $("#checkEstStartDate").prop("checked");
        var checkEstKickOff = $("#checkEstKickOff").prop("checked");
        var checkProductTeamPIC = $("#checkProductTeamPIC").prop("checked");
        var checkAttachSPK = $("#checkAttachSPK").prop("checked");
        var checkAttachRFP = $("#checkAttachRFP").prop("checked");
        var checkAttachQuot = $("#checkAttachQuot").prop("checked");
        var checkAttachProposal = $("#checkAttachProposal").prop("checked");
        var checkAttachBOQ = $("#checkAttachBOQ").prop("checked");
        var checkAttachNego = $("#checkAttachNego").prop("checked");
        var checkAttachOther = $("#checkAttachOther").prop("checked");

        procid.append("procid", temppreprocid);
        procid.append("custpic", txtCustomerPIC);
        procid.append("highlvlsow", txtHighLevelSOW);
        procid.append("projectsite", txtProjectSite);
        procid.append("projectval", txtProjectValue);
        procid.append("eststartdate", txtEstStartDate);
        procid.append("enddate", txtEndDate);
        procid.append("estkickoff", txtKickOff);
        procid.append("kickoffdate", txtKickOffDate);
        procid.append("prodteampic", txtProductTeamPIC);
        procid.append("specterm", txtSpecTerm);

        procid.append("checkCustPIC", checkCustPIC);
        procid.append("checkHighLvlSOW", checkHighLvlSOW);
        procid.append("checkProjectSite", checkProjectSite);
        procid.append("checkProjectValue", checkProjectValue);
        procid.append("checkEstStartDate", checkEstStartDate);
        procid.append("checkEstKickOff", checkEstKickOff);
        procid.append("checkProductTeamPIC", checkProductTeamPIC);
        procid.append("checkAttachSPK", checkAttachSPK);
        procid.append("checkAttachRFP", checkAttachRFP);
        procid.append("checkAttachQuot", checkAttachQuot);
        procid.append("checkAttachProposal", checkAttachProposal);
        procid.append("checkAttachBOQ", checkAttachBOQ);
        procid.append("checkAttachNego", checkAttachNego);
        procid.append("checkAttachOther", checkAttachOther);

        if (filespk.files.length > 0) {
            procid.append("filespk", filespk.files[0]);
        }
        if (filerfp.files.length > 0) {
            procid.append("filerfp", filerfp.files[0]);
        }
        if (filequot.files.length > 0) {
            procid.append("filequot", filequot.files[0]);
        }
        if (fileproposal.files.length > 0) {
            procid.append("fileproposal", fileproposal.files[0]);
        }
        if (fileboq.files.length > 0) {
            procid.append("fileboq", fileboq.files[0]);
        }
        if (filenego.files.length > 0) {
            procid.append("filenego", filenego.files[0]);
        }
        if (fileother.files.length > 0) {
            procid.append("fileother", fileother.files[0]);
        }

        $.ajax({
            url: "/PreProcs/PostSubmitPMOChecklist/",
            type: "POST",
            dataType: "json",
            data: procid,
            contentType: false,
            processData: false,
            success: function (data) {
                $("#modalLoadingElement").show()
                $("#modalLoadingElement").addClass("show")
                modalBackdrop.style.display = "block";

                window.location.reload();
            },
            error: function (data) {
                console.log("error" + data[0]);
            }
        })
    }

    function notifPMOtoAM() {
        var procid = new FormData();
        var temppreprocid = document.querySelector("#preprocid").getAttribute("value");
        var txtCustomerPIC = $("#txtCustomerPIC").val();
        var txtHighLevelSOW = $("#txtHighLevelSOW").val();
        var txtProjectSite = $("#txtProjectSite").val();
        var txtProjectValue = $("#txtProjectValue").val();
        var txtEstStartDate = $("#txtEstStartDate").val();
        var txtEndDate = $("#txtEndDate").val();
        var txtKickOff = $("#txtKickOff").val();
        var txtKickOffDate = $("#txtKickOffDate").val();
        var txtProductTeamPIC = $("#txtProductTeamPIC").val();
        var txtSpecTerm = $("#txtSpecTerm").val();

        // procid.append("procid", temppreprocid);
        // procid.append("custpic", txtCustomerPIC);
        // procid.append("highlvlsow", txtHighLevelSOW);
        // procid.append("projectsite", txtProjectSite);
        // procid.append("projectval", txtProjectValue);
        // procid.append("eststartdate", txtEstStartDate);

        // $.ajax({
        //     url: "/PreProcs/PostSubmitPMOChecklist/",
        //     type: "POST",
        //     dataType: "json",
        //     data: procid,
        //     contentType: false,
        //     processData: false,
        //     success: function (data) {
        //         window.location.reload();
        //     },
        //     error: function (data) {
        //         console.log("error" + data[0]);
        //     }
        // })

        sendNotifbyType("NotifToAM");
    }

    function riskAssess() {
        var procid = new FormData();
        var temppreprocid = document.querySelector("#preprocid").getAttribute("value");
        var selectOverallRisk = $("#selectOverallRisk").val();
        var txtRiskDesc = $("#txtRiskDesc").val();
        var selectSourceBudget = $("#selectSourceBudget").val();
        var selectCompetition = $("#selectCompetition").val();
        var selectContingency = $("#selectContingency").val();
        var txtContingencyCost = $("#txtContingencyCost").val();
        var txtCompetitor = $("#txtCompetitor").val();
        var txtEstProjectStart = $("#txtEstProjectStart").val();
        var txtEstProjectEnd = $("#txtEstProjectEnd").val();
        var selectProcType = $("#selectProcType").val();
        var selectProjectSource = $("#selectProjectSource").val();
        var txtRevMLPT = $("#txtRevMLPT").val();
        var txtTotSubCon = $("#txtTotSubCon").val();
        var txtProcCondition = $("#txtProcCondition").val();
        var txtPredefinedCondition = $("#txtPredefinedCondition").val();
        var resultSelectedCommitteeDomain = $("#resultSelectedCommitteeDomain").val();

        var checkNewProduct = $("#checkNewProduct").prop("checked");
        var checkNewCustomer = $("#checkNewCustomer").prop("checked");
        var checkNewSubcon = $("#checkNewSubcon").prop("checked");
        var checkMultiSite = $("#checkMultiSite").prop("checked");
        var checkStringentReq = $("#checkStringentReq").prop("checked");
        var checkMultiSubcon = $("#checkMultiSubcon").prop("checked");
        var checkMultiPlatform = $("#checkMultiPlatform").prop("checked");
        var checkTightTimeline = $("#checkTightTimeline").prop("checked");
        var checkHarshPenalty = $("#checkHarshPenalty").prop("checked");
        var checkNonITSOW = $("#checkNonITSOW").prop("checked");
        var checkCustomerBehavior = $("#checkCustomerBehavior").prop("checked");
        var checkAppImplementation = $("#checkAppImplementation").prop("checked");
        var checkUnclearScope = $("#checkUnclearScope").prop("checked");
        var checkPayment100 = $("#checkPayment100").prop("checked");
        var checkResourceCapacity = $("#checkResourceCapacity").prop("checked");
        var checkResourceCapability = $("#checkResourceCapability").prop("checked");
        var checkTOP = $("#checkTOP").prop("checked");
        var checkGPProjection = $("#checkGPProjection").prop("checked");

        procid.append("procid", temppreprocid);
        procid.append("selectOverallRisk", selectOverallRisk);
        procid.append("txtRiskDesc", txtRiskDesc);
        procid.append("selectSourceBudget", selectSourceBudget);
        procid.append("selectCompetition", selectCompetition);
        procid.append("selectContingency", selectContingency);
        procid.append("txtContingencyCost", txtContingencyCost);
        procid.append("txtCompetitor", txtCompetitor);
        procid.append("txtEstProjectStart", txtEstProjectStart);
        procid.append("txtEstProjectEnd", txtEstProjectEnd);
        procid.append("selectProcType", selectProcType);
        procid.append("selectProjectSource", selectProjectSource);
        procid.append("txtRevMLPT", txtRevMLPT);
        procid.append("txtTotSubCon", txtTotSubCon);
        procid.append("txtProcCondition", txtProcCondition);
        procid.append("txtPredefinedCondition", txtPredefinedCondition);
        procid.append("resultSelectedCommitteeDomain", resultSelectedCommitteeDomain);

        procid.append("checkFactors", "Multi Site / Roll Out" + ";" + checkMultiSite);
        procid.append("checkFactors", "New Product / 1st Implementation" + ";" + checkNewProduct);
        procid.append("checkFactors", "New Customer" + ";" + checkNewCustomer);
        procid.append("checkFactors", "New Subcon / Vendor" + ";" + checkNewSubcon);
        procid.append("checkFactors", "Stringent Requirement" + ";" + checkStringentReq);
        procid.append("checkFactors", "Multi Subcon / Vendor" + ";" + checkMultiSubcon);
        procid.append("checkFactors", "Multi Platform" + ";" + checkMultiPlatform);
        procid.append("checkFactors", "Lack of Resource Capacity" + ";" + checkResourceCapacity);
        procid.append("checkFactors", "TOP does not Comply to MLPT Policy" + ";" + checkTOP);
        procid.append("checkFactors", "GP Projection Less than Target" + ";" + checkGPProjection);
        procid.append("checkFactors", "Harsh Penalty" + ";" + checkHarshPenalty);
        procid.append("checkFactors", "Tight Timeline" + ";" + checkTightTimeline);
        procid.append("checkFactors", "Non IT Scope of Work" + ";" + checkNonITSOW);
        procid.append("checkFactors", "Customer Behavior (Highly Political/Baby Sitting)" + ";" + checkCustomerBehavior);
        procid.append("checkFactors", "Application Implementation Project" + ";" + checkAppImplementation);
        procid.append("checkFactors", "Unclear Scope" + ";" + checkUnclearScope);
        procid.append("checkFactors", "Lack of Resource Capability" + ";" + checkResourceCapability);
        procid.append("checkFactors", "Payment 100% After Project Completion" + ";" + checkPayment100);

        selSubcon = jQuery(".txtPercent");
        selSubcon.each(function () {
            var subcon = jQuery(this).parent().parent().find(".selectSubconName").val();
            var subconname = jQuery(this).parent().parent().find(".txtSubconName").val();
            var percent = jQuery(this).val();
            var highlvl = jQuery(this).parent().parent().find(".txtHighLvlScope").val();
            var preload = jQuery(this).parent().parent().find(".txtPreload").val();

            if(percent != null && percent != ""){
                procid.append("selectSubconName", subcon);
                procid.append("txtSubconName", subconname);
                procid.append("txtPercent", percent);
                procid.append("txtHighLvlScope", highlvl);
                procid.append("txtPreload", preload);
            }
            
        })

        $.ajax({
            url: "/PreProcs/PostRiskFactorAssess/",
            type: "POST",
            dataType: "json",
            data: procid,
            contentType: false,
            processData: false,
            success: function (data) {
                // window.location.reload();
                // $("#btnSaveHeaderPreProc").click();
            },
            error: function (data) { //sukses tapi selalu error
                // $("#btnSaveHeaderPreProc").click();
            }
        })
    }

    $("#btnsubmitassess").on("click", function (){
        $("#btnSaveHeaderPreProc").click();
    })

    async function valid(){
        var idStage = $('#selectStage').val();
        if(idStage == "RiskAssessment"){
           await riskAssess();
        }
        else if(idStage == "Presales"){
            await saveItem();
            if($("#txtCustomerPIC").val() != null && $("#txtCustomerPIC").val() != "" && $("#txtCustomerPIC").val() != undefined){
               await submitPMO();
            }
        }
        else {
            if($("#txtCustomerPIC").val() != null && $("#txtCustomerPIC").val() != "" && $("#txtCustomerPIC").val() != undefined){
               await submitPMO();
            }
        }
        
    }

    $("#postEditItem").on("submit", function( event ) {
        var idStage = $('#selectStage').val();

        var flag = 0;
        var stage = $('#selectStage').val();
        var filespk = document.querySelector("#postedfilespk");
        var filerfp = $("div#divInputFileRFP").html().trim();
        var filequot = $("div#divInputFileQuot").html().trim();
        var fileproposal = $("div#divInputFilePropo").html().trim();
        var fileboq = $("div#divInputFileBOQ").html().trim();
        var filenego = document.querySelector("#postedfilenego");
        var fileother = $("div#divInputFileOthers").html().trim();
        var stage = $('#resultSelectedBODEmail').val();
        var quotdeadline = $("input#QuotationDeadline").val()
        var submissiondate = $("input#ProposalSubmissionDate").val()
        var am = $("select#Am").val()
        var presalesid = $("select#PresalesId").val()
        var ta = $("select#TenderAdm").val()
        var gp = $("input#txtGP").val()
        
        stage = stage.split(";");
        

        if(idStage == "Delivery"){
            if ($("#ProposalId").val() == "" && $("#QuotationId").val() == "")
            {
                alert( "Proposal No atau Quotation No tidak boleh kosong" );
                flag = 1;
            }
            else if ($("#Customer").val() == ""){
                alert( "Customer harus dipilih" );
                flag = 1;
            }
            else if ($("#PropMgr").val() == ""){
                alert( "Technical Lead atau Presales harus dipilih" );
                flag = 1;
            }
            else if ($("#Pid").val() == ""){
                alert( "PID harus dipilih" );
                flag = 1;
            }
            else if ($("#txtProjectValIdr").val() == "" && $("#txtProjectValUsd").val() == "")
            {
                alert( "Project Value tidak boleh kosong" );
                flag = 1;
            }
            else if ($("#resultSelectedPICProcEmail").val() == ""){
                alert( "PIC Procurement tidak boleh kosong" );
                flag = 1;
            }
            else if ($("#RfpId").val() != "" && filerfp == ""){
                alert( "Attachment RFP tidak boleh kosong" );
                flag = 1;
            }
            else if ($("#ProposalId").val() != "" && fileproposal == ""){
                alert( "Attachment Proposal tidak boleh kosong" );
                flag = 1;
            }
            else if ($("#QuotationId").val() != "" && filequot == ""){
                alert( "Attachment Quotation tidak boleh kosong" );
                flag = 1;
            }
            else if ($("#CheckEsc").prop("checked") == true && $("#resultSelectedPICReasonDomain").val() == ""){
                alert( "PIC Pending Billing Reason tidak boleh kosong" );
                flag = 1;
            }
            else if ($("select#ProjectType").val() == "" && ($("#currentEmailPSMgr").val() != null && $("#currentEmailPSMgr").val() != "")){
                alert( "Project Support tidak boleh kosong" );
                flag = 1;
            }
        }
        else if(idStage == "Presales"){
            if ($("#ProposalId").val() == "" && $("#QuotationId").val() == "")
            {
                alert( "Proposal No atau Quotation No tidak boleh kosong" );
                flag = 1;
            }
            else if ($("#Customer").val() == ""){
                alert( "Customer harus dipilih" );
                flag = 1;
            }
            else if ($("#PropMgr").val() == ""){
                alert( "Technical Lead atau Presales harus dipilih" );
                flag = 1;
            }
            else if ($("#txtProjectValIdr").val() == "" && $("#txtProjectValUsd").val() == "")
            {
                alert( "Project Value tidak boleh kosong" );
                flag = 1;
            }
            else if ($("#resultSelectedPICProcEmail").val() == ""){
                alert( "PIC Procurement tidak boleh kosong" );
                flag = 1;
            }
            else if ($("#RfpId").val() != "" && filerfp == ""){
                alert( "Attachment RFP tidak boleh kosong" );
                flag = 1;
            }
            else if ($("#ProposalId").val() != "" && fileproposal == ""){
                alert( "Attachment Proposal tidak boleh kosong" );
                flag = 1;
            }
            else if ($("#QuotationId").val() != "" && filequot == ""){
                alert( "Attachment Quotation tidak boleh kosong" );
                flag = 1;
            }
            else if (quotdeadline < submissiondate){
                alert("Proposal Submission Date must be less than Subcon Quotation Deadline")
                flag = 1;
            }
            else if (am == ""){
                alert("Account Manager tidak boleh kosong")
                flag = 1;
            }
            else if (presalesid == ""){
                alert("Opty / Presales ID tidak boleh kosong")
                flag = 1;
            }
            else if (ta == ""){
                alert("Tender Admin tidak boleh kosong")
                flag = 1;
            }
            else if (gp == ""){
                alert("Est GP tidak boleh kosong")
                flag = 1;
            }
        }

        if(flag == 1){
            event.preventDefault();
        }
        else{
            event.preventDefault();
            valid().then(() => this.submit());

            $("#modalLoadingElement").show()
            $("#modalLoadingElement").addClass("show")
            modalBackdrop.style.display = "block";
        }
    })

    function saveItem(){
        var procid = new FormData();
        var tempprocid = document.querySelector("#preprocid").getAttribute("value");

        procid.append("procid", tempprocid);

        $("td.tdNo").each(function () {
            var no = $(this).html().trim();
            var principal = $(this).parent().find("select.txtPrincipal option:selected").val();
            if(principal == undefined){
                principal = $(this).parent().find("td.tdPrincipal").html().trim();
            }

            var detail = $(this).parent().find("input.txtDetailId").val().trim();
            var nkpcode = $(this).parent().find("input.txtNKPCode").val().trim();

            var itemdesc = $(this).parent().find("select.txtItemDesc option:selected").val();

            if(itemdesc == undefined){
                itemdesc = $(this).parent().find("td.tdItemDesc").html().trim();
            }

            var insurance = $(this).parent().find("td.tdInsurance").html().trim();
            var warranty = $(this).parent().find("td.tdWarranty").html().trim();
            var specrks = $(this).parent().find("td.tdSpecRKS").html().trim();
            // var surduk = $(this).parent().find("input.txtSurDuk").val();
            var surduk = $(this).parent().find("td.tdSurDuk").html().trim();
            var qty = $(this).parent().find("td.tdQty").html().trim();
            var curr = $(this).parent().find("td.tdCurrency").html().trim();
            var unitcogs = $(this).parent().find("td.tdUnitCOGS").html().trim();
            var unitrev = $(this).parent().find("td.tdUnitRevenue").html().trim();
            var totcogs = $(this).parent().find("td.tdTotalCOGS").html().trim();
            var totrev = $(this).parent().find("td.tdTotalRevenue").html().trim();
            var risk = $(this).parent().find("td.tdRisk").html().trim();
            var presalesreview = $(this).parent().find("td.tdPresalesReview").html().trim();
            var amreview = $(this).parent().find("td.tdAMReview").html().trim();
            var presalescomment = $(this).parent().find("input.txtCommentPresalesHidden").val();
            var amcomment = $(this).parent().find("input.txtCommentAMHidden").val();
            var specrks = $(this).parent().find("input.txtIDAttachSpec").val();
            var surdukatt = $(this).parent().find("input.txtIDAttachSurduk").val();
            var vendorquot = $(this).parent().find("input.txtIDAttachVendorQuot").val();
            var remark = $(this).parent().next().find("td.tdRemark").html();
            var vendor = $(this).parent().find("td.tdVendor").html();
            
            var existingspecrks = "";
            $(this).parent().find("a.btn-down-spec").each(function (){
                existingspecrks += $(this).attr("id") + ";";
            })
            var existingsurduk = "";
            $(this).parent().find("a.btn-down-surduk").each(function (){
                existingsurduk += $(this).attr("id") + ";";
            })
            var existingvendorquot = "";
            $(this).parent().find("a.btn-down-vendorquot").each(function (){
                existingvendorquot += $(this).attr("id") + ";";
            })

            procid.append("no", no);
            procid.append("principal", principal);
            procid.append("detailid", detail);
            procid.append("nkpcode", nkpcode);
            procid.append("itemdesc", itemdesc);
            procid.append("insurance", insurance);
            procid.append("warranty", warranty);
            procid.append("specrks", specrks);
            procid.append("surduk", surduk);
            procid.append("surdukatt", surdukatt);
            procid.append("qty", qty);
            procid.append("curr", curr);
            procid.append("unitcogs", unitcogs);
            procid.append("unitrev", unitrev);
            procid.append("totcogs", totcogs);
            procid.append("totrev", totrev);
            procid.append("risk", risk);
            procid.append("presalesreview", presalesreview);
            procid.append("amreview", amreview);
            procid.append("presalescomment", presalescomment);
            procid.append("amcomment", amcomment);
            procid.append("existingspecrks", existingspecrks);
            procid.append("existingsurduk", existingsurduk);
            procid.append("existingvendorquot", existingvendorquot);
            procid.append("vendorquot", vendorquot);
            procid.append("vendor", vendor);
            procid.append("remark", remark);
            
            // < td scope = "col" class="tdVendor visibleVendor completeView" > </td>
            // < td scope = "col" class="tdVendorQuot visibleVendorQuot completeView text-center" > </td>
        })

        $.ajax({
            url: "/PreProcs/PostSaveItemDetail/",
            type: "POST",
            dataType: "json",
            data: procid,
            contentType: false,
            processData: false,
            success: function (data) {
                // alert("presales")
            },
            error: function (data) {
                // alert(data)
            }
        })


    }

    function reviewRisk() {
        var procid = new FormData();
        var temppreprocid = document.querySelector("#preprocid").getAttribute("value");
        var txtRiskDesc = $("#txtReviewRisk").val();

        procid.append("procid", temppreprocid);
        procid.append("reviewrisk", txtRiskDesc);

        $.ajax({
            url: "/PreProcs/PostReviewRiskFactor/",
            type: "POST",
            dataType: "json",
            data: procid,
            contentType: false,
            processData: false,
            success: function (data) {
                $("#modalLoadingElement").show()
                $("#modalLoadingElement").addClass("show")
                modalBackdrop.style.display = "block";
                window.location.reload();
            },
            error: function (data) {
                console.log("error" + data[0]);
            }
        })
    }

    function approveRisk() {
        var procid = new FormData();
        var temppreprocid = document.querySelector("#preprocid").getAttribute("value");
        var txtCommentApproveRisk = $("#txtCommentApproveRisk").val();

        procid.append("procid", temppreprocid);
        procid.append("commentapproval", txtCommentApproveRisk);
        procid.append("status", "Approved");

        $.ajax({
            url: "/PreProcs/PostApprovalRiskAssessment/",
            type: "POST",
            dataType: "json",
            data: procid,
            contentType: false,
            processData: false,
            success: function (data) {
                $("#modalLoadingElement").show()
                $("#modalLoadingElement").addClass("show")
                modalBackdrop.style.display = "block";
                window.location.reload();
            },
            error: function (data) {
                console.log("error" + data[0]);
            }
        })
    }

    function rejectRisk() {
        var procid = new FormData();
        var temppreprocid = document.querySelector("#preprocid").getAttribute("value");
        var txtCommentRejectRisk = $("#txtCommentRejectRisk").val();

        procid.append("procid", temppreprocid);
        procid.append("commentapproval", txtCommentRejectRisk);
        procid.append("status", "Rejected");

        $.ajax({
            url: "/PreProcs/PostApprovalRiskAssessment/",
            type: "POST",
            dataType: "json",
            data: procid,
            contentType: false,
            processData: false,
            success: function (data) {
                $("#modalLoadingElement").show()
                $("#modalLoadingElement").addClass("show")
                modalBackdrop.style.display = "block";
                window.location.reload();
            },
            error: function (data) {
                console.log("error" + data[0]);
            }
        })
    }

    function assignRiskCommittee() {
        var procid = new FormData();
        var temppreprocid = document.querySelector("#preprocid").getAttribute("value");
        var resultSelectedCommitteeDomain = $("#resultSelectedCommitteeDomain").val();

        procid.append("procid", temppreprocid);
        procid.append("resultSelectedCommitteeDomain", resultSelectedCommitteeDomain);

        $.ajax({
            url: "/PreProcs/PostAssignRiskCommittee/",
            type: "POST",
            dataType: "json",
            data: procid,
            contentType: false,
            processData: false,
            success: function (data) {
                $("#modalLoadingElement").show()
                $("#modalLoadingElement").addClass("show")
                modalBackdrop.style.display = "block";
                window.location.reload();
            },
            error: function (data) {
                console.log("error" + data[0]);
            }
        })
    }

    function showPMOChecklist(){
        alert("Tab PMO CheckList has been Added");
        $("li#pmo-tab").css('display', 'block');
        $("#btn-pmo-review").hide();
    }

    function changeViewDetails(){
        var val = $("select#selectViewDetails option:selected").val();

        $(".completeView").show();

        if(val == "Simple"){
            $(".completeView").hide();
            $(".visibleItemDesc").show();
            $(".visibleQty").show();
            $(".visiblePM").show();
            $(".visibleVendor").show();
            $(".visibleVendorQuot").show();
            $(".visiblePOData").show();
            $(".visibleUnitCOGS").show();
            $(".visibleUnitRevenue").show();
            $(".visibleTotalCOGS").show();
            $(".visibleTotalRevenue").show();
        }
        else if(val == "PO"){
            $(".completeView").hide();
            $(".visibleItemDesc").show();
            $(".visibleQty").show();
            $(".visiblePOData").show();
            $(".visibleUnitCOGS").show();
            $(".visibleUnitRevenue").show();
            $(".visibleTotalCOGS").show();
            $(".visibleTotalRevenue").show();
        }
    }

    function valueOnCheckSubmit() {
        selPIC = jQuery(".checkPIC");
        var tempPIC = "";
        selPIC.each(function () {
            if (jQuery(this).prop("checked") == true) {
                tempPIC += jQuery(this).val() + "; ";
            }
        })
        $("#resultSelectedPIC").val(tempPIC);
    }

    function valueOnCheckSubmitCommittee() {
        selPIC = jQuery(".checkCommittee");
        var tempPIC = "";
        var tempPICDomain = "";
        selPIC.each(function () {
            if (jQuery(this).prop("checked") == true) {
                var tempsplit = jQuery(this).val().split(";"); 
                tempPIC += tempsplit[1] + "; ";
                tempPICDomain += tempsplit[0] + ";";
            }
        })
        $("#editresultSelectedCommittee").val(tempPIC);
        $("#resultSelectedCommitteeDomain").val(tempPICDomain);
    }

    function valueOnCheckSubmitPICReason() {
        selPIC = jQuery(".checkPICReason");
        var tempPIC = "";
        var tempPICDomain = "";
        selPIC.each(function () {
            if (jQuery(this).prop("checked") == true) {
                var tempsplit = jQuery(this).val().split(";"); 
                tempPIC += tempsplit[1] + "; ";
                tempPICDomain += tempsplit[0] + ";";
            }
        })
        $("#editresultSelectedPICReason").val(tempPIC);
        $("#resultSelectedPICReasonDomain").val(tempPICDomain);
    }

    $('#divCheckNonITSOW').on('click', 'input#checkNonITSOW', function () {
        if($(this).prop("checked") == true){
            const select = document.querySelector('select#selectOverallRisk');
            select.value = 'HIGH'
        }
       
    });

    $('#divCheckAppImplementation').on('click', 'input#checkAppImplementation', function () {
        if($(this).prop("checked") == true){
            const select = document.querySelector('select#selectOverallRisk');
            select.value = 'HIGH'
        }
      
    });
    $('#divCheckTightTimeline').on('click', 'input#checkTightTimeline', function () {
        if($(this).prop("checked") == true){
            const select = document.querySelector('select#selectOverallRisk');
            select.value = 'HIGH'
        }
          
    });

    $('#divCheckPayment100').on('click', 'input#checkPayment100', function () {
        if($(this).prop("checked") == true){
            const select = document.querySelector('select#selectOverallRisk');
            select.value = 'HIGH'
        }
    });
    $('#divCheckMultiSubcon').on('click', 'input#checkMultiSubcon', function () {
        if($(this).prop("checked") == true){
            if($("input#checkNewSubcon").prop("checked") == true){
                const select = document.querySelector('select#selectOverallRisk');
                select.value = 'HIGH'
            }
            if($("input#checkNewProduct").prop("checked") == true){
                const select = document.querySelector('select#selectOverallRisk');
                select.value = 'HIGH'
            }
        }
    });
    $('#divCheckNewSubcon').on('click', 'input#checkNewSubcon', function () {
        if($(this).prop("checked") == true){
            if($("input#checkMultiSubcon").prop("checked") == true){
                const select = document.querySelector('select#selectOverallRisk');
                select.value = 'HIGH'
            }
        }
    });
    $('#divCheckNewProduct').on('click', 'input#checkNewProduct', function () {
        if($(this).prop("checked") == true){
            if($("input#checkMultiSubcon").prop("checked") == true){
                const select = document.querySelector('select#selectOverallRisk');
                select.value = 'HIGH'
            }
        }
    });

    $('#selectContingency').on('change', function () {
        if($(this).val() == "True"){
            $("#visibleContingency").attr('hidden', false);
        }
        else{
            $("#visibleContingency").attr('hidden', true);
        }
    });

    

    $('#txtRevMLPT').on('change', function () {
        var replacecommaval = $(this).val().replace(".", ",");

        if($(this).val() == "100" || $(this).val() == "100,00"){
            $("#visibleTableRevSharingSubCon").attr('hidden', true);
        }
    });

    $('#txtTotSubCon').on('change', function () {
        var emptyNewRowRevSharing = "<tr class='trRowRevSharing'>";
        emptyNewRowRevSharing += $("#emptyRowRevSharing").html();
        emptyNewRowRevSharing += "</tr>";

        if($(this).val() > 0){
            $("#visibleTableRevSharingSubCon").attr('hidden', false);
            var count = 0;
            $('tr.trRowRevSharing').each(function () {
               count++;
           });
           var tempCount = $(this).val() - count;
           if($(this).val() > count){
               for(var i=0;i<tempCount;i++){
                  $("#bodyRevSharingSubCon").append(emptyNewRowRevSharing);
               }
           }
           else if($(this).val() < count){
               tempCount = count - $(this).val();
               for(var i=0;i<tempCount;i++){
                  $("tr.trRowRevSharing").last().remove();
               }
              
           }
        }
        else{
            $("#visibleTableRevSharingSubCon").attr('hidden', true);
            var count = 0;
            $('tr.trRowRevSharing').each(function () {
               count++;
           });

            if($(this).val() == 0 && count > 0){
               var tempCount = count - $(this).val();
               for(var i=0;i<tempCount;i++){
                  $("tr.trRowRevSharing").last().remove();
               }
            }
        }
    });

    $('#tableRevSharing').on('change', 'select.txtSubconName', function () {
        if($(this).val() == "Others"){
            // $(this).find("div.divTxtOtherSubconName").attr('hidden', false);
            $(this).parent().find("div.divTxtOtherSubconName").attr('hidden', false);
        }
        else{
            $(this).parent().find("div.divTxtOtherSubconName").attr('hidden', true);
        }
    });

    function overwriteItemDetail() {
        var preprocid = new FormData();
        var temppreprocid = document.querySelector("#preprocid").getAttribute("value");
        var txtRiskDesc = $("#txtReviewRisk").val();
        
        $('input:checkbox.singleCheckItem').each(function () {
            if(this.checked == true){
                preprocid.append("preprocid", temppreprocid);
                preprocid.append("pid", $(this).parent().parent().find("td.tdCSPID").html());
                preprocid.append("qty", $(this).parent().parent().find("td.tdCSQty").html());
                preprocid.append("nkpcode", $(this).parent().parent().find("td.txtCSNKPCode").html());
                preprocid.append("itemdesc", $(this).parent().parent().find("td.tdCSDesc").html());
                preprocid.append("sub", $(this).parent().parent().find("input.txtCSSub").prop("checked"));
                preprocid.append("headerno", $(this).parent().parent().find("input.txtCSHeaderNo").val());
                preprocid.append("curr", $(this).parent().parent().find("td.tdCSCurr").html());
                preprocid.append("unitcogs", $(this).parent().parent().find("td.tdCSCOGS").html());
                preprocid.append("unitrevenue", $(this).parent().parent().find("td.tdCSRevenue").html());
                preprocid.append("totcogs", $(this).parent().parent().find("td.tdCSTotCOGS").html());
                preprocid.append("totrevenue", $(this).parent().parent().find("td.tdCSTotRev").html());
                preprocid.append("pidfull", $(this).parent().parent().find("td.tdCSPIDFull").html());
                console.log($(this).parent().parent().find("td.txtCSNKPCode").html())
            }
        });

        var procid = new FormData();
        procid.append("procid", temppreprocid);

        $.ajax({
            url: "/PreProcs/CheckExistingItemDetailToOverwrite/",
            type: "POST",
            dataType: "json",
            data: procid,
            contentType: false,
            processData: false,
            success: function (data) {
                if(data != null){
                    alert("Process Failed. Item Details Existed.")
                }
                else{
                    $.ajax({
                        url: "/PreProcs/PostOverwriteOrAppendItem/",
                        type: "POST",
                        dataType: "json",
                        data: preprocid,
                        contentType: false,
                        processData: false,
                        success: function (data) {
                            $("#modalLoadingElement").show()
                            $("#modalLoadingElement").addClass("show")
                            modalBackdrop.style.display = "block";
                            window.location.reload();
                        },
                        error: function (data) {
                            console.log("error" + data[0]);
                        }
                    })
                }
            },
            error: function (data) {
                console.log("error" + data[0]);
            }
        })
    }

    function appendItemDetail() {
        var preprocid = new FormData();
        var temppreprocid = document.querySelector("#preprocid").getAttribute("value");
        var txtRiskDesc = $("#txtReviewRisk").val();
        
        $('input:checkbox.singleCheckItem').each(function () {
            if(this.checked == true){
                preprocid.append("preprocid", temppreprocid);
                preprocid.append("pid", $(this).parent().parent().find("td.tdCSPID").html());
                preprocid.append("qty", $(this).parent().parent().find("td.tdCSQty").html());
                preprocid.append("nkpcode", $(this).parent().parent().find("td.txtCSNKPCode").html());
                preprocid.append("itemdesc", $(this).parent().parent().find("td.tdCSDesc").html());
                preprocid.append("sub", $(this).parent().parent().find("input.txtCSSub").prop("checked"));
                preprocid.append("headerno", $(this).parent().parent().find("input.txtCSHeaderNo").val());
                preprocid.append("curr", $(this).parent().parent().find("td.tdCSCurr").html());
                preprocid.append("unitcogs", $(this).parent().parent().find("td.tdCSCOGS").html());
                preprocid.append("unitrevenue", $(this).parent().parent().find("td.tdCSRevenue").html());
                preprocid.append("totcogs", $(this).parent().parent().find("td.tdCSTotCOGS").html());
                preprocid.append("totrevenue", $(this).parent().parent().find("td.tdCSTotRev").html());
                preprocid.append("pidfull", $(this).parent().parent().find("td.tdCSPIDFull").html());
            }
        });

        var procid = new FormData();
        procid.append("procid", temppreprocid);

        $.ajax({
            url: "/PreProcs/PostOverwriteOrAppendItem/",
            type: "POST",
            dataType: "json",
            data: preprocid,
            contentType: false,
            processData: false,
            success: function (data) {
                $("#modalLoadingElement").show()
                $("#modalLoadingElement").addClass("show")
                modalBackdrop.style.display = "block";
                window.location.reload();
            },
            error: function (data) {
                console.log("error" + data[0]);
            }
        })
    }

    $('#btn-add-po').on('click', function () {
        var pid = new FormData();
        // var procid = document.querySelector("#preprocid").getAttribute("value");
        var pidtemp = "";
        $("#bodyAddCS").html("");
        $("div.loading").show();

        $('input:checkbox.checkItem').each(function () {
            if(this.checked == true){
                const temppid = $(this).parent().parent().find("td.tdPID").html().trim();
                pidtemp += temppid + ";";
                $("label#labelPIDModal").html("PID : <b class='text-red'>" + temppid + "</b>");
                const no = $(this).parent().parent().find("td.tdNo").html();
                const itemdesc = $(this).parent().parent().find("select.txtItemDesc option:selected").text() + ";" + $(this).parent().parent().find("textarea.txtRemark ").val();
                const qty = $(this).parent().parent().find("td.tdQty").html();
                $("#bodyAddCS").append("<tr><td>" + no + "</td><td>" + itemdesc + "</td><td class='text-center'>" + qty + "</td></tr>");
            }
        });
        pid.append("pid", pidtemp)

        $.ajax({
            url: "/PreProcs/GetItemPOOracle/",
            type: "POST",
            dataType: "json",
            data: pid,
            contentType: false,
            processData: false,
            success: async function (data) {
                $("#bodyAddPO").html("");
                if(data.length > 0){
                    for(var i =0; i< data.length; i++){
                        // $("#bodyAddPO").append("<tr style='background: lightblue;'><td><input class='form-control txtNoItemCS' type='text' style='width:100px' value=''></td><td>" + data[i].noPo + "</td><td>" + data[i].description + "</td><td class='text-center'>" + data[i].itemNo + "</td><td>" + data[i].quantity + " " + data[i].uom + "</td><td>" + data[i].currencyCode + "</td><td class='text-center'>" + data[i].unitPrice + "</td><td class='tdPIDNum'><input class='form-control txtPIDNum' type='hidden' style='width:100px' value='" + data[i].pidnum + "'></td</tr>")
                        let tempexistpo
                        let tempcount = i

                        await CheckExistingPOData(data[i].pidnum, function (podata){
                            tempexistpo = podata
                            if(tempexistpo.length > 0){
                                for(var i =0; i < tempexistpo.length;i++){
                                    if(tempexistpo[i].polineId == data[tempcount].pidnum){
                                        $("#bodyAddPO").append("<tr style='background-color: cyan;'><td><input class='form-control txtNoItemCS' type='text' style='width:100px' value=''></td><td>" + data[tempcount].noPo + "</td><td>" + data[tempcount].description + "</td><td class='text-center'>" + data[tempcount].itemNo + "</td><td>" + data[tempcount].quantity + " " + data[tempcount].uom + "</td><td>" + data[tempcount].currencyCode + "</td><td class='text-center'>" + data[tempcount].unitPrice + "</td><td class='tdPIDNum'><input class='form-control txtPIDNum' type='hidden' style='width:100px' value='" + data[tempcount].pidnum + "'></td</tr>")
                                        
                                    }
                                    else{
                                        $("#bodyAddPO").append("<tr ><td><input class='form-control txtNoItemCS' type='text' style='width:100px' value=''></td><td>" + data[tempcount].noPo + "</td><td>" + data[tempcount].description + "</td><td class='text-center'>" + data[tempcount].itemNo + "</td><td>" + data[tempcount].quantity + " " + data[tempcount].uom + "</td><td>" + data[tempcount].currencyCode + "</td><td class='text-center'>" + data[tempcount].unitPrice + "</td><td class='tdPIDNum'><input class='form-control txtPIDNum' type='hidden' style='width:100px' value='" + data[tempcount].pidnum + "'></td</tr>")
                                    }
                                }
                            }
                            else{
                                $("#bodyAddPO").append("<tr ><td><input class='form-control txtNoItemCS' type='text' style='width:100px' value=''></td><td>" + data[tempcount].noPo + "</td><td>" + data[tempcount].description + "</td><td class='text-center'>" + data[tempcount].itemNo + "</td><td>" + data[tempcount].quantity + " " + data[tempcount].uom + "</td><td>" + data[tempcount].currencyCode + "</td><td class='text-center'>" + data[tempcount].unitPrice + "</td><td class='tdPIDNum'><input class='form-control txtPIDNum' type='hidden' style='width:100px' value='" + data[tempcount].pidnum + "'></td</tr>")
                            }
                        }.bind(this));
                    }
                }
            },
            complete: function (){
                $("div.loading").hide();
            },
            error: function (data) {
                console.log("error" + data[0]);
            }
        })
    })

    function addPOData() {
        var tempprocid = document.querySelector("#preprocid").getAttribute("value");

        var procid = new FormData();

        $('input.txtNoItemCS').each(function () {
            if($(this).val() != null && $(this).val() != ""){
                procid.append("procid", tempprocid);
                procid.append("noitemcs", $(this).val());
                procid.append("pidnum", $(this).parent().parent().find("input:hidden.txtPIDNum").val());
            }
        });

        $.ajax({
            url: "/PreProcs/PostAddPOData/",
            type: "POST",
            dataType: "json",
            data: procid,
            contentType: false,
            processData: false,
            success: function (data) {
                $("#modalLoadingElement").show()
                $("#modalLoadingElement").addClass("show")
                modalBackdrop.style.display = "block";
                window.location.reload();
            },
            error: function (data) {
                console.log("error" + data[0]);
            }
        })
    }

    $('#btn-update-po').on('click', function () {
        var pid = new FormData();
        var tempprocid = document.querySelector("#preprocid").getAttribute("value");

        $("#bodyUpdatePO").html("");
        $('input:checkbox.checkItem').each(function () {
            if(this.checked == true){
                const pid = $(this).parent().parent().find("td.tdPID").html().trim();
                const no = $(this).parent().parent().find("td.tdNo").html().trim();
                const itemdesc = $(this).parent().parent().find("select.txtItemDesc option:selected").text(); 
                const remark = $(this).parent().parent().find("textarea.txtRemark ").val();
                const detailid = $(this).parent().parent().find("input:hidden.txtDetailId").val();
                const qty = $(this).parent().parent().find("td.tdQty").html().trim();

                $("#bodyUpdatePO").append("<tr><td class='tdCheckNo'>" + no + "</td><td>" + pid + "</td><td style='min-width:315px'>" + itemdesc + "<br><b class='text-red'>" + remark + "</b</td><td class='text-center'>" + qty + "</td><td><div class='table-wrapper table-responsive-lg' style='width:1265px;min-height:50px'>   <table class='table tblUpdatePO table-borderless' style='font-size:small;vertical-align:middle'><thead><tr><th scope='col' style='background:transparent;color:black'><b>Exp PO Issued Dt</b></th><th scope='col' style='background:transparent;color:black'><b>ETD</b></th><th scope='col' style='background:transparent;color:black'><b>PO Number</b></th><th scope='col' style='background:transparent;color:black'><b>PO Item</b></th><th scope='col' style='background:transparent;color:black'><b>NKS</b></th><th scope='col' style='background:transparent;color:black'><b>PO Date</b></th><th scope='col' style='background:transparent;color:black'><b>PO Qty</b></th><th scope='col' style='background:transparent;color:black'><b>ETA</b></th><th scope='col' style='background:transparent;color:black'><b>Vendor</b></th><th scope='col' style='background:transparent;color:black'><b>GR Date</b></th><th scope='col' style='background:transparent;color:black'><b>GR Qty</b></th></tr></thead><tbody class='bodyDetailPO' id='bodyDetailPO" + no + "'></tbody></table></div></td><td class='tdFileMLPTPO'><a class='btn btn-outline-secondary mt-lg-2 AttachMLPTPO' style='font-size: 12px;display:none;width:75px; padding: 3px!important;' data-bs-toggle='modal' data-bs-target='#uploadMLPTPO'>Attach File</a></td><td class='tdFileGRN text-center'></td></tr>");

                GetItemPreProcPO(no, "Update PO");
                

                
            };
        });

        $('input:checkbox.checkItem').each(function () {
            if(this.checked == true){
                const no = $(this).parent().parent().find("td.tdNo").html().trim();

                GetItemPreProcPO(no, "Update PO");
            };
        });

        // pid.append("pid", pidtemp)

    })

    $('#btn-browse-po').on('click', function () {
        var procid = new FormData();
        var tempprocid = document.querySelector("#preprocid").getAttribute("value");

        $("#bodyBrowsePO").html("");
        procid.append("procid", tempprocid);

        $.ajax({
            url: "/PreProcs/GetItemPreProcPOforBrowse/",
            type: "POST",
            dataType: "json",
            data: procid,
            contentType: false,
            processData: false,
            success: function (data) {
                if (data.length > 0) {
                    for (var i = 0; i < data.length; i++) {
                        var pid = data[i].polineId.split("-");
                        $("#bodyBrowsePO").append("<tr><td class=''><input class='form-check-input' type='radio' name='radioBrowsePO'></td><td>" + pid[0] + "</td><td class='text-center' style='width:95px'>" + data[i].poid + "</td><td style='min-width:315px'>" + data[i].itemDescription + "</td><td class='text-center' style='width:80px'>" + convertDateFormat(data[i].podate, "dd MMM yy") + "</td></tr>");
                    }
                }
            },
            error: function (data) {
                console.log("error" + data[0]);
            }
        });
    })

    function GetItemPreProcPO(no, type){
        var procid = new FormData();
        var tempprocid = document.querySelector("#preprocid").getAttribute("value");
        procid.append("procid", tempprocid);
        procid.append("idnew", no);

        $("button#submit-update-po").css("display", "none");
        $("div.visGroup1").css("display", "none");
        $("div.visGroup2").css("display", "none");
        $("div.visbileInputType").css("display", "none");
        $("button#btn-select-item").css("display", "block");

        $.ajax({
            url: "/PreProcs/GetItemPreProcPO/",
            type: "POST",
            dataType: "json",
            data: procid,
            contentType: false,
            processData: false,
            success: function (data) {
                $("#bodyDetailPO"+ no).html("");
                if (data.length > 0) {
                    for (var i = 0; i < data.length; i++) {
                        var expectedPoissuedDate = data[i].expectedPoissuedDate != null ? convertDateFormat(data[i].expectedPoissuedDate, "dd MMM yy") : "";
                        var etd = data[i].etd != null ? convertDateFormat(data[i].etd, "dd MMM yy") : "";
                        var podate = data[i].podate != null ? convertDateFormat(data[i].podate, "dd MMM yy") : "";
                        var eta = data[i].eta != null ? convertDateFormat(data[i].eta, "dd MMM yy") : "";
                        var grdate = data[i].grdate != null ? convertDateFormat(data[i].grdate, "dd MMM yy") : "";
                        var poqty = data[i].poqty != null ? data[i].poqty : "";
                        var grqty = data[i].grqty != null ? data[i].grqty : "";
                        var uom = data[i].uom != null ? data[i].uom : "";
                        uom = poqty != "" ? uom : "";
                        var vendorName = data[i].vendorName != null ? data[i].vendorName : "";
                        var grbacklog = data[i].grbacklog != null ? data[i].grbacklog : "";

                        $("#bodyDetailPO" + no).last().append("<tr><td class='tdPID text-center' style='background:transparent;width:90px'>" + expectedPoissuedDate + "</td><td class='tdQty text-center' style='background:transparent;width:90px'>" + etd + "</td><td scope='col' class='tdCurrency text-center' style='background:transparent;width:80px'><div class='custom-control custom-checkbox'><input type='checkbox' class='form-check-input checkbox checkPONo'style='border: 1px solid;font-size:small' name='checkPONo' id='checkPONo' value='" + data[i].polineId + ";" + data[i].idnew + "'><label class='custom-control-label' for='customCheck1'>&nbsp" + data[i].poid + "</label></div></td><td scope='col' class='tdUnitCOGS' style='background:transparent;;width:300px'>" + data[i].itemDescription + "</td><td scope='col' class='tdUnitRevenue' style='background:transparent;width:90px'>" + data[i].itemNo + "</td><td scope='col' class='tdTotalCOGS text-center' style='background:transparent;width:90px'>" + podate + "</td><td scope='col' class='tdTotalRevenue text-center' style='background:transparent;width:65px'>" + poqty + " " + uom + "</td><td scope='col' class='tdPM text-center' style='background:transparent;width:90px'>" + eta + "</td><td scope='col' class='tdVendor' style='background:transparent'>" + vendorName + "</td><td scope='col' class='tdGRDate text-center' style='background:transparent;width:90px'>" + grdate + "</td><td scope='col' class='tdGRQty' style='background:transparent;width:65px'>" + grqty + "</td><td scope='col' class='tdGRBackLog' style='background:transparent'>" + grbacklog + "</td><input class='txtCheckIDNew' type='hidden' value'" + data[i].idnew + "'/></tr>")
                    };

                };

                $("#bodyDetailGR"+ no).html("");
                if (data.length > 0) {
                    for (var i = 0; i < data.length; i++) {
                        var expectedPoissuedDate = data[i].expectedPoissuedDate != null ? convertDateFormat(data[i].expectedPoissuedDate, "dd MMM yy") : "";
                        var etd = data[i].etd != null ? convertDateFormat(data[i].etd, "dd MMM yy") : "";
                        var podate = data[i].podate != null ? convertDateFormat(data[i].podate, "dd MMM yy") : "";
                        var eta = data[i].eta != null ? convertDateFormat(data[i].eta, "dd MMM yy") : "";
                        var grdate = data[i].grdate != null ? convertDateFormat(data[i].grdate, "dd MMM yy") : "";
                        var poqty = data[i].poqty != null ? data[i].poqty : "";
                        var grqty = data[i].grqty != null ? data[i].grqty : "";
                        var uom = data[i].uom != null ? data[i].uom : "";
                        uom = poqty != "" ? uom : "";
                        var vendorName = data[i].vendorName != null ? data[i].vendorName : "";
                        var grbacklog = data[i].grbacklog != null ? data[i].grbacklog : "";

                        $("#bodyDetailGR" + no).last().append("<tr><td class='tdPID text-center' style='background:transparent;width:90px'>" + expectedPoissuedDate + "</td><td class='tdQty text-center' style='background:transparent;width:90px'>" + etd + "</td><td scope='col' class='tdCurrency text-center' style='background:transparent;width:80px'><div class='custom-control custom-checkbox'><input type='checkbox' class='form-check-input checkbox checkPONo'style='border: 1px solid;font-size:small' name='checkPONo' id='checkPONo' value='" + data[i].polineId + ";" + data[i].idnew + "'><label class='custom-control-label' for='customCheck1'>&nbsp" + data[i].poid + "</label></div></td><td scope='col' class='tdUnitCOGS' style='background:transparent;;width:300px'>" + data[i].itemDescription + "</td><td scope='col' class='tdUnitRevenue' style='background:transparent;width:90px'>" + data[i].itemNo + "</td><td scope='col' class='tdTotalCOGS text-center' style='background:transparent;width:90px'>" + podate + "</td><td scope='col' class='tdTotalRevenue text-center' style='background:transparent;width:65px'>" + poqty + " " + uom + "</td><td scope='col' class='tdPM text-center' style='background:transparent;width:90px'>" + eta + "</td><td scope='col' class='tdVendor' style='background:transparent'>" + vendorName + "</td><td scope='col' class='tdGRDate text-center' style='background:transparent;width:90px'>" + grdate + "</td><td scope='col' class='tdGRQty' style='background:transparent;width:65px'>" + grqty + "</td><td scope='col' class='tdGRBackLog' style='background:transparent'>" + grbacklog + "</td><input class='txtCheckIDNew' type='hidden' value'" + data[i].idnew + "'/></tr>")
                    };

                };
            },
            error: function (data) {
                console.log("error" + data[0]);
            }
        });
    }
    
    function ShowFileAttachment(no, detail, doctype){
        var procid = new FormData();
        var tempprocid = document.querySelector("#preprocid").getAttribute("value");
        procid.append("procid", tempprocid);
        procid.append("detailid", detail);
        procid.append("doctype", doctype);

        $.ajax({
            url: "/PreProcs/ShowFileAttachment/",
            type: "POST",
            dataType: "json",
            data: procid,
            contentType: false,
            processData: false,
            success: function (datas) {
                if (datas.length > 0) {
                    $('td.tdFileGRN').each(function () {
                        var det = $(this).parent().find("input:hidden.detailid").val();
                        if(datas[0].bastid == det){
                            for (var i = 0; i < datas.length; i++) {
                                $(this).append("<a  class='' style='font-size: 12px; padding: 7px!important;' href='/Preprocs/GetFileAttachment?target=" + datas[i].strictedFileName + ";" + datas[i].fileName + "'>" + datas[i].fileName + "</a> <br><br>");
                            };
                            $(this).append("<a class='btn btn-outline-secondary mt-lg-2 AttachGRN' style='font-size: 12px;display:none;width:75px; padding: 3px!important;' data-bs-toggle='modal' data-bs-target='#uploadGRN'>Attach File</a>");

                            return false;
                        }
                    });

                    // for (var i = 0; i < datas.length; i++) {
                    //     $("td.tdFileGRN").last().append("<a  class='' style='font-size: 12px; padding: 7px!important;' href='/Preprocs/GetFileAttachment?target=" + datas[i].strictedFileName + ";" + datas[i].fileName + "'>" + datas[i].fileName + "</a> <br><br>");
                    // };
                    
                }
                else{
                    $('td.tdFileGRN').append("<a class='btn btn-outline-secondary mt-lg-2 AttachGRN' style='font-size: 12px;display:none;width:75px; padding: 3px!important;' data-bs-toggle='modal' data-bs-target='#uploadGRN'>Attach File</a>")
                }
                
                // $("td.tdFileGRN").last().append("<a class='btn btn-outline-secondary mt-lg-2 AttachGRN' style='font-size: 12px;display:none;width:75px; padding: 3px!important;' data-bs-toggle='modal' data-bs-target='#uploadGRN'>Attach File</a>");
            },
            error: function (datas) {
                console.log("error" + datas[0]);
            }
        });
    }

    function showPOData(type) {
        var tempprocid = document.querySelector("#preprocid").getAttribute("value");

        var procid = new FormData();

        $("div.loading").show();

        var templistidnew = [];
        var txtExpPODateSingle = $('input#txtExpPODateSingle').val("");
        var txtETDSingle = $('input#txtETDSingle').val("");
        var txtPOQtySingle = $('input#txtPOQtySingle').val("");
        var txtETASingle = $('input#txtETASingle').val("");

        $('input:checkbox.checkPONo').each(function () {
            if (this.checked == true) {
                procid.append("procid", tempprocid);
                procid.append("polineid", $(this).val());
                var temp = $(this).val().split(";");
                templistidnew.push(temp[1]);
            }
            // else{
            //     $(this).parent().parent().parent().parent().parent().parent().parent().parent().remove();
            // }
        });
        $('td.tdCheckNo').each(function () {
            var thisval = $(this).html().trim();
            var flag = 0;
            for (var i = 0; i < templistidnew.length; i++) {
                if(thisval == templistidnew[i]){
                    flag = 1;
                    break;
                }
            }
            if(flag == 0){
                $(this).parent().remove();
            }
        });

        $.ajax({
            url: "/PreProcs/GetItemPreProcPO/",
            type: "POST",
            dataType: "json",
            data: procid,
            contentType: false,
            processData: false,
            success: function (data) {
                $(".bodyDetailPO").html("");
                $(".bodyDetailGR").html("");
                if (data.length > 0) {
                    if(type == "GR" && (($("#currentEmailWH").val() != null && $("#currentEmailWH").val() != "") || $("#currentEmailSuperAdmin").val() != "")){
                        $("div.visGroup1").css("display", "block");
                        $("button#submit-update-gr").css("display", "block");
                    }
                    else if(type == "PO"){
                        $("button#submit-update-po").css("display", "block");
                        if(($("#currentEmailPM").val() != null && $("#currentEmailPM").val() != "") || ($("#currentEmailPC").val() != null && $("#currentEmailPC").val() != "") || ($("#currentEmailPMOHead").val() != null && $("#currentEmailPMOHead").val() != "") || ($("#currentEmailPS").val() != null && $("#currentEmailPS").val() != "") || $("#currentEmailSuperAdmin").val() != ""){
                            $("div.visGroup1").css("display", "block");
                            $("div.visGroup2").css("display", "none");
                        }
                        else if ($("#currentEmailProc").val() != null && $("#currentEmailProc").val() != "") {
                           $("div.visGroup2").css("display", "block");
                           $("div.visGroup1").css("display", "none");
                        }
                    }
                    $("div.visbileInputType").css("display", "block");
                    $("button#btn-select-item").css("display", "none");
                    
                    for (var i = 0; i < data.length; i++) {
                        var expectedPoissuedDateedit = data[i].expectedPoissuedDate != null ? convertDateFormat(data[i].expectedPoissuedDate, "yyyy-MM-dd") : "";
                        var etdedit = data[i].etd != null ? convertDateFormat(data[i].etd, "yyyy-MM-dd") : "";
                        var etaedit = data[i].eta != null ? convertDateFormat(data[i].eta, "yyyy-MM-dd") : "";
                        var expectedPoissuedDate = data[i].expectedPoissuedDate != null ? convertDateFormat(data[i].expectedPoissuedDate, "dd MMM yy") : "";
                        var etd = data[i].etd != null ? convertDateFormat(data[i].etd, "dd MMM yy") : "";
                        var podate = data[i].podate != null ? convertDateFormat(data[i].podate, "dd MMM yy") : "";
                        var eta = data[i].eta != null ? convertDateFormat(data[i].eta, "dd MMM yy") : "";
                        var poqty = data[i].poqty != null ? data[i].poqty : "";
                        var uom = data[i].uom != null ? data[i].uom : "";
                        var vendorName = data[i].vendorName != null ? data[i].vendorName : "";
                        var expectedPoissuedDategr = data[i].expectedPoissuedDate != null ? convertDateFormat(data[i].expectedPoissuedDate, "dd MMM yy") : "";
                        var etdgr = data[i].etd != null ? convertDateFormat(data[i].etd, "dd MMM yy") : "";
                        var etagr = data[i].eta != null ? convertDateFormat(data[i].eta, "dd MMM yy") : "";
                        var grdate = data[i].grdate != null ? convertDateFormat(data[i].grdate, "dd MMM yy") : "";
                        var grdateedit = data[i].grdate != null ? convertDateFormat(data[i].grdate, "yyyy-MM-dd") : "";
                        var grqty = data[i].grqty != null ? data[i].grqty : "";
                        var grbacklog = data[i].grbacklog != null ? data[i].grbacklog : "";

                        if (($("#currentEmailPM").val() != null && $("#currentEmailPM").val() != "") || ($("#currentEmailPC").val() != null && $("#currentEmailPC").val() != "") || ($("#currentEmailPMOHead").val() != null && $("#currentEmailPMOHead").val() != "") || ($("#currentEmailPS").val() != null && $("#currentEmailPS").val() != "") || $("#currentEmailSuperAdmin").val() != "") {
                            $("#bodyDetailPO" + data[i].idnew).last().append("<tr><td class='tdPID text-center' style='background:transparent;width:80px'><input class='form-control txtExpPOMulti' style='width:140px' type='date' value='" + expectedPoissuedDateedit + "'/></td><td class='tdQty text-center' style='background:transparent;width:80px'><input class='form-control txtETDMulti' style='width:140px' type='date' value='" + etdedit + "'/></td><td scope='col' class='tdCurrency text-center' style='background:transparent;width:80px'>" + data[i].poid + "</td><td scope='col' class='tdUnitCOGS' style='background:transparent;;width:300px'>" + data[i].itemDescription + "</td><td scope='col' class='tdUnitRevenue' style='background:transparent;width:90px'>" + data[i].itemNo + "</td><td scope='col' class='tdTotalCOGS text-center' style='background:transparent;width:90px'>" + podate + "</td><td scope='col' class='tdTotalRevenue text-center' style='background:transparent;width:65px'>" + poqty + uom + "</td><td scope='col' class='tdPM text-center' style='background:transparent;width:80px'>" + eta + "</td><td scope='col' class='tdVendor' style='background:transparent'>" + vendorName + "</td><td scope='col' class='tdGRDate text-center' style='background:transparent;width:95px'>" + grdate + "</td><td scope='col' class='tdGRQty' style='background:transparent;width:65px'>" + grqty + "</td><td scope='col' class='tdGRBackLog' style='background:transparent'>" + grbacklog + "</td><td class='tdIdNewUpdatedPO' hidden>" + data[i].idnew + "</td><td class='tdPOLineUpdatedPO' hidden>" + data[i].polineId + "</td></tr>")
                        }
                        else if ($("#currentEmailProc").val() != null && $("#currentEmailProc").val() != "") {
                           $("#bodyDetailPO" + data[i].idnew).last().append("<tr><td class='tdPID text-center' style='background:transparent;width:80px'>" + expectedPoissuedDate + "</td><td class='tdQty text-center' style='background:transparent;width:80px'>" + etd + "</td><td scope='col' class='tdCurrency text-center' style='background:transparent;width:80px'>" + data[i].poid + "</td><td scope='col' class='tdUnitCOGS' style='background:transparent;;width:300px'>" + data[i].itemDescription + "</td><td scope='col' class='tdUnitRevenue' style='background:transparent;width:90px'>" + data[i].itemNo + "</td><td scope='col' class='tdTotalCOGS text-center' style='background:transparent;width:90px'>" + podate + "</td><td scope='col' class='tdTotalRevenue text-center' style='background:transparent;width:65px'><input class='form-control text-center txtPOQtyMulti' style='width:65px' type='text' value='" + poqty + "'/>" + uom + "</td><td scope='col' class='tdPM text-center' style='background:transparent;width:80px'><input class='form-control txtETAMulti' style='width:140px' type='date' value='" + etaedit + "'/></td><td scope='col' class='tdVendor' style='background:transparent'>" + vendorName + "</td><td scope='col' class='tdGRDate text-center' style='background:transparent;width:95px'>" + grdate + "</td><td scope='col' class='tdGRQty' style='background:transparent;width:65px'>" + grqty + "</td><td scope='col' class='tdGRBackLog' style='background:transparent'>" + grbacklog + "</td><td class='tdIdNewUpdatedPO' hidden>" + data[i].idnew + "</td><td class='tdPOLineUpdatedPO' hidden>" + data[i].polineId + "</td></tr>")
                        }

                        $("#bodyDetailGR" + data[i].idnew).last().append("<tr><td class='tdPID text-center' style='background:transparent;width:80px'>" + expectedPoissuedDategr + "</td><td class='tdQty text-center' style='background:transparent;width:80px'>" + etdgr + "</td><td scope='col' class='tdCurrency text-center' style='background:transparent;width:80px'>" + data[i].poid + "</td><td scope='col' class='tdUnitCOGS' style='background:transparent;;width:300px'>" + data[i].itemDescription + "</td><td scope='col' class='tdUnitRevenue' style='background:transparent;width:90px'>" + data[i].itemNo + "</td><td scope='col' class='tdTotalCOGS text-center' style='background:transparent;width:80px'>" + podate + "</td><td scope='col' class='tdTotalRevenue text-center' style='background:transparent;width:65px'>" + poqty + " " + uom + "</td><td scope='col' class='tdPM text-center' style='background:transparent;width:80px'>" + etagr + "</td><td scope='col' class='tdVendor' style='background:transparent'>" + vendorName + "</td><td scope='col' class='tdGRDate text-center' style='background:transparent;width:90px'><input class='form-control txtGRDateMulti' style='width:140px' type='date' value='" + grdateedit + "'/></td><td scope='col' class='tdGRQty' style='background:transparent;width:65px'><input class='form-control text-center txtGRQtyMulti' style='width:65px' type='text' value='" + grqty + "'/></td><td scope='col' class='tdGRBackLog' style='background:transparent'>" + grbacklog + "</td><td class='tdIdNewUpdatedPO' hidden>" + data[i].idnew + "</td><td class='tdPOLineUpdatedPO' hidden>" + data[i].polineId + "</td></tr>")
                    };
                    
                };
                var visiblegr = $("a.AttachGRN").css("display", "inline-block");
                var visiblepo = $("a.AttachPO").css("display", "block");
            },
            complete: function (){
                $("div.loading").hide();
            },
            error: function (data) {
                console.log("error" + data[0]);
            }
        })
    }

    function updatePOData() {
        var tempprocid = document.querySelector("#preprocid").getAttribute("value");
        var procid = new FormData();
        var inputtype = "";

        $('input:radio.txtInputType').each(function () {
            if (this.checked == true) {
                inputtype = $(this).val();
            }
        });

        if(inputtype == "Single"){
            var txtExpPODateSingle = $('input#txtExpPODateSingle').val();
            var txtETDSingle = $('input#txtETDSingle').val();
            var txtPOQtySingle = $('input#txtPOQtySingle').val();
            var txtETASingle = $('input#txtETASingle').val();

            $('td.tdIdNewUpdatedPO').each(function () {
                procid.append("idnew", $(this).html().trim());
                procid.append("poline", $(this).parent().find("td.tdPOLineUpdatedPO").html().trim());
            });
            
            procid.append("txtExpPODateSingle", txtExpPODateSingle);
            procid.append("txtETDSingle", txtETDSingle);
            procid.append("txtPOQtySingle", txtPOQtySingle);
            procid.append("txtETASingle", txtETASingle);
        }
        else{
            $('td.tdIdNewUpdatedPO').each(function () {
                procid.append("txtETDMultiple", $(this).parent().find("input.txtETDMulti").val());
                procid.append("txtExpPODateMultiple", $(this).parent().find("input.txtExpPOMulti").val());
                procid.append("txtPOQtyMultiple", $(this).parent().find("input:text.txtPOQtyMulti").val());
                procid.append("txtETAMultiple", $(this).parent().find("input.txtETAMulti").val());
                procid.append("idnew", $(this).html().trim());
                procid.append("poline", $(this).parent().find("td.tdPOLineUpdatedPO").html().trim());
            });
        }
        procid.append("procid", tempprocid);
        procid.append("inputtype", inputtype);

        $.ajax({
                url: "/PreProcs/PostUpdatePOData/",
                type: "POST",
                dataType: "json",
                data: procid,
                contentType: false,
                processData: false,
                success: function (data) {
                    $("#modalLoadingElement").show()
                    $("#modalLoadingElement").addClass("show")
                    modalBackdrop.style.display = "block";
                    window.location.reload();
                },
                error: function (data) {
                    console.log("error" + data[0]);
                }
            })
    }

    function convertDateFormat(dateObject, param) {
            const months = ["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];
            var d = new Date(dateObject);
            var day = d.getDate();
            var month = d.getMonth() + 1;
            var year = d.getFullYear();
            var date = "";

            if (day < 10) {
                day = "0" + day;
            }

            if(param == "yyyy-MM-dd"){
                if (month < 10) {
                    month = "0" + month;
                }
                date = year + "-" + month + "-" + day;
            }
            else if(param == "dd MMM yy"){
                month = months[d.getMonth()];
                date = day + " " + month + " " + year.toString().substring(2, 4);
            }

            return date;
        };

        $('#tblDataDelivery').on('click', 'a.btn-edit', function () {
            const detailid = $(this).parent().parent().find("input:hidden.txtDetailId").val();

            $('input:hidden.txtDetailIdRemark').each(function () {
                if($(this).val() == detailid){
                    var remarkitem = $(this).parent().find("td.tdRemark").html();
                    const remarkitemhtml = $(this).parent().find("td.tdRemark").html("<textarea class='form-control txtRemark' placeholder='(Type remark here)' style='width:250px;height:50px'>" + remarkitem +"</textarea>");
                    return false;
                }
            });

            $(this).parent().parent().find("td.tdControl").html(rowUpdateButtons);
        });

        $('#tblDataDelivery').on('click', 'a.btn-save', function () {
            const detailid = $(this).parent().parent().find("input:hidden.txtDetailId").val();
            // var remarkitem = "";
            // var remarkitemhtml = $(this).parent().find("td.tdRemark").html();

            const remark = $(this).parent().parent().next().find("textarea.txtRemark").val();
            let remarkhtml = $(this).parent().parent().next().find("td.tdRemark").html(remark);

            // $('input:hidden.txtDetailIdRemark').each(function () {
            //     if($(this).val() == detailid){
            //         remarkitem = $(this).parent().find("textarea.txtRemark").val();
            //         remarkitemhtml = $(this).parent().find("td.tdRemark").html("");
            //         return false;
            //     }
            // });
            var preprocid = new FormData();
            const procid = $(this).parent().parent().find("input.txtPreProcId").val();

        //     preprocid.append("preprocid", procid);
        //     preprocid.append("detailid", detailid);
        //     preprocid.append("remark", remarkitem);

        //     $.ajax({
        //         url: "/PreProcs/PostEditRemarkItem/",
        //         type: "POST",
        //         dataType: "json",
        //         data: preprocid,
        //         contentType: false,
        //         processData: false,
        //         success: function (data) {
        //             remarkitemhtml.append(data.remarkOnItem);
        //         },
        //         error: function (data) {
        //             console.log("error" + data[0]);
        //         }
        //     })

            $(this).parent().parent().find("td.tdControl").html(rowButtonsDeliv);

        });

        $('#tblDataDelivery').on('click', 'a.btn-cancel', function () {
            const detailid = $(this).parent().parent().find("input:hidden.txtDetailId").val();
            var remarkitem = $(this).parent().parent().find("textarea.txtRemark").val();

            // for(var i =0;i<arr.length)

            // $('input:hidden.txtDetailIdRemark').each(function () {
            //     if($(this).val() == detailid){
            //         const remarkitemhtml = $(this).parent().find("td.tdRemark").html(remarkitem);
            //         return false;
            //     }
            // });

            // const remark = $(this).parent().parent().next().find("textarea.txtRemark").val();
        let remarkhtml = $(this).parent().parent().next().find("td.tdRemark").html(remarkitem);

            $(this).parent().parent().find("td.tdControl").html(rowButtonsDeliv);
        });

        $('#btn-update-gr').on('click', function () {
            var pid = new FormData();
            var tempprocid = document.querySelector("#preprocid").getAttribute("value");

            $("button#submit-update-gr").css("display", "none");

            $("#bodyUpdateGR").html("");
            $('input:checkbox.checkItem').each(function () {
                if(this.checked == true){
                    const pid = $(this).parent().parent().find("td.tdPID").html().trim();
                    const no = $(this).parent().parent().find("td.tdNo").html().trim();
                    const detailid = $(this).parent().parent().find("input:hidden.txtDetailId").val();
                    const itemdesc = $(this).parent().parent().find("select.txtItemDesc option:selected").text(); 
                    const remark = $(this).parent().parent().find("textarea.txtRemark ").val();
                    const qty = $(this).parent().parent().find("td.tdQty").html().trim();

                    $("#bodyUpdateGR").append("<tr><td class='tdCheckNo'>" + no + "</td><td>" + pid + "</td><td style='min-width:315px'>" + itemdesc + "<br><b class='text-red'>" + remark + "</b</td><td class='text-center'>" + qty + "</td><td><div class='table-wrapper table-responsive-lg' style='width:1265px;min-height:50px'>   <table class='table tblUpdatePO table-borderless' style='font-size:small;vertical-align:middle'><thead><tr><th scope='col' style='background:transparent;color:black'><b>Exp PO Issued Dt</b></th><th scope='col' style='background:transparent;color:black'><b>ETD</b></th><th scope='col' style='background:transparent;color:black'><b>PO Number</b></th><th scope='col' style='background:transparent;color:black'><b>PO Item</b></th><th scope='col' style='background:transparent;color:black'><b>NKS</b></th><th scope='col' style='background:transparent;color:black'><b>PO Date</b></th><th scope='col' style='background:transparent;color:black'><b>PO Qty</b></th><th scope='col' style='background:transparent;color:black'><b>ETA</b></th><th scope='col' style='background:transparent;color:black'><b>Vendor</b></th><th scope='col' style='background:transparent;color:black'><b>GR Date</b></th><th scope='col' style='background:transparent;color:black'><b>GR Qty</b></th><th scope='col' style='background:transparent;color:black'><b>GR BackLog</b></th></tr></thead><tbody class='bodyDetailGR' id='bodyDetailGR" + no + "'></tbody></table></div></td><td class='tdFileMLPTPO'></td><td class='tdFileGRN text-center'></td><input type='hidden' value='"+ detailid +"' class='form-control detailid'/></tr>");

                    GetItemPreProcPO(no, "Update GR");
                    ShowFileAttachment(no, detailid, "GRN");
                };
            });

            $('input:checkbox.checkItem').each(function () {
                if(this.checked == true){
                    const no = $(this).parent().parent().find("td.tdNo").html().trim();

                    GetItemPreProcPO(no, "Update GR");
                };
            });

            // pid.append("pid", pidtemp)

        })

        $('#singleinputgr').on('click', function () {
            var hidden = $("a.AttachGRN").css("display", "none");
            console.log("masuk single");
        })
        $('#multiinputgr').on('click', function () {
            var visible = $("a.AttachGRN").css("display", "inline-block");
            console.log("masuk multi");
        })

        function updateGRData() {
            var tempprocid = document.querySelector("#preprocid").getAttribute("value");
            var procid = new FormData();
            var inputtype = "";

            $('input:radio.txtInputType').each(function () {
                if (this.checked == true) {
                    inputtype = $(this).val();
                }
            });

            if(inputtype == "Single"){
                var txtGRDateSingle = $('input#txtGRDateSingle').val();
                var txtGRQtySingle = $('input#txtGRQtySingle').val();

                $('td.tdIdNewUpdatedPO').each(function () {
                    procid.append("idnew", $(this).html().trim());
                    procid.append("poline", $(this).parent().find("td.tdPOLineUpdatedPO").html().trim());
                });
            
                procid.append("txtGRDateSingle", txtGRDateSingle);
                procid.append("txtGRQtySingle", txtGRQtySingle);

                console.log(txtGRDateSingle);
                console.log(txtGRQtySingle);
            }
            else{
                $('input.txtGRDateMulti').each(function () {
                    procid.append("txtGRDateMultiple", $(this).val());
                    procid.append("txtGRQtyMultiple", $(this).parent().parent().find("input:text.txtGRQtyMulti").val());
                    procid.append("idnew", $(this).parent().parent().find("td.tdIdNewUpdatedPO").html().trim());
                    procid.append("poline", $(this).parent().parent().find("td.tdPOLineUpdatedPO").html().trim());
                });
            }
            procid.append("procid", tempprocid);
            procid.append("inputtype", inputtype);

            $.ajax({
                url: "/PreProcs/PostUpdateGRData/",
                type: "POST",
                dataType: "json",
                data: procid,
                contentType: false,
                processData: false,
                success: function (data) {
                    alert("Successfully updated.")
                    $("#modalLoadingElement").show()
                    $("#modalLoadingElement").addClass("show")
                    modalBackdrop.style.display = "block";
                    window.location.reload();
                },
                error: function (data) {
                    console.log("error" + data[0]);
                }
            })
        }

        $('#bodyUpdateGR').on('click', 'a.AttachGRN', function () {
            var detailid = $(this).parent().parent().find("input.detailid").val();
            console.log(detailid);

            $("#idAttachGRN").html("<input type='hidden' value='"+ detailid +"' class='form-control' id='modalgrndetailid'/><input type='file' name='fileUploadGRN' class='form-control' id='fileUploadGRN' multiple/>");
        });

        function uploadgrnfile() {
            var myfile = document.querySelector("#fileUploadGRN");
            var det = $("#idAttachGRN").find("#modalgrndetailid").val();
            var fileUploadgrn = new FormData();
            var temppreprocid = document.querySelector("#preprocid").getAttribute("value");

            if (myfile.files.length > 0) {
                for (var i = 0; i < myfile.files.length; i++) {
                    fileUploadgrn.append("fileUploadgrn", myfile.files[i]);
                    if(det != "" || det != null){
                        fileUploadgrn.append("detailid", det);
                    }
                }
            }
            fileUploadgrn.append("preprocid", temppreprocid);

            $.ajax({
                url: "/PreProcs/SaveAttachGRN/",
                type: "POST",
                dataType: "json",
                data: fileUploadgrn,
                contentType: false,
                processData: false,
                success: function (data) {
                    if(data.length > 0){
                      alert("Successfully attached.");
                    }
                    // window.location.reload()
                },
                error: function (data) {
                    if(data.responseText == "Sukses"){
                        $('input:hidden.detailid').each(function () {
                            if($(this).val() == det){
                                $(this).parent().find("td.tdFileGRN").find("a.AttachGRN").remove();
                                var tes = $(this).parent().find("td.tdFileGRN");
                                if (myfile.files.length > 0) {
                                    for (var i = 0; i < myfile.files.length; i++) {
                                        tes.append(myfile.files[i].name + "<br><br>");
                                    }
                                }
                                tes.append("<a class='btn btn-outline-secondary mt-lg-2 AttachGRN' style='font-size: 12px;width:75px; padding: 3px!important;' data-bs-toggle='modal' data-bs-target='#uploadGRN'>Attach File</a>");
                                return false;
                            }
                    
                        });

                        alert("Successfully attached.");

                    }
                }
            })
        }

        function sendNotiftoPMPC() {
            var procid = new FormData();
            var temppreprocid = document.querySelector("#preprocid").getAttribute("value");
            var message = $("textarea#txtNoteAssignPMPC").val();

            procid.append("procid", temppreprocid);
            procid.append("message", message);

            $.ajax({
                url: "/PreProcs/SendNotifToPMPC/",
                type: "POST",
                dataType: "json",
                data: procid,
                contentType: false,
                processData: false,
                success: function (data) {
                    if(data.length > 0){
                      alert("Successfully Notified.");
                    }
                    $("#modalLoadingElement").show()
                    $("#modalLoadingElement").addClass("show")
                    modalBackdrop.style.display = "block";
                    window.location.reload();
                },
                error: function (data) {
                    console.log("error" + data[0]);
                }
            })
        }

        function sendNotifbyType(type) {
            var procid = new FormData();
            var temppreprocid = document.querySelector("#preprocid").getAttribute("value");
            var message = $("textarea#txtNoteRemindProcWH").val();

            if(type == "PurchaseReq"){
                message = $("textarea#txtNoteRemindPurchaseReq").val();
            }

            procid.append("procid", temppreprocid);
            procid.append("message", message);
            procid.append("type", type);

            $.ajax({
                url: "/PreProcs/SendNotifByType/",
                type: "POST",
                dataType: "json",
                data: procid,
                contentType: false,
                processData: false,
                success: function (data) {
                    if(data.length > 0){
                      alert("Successfully notified.");
                    }
                    $("#modalLoadingElement").show()
                    $("#modalLoadingElement").addClass("show")
                    modalBackdrop.style.display = "block";
                    window.location.reload();
                },
                error: function (data) {
                    console.log("error" + data[0]);
                }
            })
        }

        function sendNotifStagePresales(type) {
            var procid = new FormData();
            var temppreprocid = document.querySelector("#preprocid").getAttribute("value");
            var message = "";
            var recipient = "";

            if(type == "Parameter Email Excpt To Finance"){
                message = $("textarea#txtNoteExcptFinance").val().trim();
                recipient = $("textarea#resultSelectedtExcptFinanceEmail").val().trim();
            }

            procid.append("procid", temppreprocid);
            procid.append("message", message);
            procid.append("type", type);
            procid.append("recipient", recipient);

            $.ajax({
                url: "/PreProcs/SendNotifStagePresales/",
                type: "POST",
                dataType: "json",
                data: procid,
                contentType: false,
                processData: false,
                success: function (data) {
                    if(data.length > 0){
                        alert("Successfully notified.");
                    }
                    $("#modalLoadingElement").show()
                    $("#modalLoadingElement").addClass("show")
                    modalBackdrop.style.display = "block";
                    window.location.reload();
                },
                error: function (data) {
                    console.log("error" + data[0]);
                }
            })
        }

        const optionElements = document.querySelectorAll('option');

        Array.from(optionElements).forEach(element => {
          if (element.textContent.length > 50) {
            element.textContent =
              element.textContent.slice(0, 50) + '...';
          }
        });

        function valueOnCheckSubmitBOD() {
            selPIC = jQuery(".checkBOD");
            var tempPIC = "";
            var tempPICDomain = "";
            selPIC.each(function () {
                if (jQuery(this).prop("checked") == true) {
                    var tempsplit = jQuery(this).val().split(";"); 
                    tempPIC += tempsplit[1] + "; ";
                    tempPICDomain += tempsplit[0] + ";";
                    console.log(tempPIC);
                }
            })
            $("#resultSelectedBOD").val(tempPIC);
            $("#resultSelectedBODEmail").val(tempPICDomain);
        }

        $('#btnSelectRecipientProcWHModal').on('click', function () {
            var recipientdomain = $("textarea#resultSelectedProcWHEmail").val().replace(" ", "").trim();
            var split = recipientdomain.split(";");
            
            for(var i =0;i<split.length;i++){
                if(split[i] == "" || split[i] == " "){
                    return false
                }
                checkedExistRecipient(split[i].replace(" ", "").trim(), "ProcWH");
            }
            
        })

        $('#btnSelectRecipientExcptFinanceModal').on('click', function () {
            var recipientdomain = $("textarea#resultSelectedtExcptFinanceEmail").val().replace(" ", "").trim();
            var split = recipientdomain.split(";");
            
            for(var i =0;i<split.length;i++){
                if(split[i] == "" || split[i] == " "){
                    return false
                }
            checkedExistRecipient(split[i].replace(" ", "").trim(), "ExcptFinance");
            }
            
        })

        function checkedExistRecipient(string, type){
            if (type == "ProcWH") {
                $('input:checkbox.checkProcWH').each(function () {
                    var temphtml = $(this).parent().parent().find("td.Domain").html();
                    if (string.includes(temphtml.replace(" ", "").trim()) && string != "" && string != " ") {
                        $(this).prop("checked", true);
                    }
                });
            }
            else if(type == "PurchaseReq"){
                $('input:checkbox.checkProcPS').each(function () {
                    var temphtml = $(this).parent().parent().find("td.Domain").html();
                    if (string.includes(temphtml.replace(" ", "").trim()) && string != "" && string != " ") {
                        $(this).prop("checked", true);
                    }
                });
            }
            else if(type == "ExcptFinance"){
                $('input:checkbox.checkFinance').each(function () {
                    var temphtml = $(this).parent().parent().find("td.Domain").html();
                    if (string.includes(temphtml.replace(" ", "").trim()) && string != "" && string != " ") {
                        $(this).prop("checked", true);
                    }
                });
            }
        }

        $('#btnSelectRecipientPurchaseReqModal').on('click', function () {
            var recipientdomain = $("textarea#resultSelectedPurchaseReqEmail").val().replace(" ", "").trim();
            var split = recipientdomain.split(";");
            
            for(var i =0;i<split.length;i++){
                if(split[i] == "" || split[i] == " "){
                    return false
                }
                checkedExistRecipient(split[i].replace(" ", "").trim(), "PurchaseReq");
            }
            
        })

        $('#selectBillReason').on('change', function () {
            var val = $(this).val();

            if(val == "7"){ //7 = Other
                var visible = $("input#inputOtherBillReason").css("display", "block");
            }
            else{
                var hidden = $("input#inputOtherBillReason").css("display", "none");
            }
        })

        if($("#selectBillReason").val() == "7"){ //7 = Other
            $("input#inputOtherBillReason").css("display", "block");
        }

        function valueOnCheckFinance() {
            selPIC = jQuery(".checkFinance");
            var tempPIC = "";
            var tempPICDomain = "";
            selPIC.each(function () {
                if (jQuery(this).prop("checked") == true) {
                    var tempsplit = jQuery(this).val().split(";"); 
                    tempPIC += tempsplit[1] + "; ";
                    tempPICDomain += tempsplit[0] + ";";
                    console.log(tempPIC);
                }
            })
            $("#resultSelectedExcptFinance").val(tempPIC);
            $("#resultSelectedtExcptFinanceEmail").val(tempPICDomain);
        }

        function valueOnCheckProcWH() {
            selPIC = jQuery(".checkProcWH");
            var tempPIC = "";
            var tempPICDomain = "";
            selPIC.each(function () {
                if (jQuery(this).prop("checked") == true) {
                    var tempsplit = jQuery(this).val().split(";"); 
                    tempPIC += tempsplit[1] + "; ";
                    tempPICDomain += tempsplit[0] + ";";
                    console.log(tempPIC);
                }
            })
            $("#resultSelectedProcWH").val(tempPIC);
            $("#resultSelectedProcWHEmail").val(tempPICDomain);
        }

        function valueOnCheckPurchaseReq() {
            selPIC = jQuery(".checkProcPS");
            var tempPIC = "";
            var tempPICDomain = "";
            selPIC.each(function () {
                if (jQuery(this).prop("checked") == true) {
                    var tempsplit = jQuery(this).val().split(";"); 
                    tempPIC += tempsplit[1] + "; ";
                    tempPICDomain += tempsplit[0] + ";";
                    console.log(tempPIC);
                }
            })
            $("#resultSelectedPurchaseReq").val(tempPIC);
            $("#resultSelectedPurchaseReqEmail").val(tempPICDomain);
        }

        $('#searchpid').keypress(function (e) {
            var value = $(this).val().toLowerCase();
            var key = e.which;
            var temppreprocid = document.querySelector("#preprocid").getAttribute("value");

            if(key == 13)  // the enter key code
            {
                var body = $('#bodyCSData').html("");

                var search = new FormData();
                search.append("search", value);
                search.append("procid", temppreprocid);

                $.ajax({
                    url: "/PreProcs/GetItemDetailFromSearch/",
                    type: "POST",
                    dataType: "json",
                    data: pid,
                    contentType: false,
                    processData: false,
                    success: function (datas) {
                            body.append("<tr><td scope='col' class='text-center'><input type='checkbox' class='form-check-input checkbox singleCheckItem' style='border: 1px solid;font-size: small;'></td><td scope='col' class='text-center'><input type='checkbox' class='form-check-input checkbox txtCSSub' value='true' style='border: 1px solid;font-size: small;'></td><td scope='col' style='text-align: -webkit-center;'><input style='width:100px' type='text' value='' class='txtCSHeaderNo form-control'/></td><td scope='col' class='tdCSDesc'>" + datas[i].description + "</td><td scope='col' class='tdCSQty'>" + datas[i].qty + "</td> <td scope='col' class='text-center tdCSCurr'>" + datas[i].currCode + "</td><td scope='col' class='text-end tdCSCOGS'>" + datas[i].unitCogs + "</td><td scope='col' class='text-end tdCSRevenue' >" + datas[i].unitRevenue + "</td><td scope='col' class='text-end tdCSTotCOGS' >" + datas[i].totalCogs + "</td><td scope='col' class='text-end tdCSTotRev'>" + datas[i].totalRevenue + "</td><td scope='col' class='text-end txtCSNKPCode' hidden>" + datas[i].nkpcode + "</td><td scope='col' class='text-end tdCSPID' hidden >" + datas[i].projectId + "</td><td scope='col' class='text-end tdCSPIDFull' hidden>" + datas[i].pidfull + "</td></tr>");
                    },
                    error: function (data) {
                        console.log("error" + data[0]);
                    }
                })
            }
        });

        function uploadrfpfile() {
            var myfile = document.querySelector("#postedfilerfp");

            $("#divInputFileRFP").html("");
            if (myfile.files.length > 0) {
                for (var i = 0; i < myfile.files.length; i++) {
                    console.log(myfile.files[i])
                    $("#divInputFileRFP").append("<label class='col-form-label'>" + myfile.files[i].name + "</label>");
                }
            }
        }
        function uploadquotfile() {
            var myfile = document.querySelector("#postedfilequot");

            $("#divInputFileQuot").html("");
            if (myfile.files.length > 0) {
                for (var i = 0; i < myfile.files.length; i++) {
                    console.log(myfile.files[i])
                    $("#divInputFileQuot").append("<label class='col-form-label'>" + myfile.files[i].name + "</label>");
                }
            }
        }

        function uploadboqfile() {
            var myfile = document.querySelector("#postedfileboq");

            $("#divInputFileBOQ").html("");
            if (myfile.files.length > 0) {
                for (var i = 0; i < myfile.files.length; i++) {
                    console.log(myfile.files[i])
                    $("#divInputFileBOQ").append("<label class='col-form-label'>" + myfile.files[i].name + "</label>");
                }
            }
        }
        function uploadpropofile() {
            var myfile = document.querySelector("#postedfileproposal");

            $("#divInputFilePropo").html("");
            if (myfile.files.length > 0) {
                for (var i = 0; i < myfile.files.length; i++) {
                    console.log(myfile.files[i])
                    $("#divInputFilePropo").append("<label class='col-form-label'>" + myfile.files[i].name + "</label>");
                }
            }
        }
        function uploadgpfile() {
            var myfile = document.querySelector("#postedfilegp");

            $("#divInputFileGP").html("");
            if (myfile.files.length > 0) {
                for (var i = 0; i < myfile.files.length; i++) {
                    console.log(myfile.files[i])
                    $("#divInputFileGP").append("<label class='col-form-label'>" + myfile.files[i].name + "</label>");
                }
            }
        }
        function uploadothersfile() {
            var myfile = document.querySelector("#postedfileothers");

            $("#divInputFileOthers").html("");
            if (myfile.files.length > 0) {
                for (var i = 0; i < myfile.files.length; i++) {
                    console.log(myfile.files[i])
                    $("#divInputFileOthers").append("<label class='col-form-label'>" + myfile.files[i].name + "</label>");
                }
            }
        }

</script>